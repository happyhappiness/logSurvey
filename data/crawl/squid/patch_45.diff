----++++src/servers/Http1Server.cc
@@ -173,6 +173,16 @@ Http::One::Server::buildHttpRequest(Http::Stream *context)
         return false;
     }
 
+    // when absolute-URI is provided Host header should be ignored. However
+    // some code still uses Host directly so normalize it using the previously
+    // sanitized URL authority value.
+    // For now preserve the case where Host is completely absent. That matters.
+    if (const auto x = request-&gt;header.delById(Http::HOST)) {
+        debugs(33, 5, &quot;normalize &quot; &lt;&lt; x &lt;&lt; &quot; Host header using &quot; &lt;&lt; request-&gt;url.authority());
+        SBuf tmp(request-&gt;url.authority());
+        request-&gt;header.putStr(Http::HOST, tmp.c_str());
+    }
+
     http-&gt;request = request.getRaw();
     HTTPMSGLOCK(http-&gt;request);
 
----++++GitHub