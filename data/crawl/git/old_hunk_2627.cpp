   but a test insisted that the function drops a trailing slash.
   (merge b2a7123 rd/test-path-utils later to maint).

 * Code clean-up and minor fixes.
   (merge 15ed07d jc/rerere later to maint).
   (merge e7a7401 pt/pull-builtin later to maint).
