diff --git a/src/ChangeLog b/src/ChangeLog
index aacce5d..b938538 100644
--- a/src/ChangeLog
+++ b/src/ChangeLog
@@ -1,3 +1,7 @@
+2011-05-15  Ray Satiro <raysatiro@yahoo.com>
+
+	* openssl.c (openssl_read): Prevent loops on read errors.
+
 2011-04-24  Giuseppe Scrivano  <gscrivano@gnu.org>
 
 	* html-url.c: Include "exists.h".
diff --git a/src/openssl.c b/src/openssl.c
index a1b35b2..02bd2f4 100644
--- a/src/openssl.c
+++ b/src/openssl.c
@@ -263,8 +263,8 @@ openssl_read (int fd, char *buf, int bufsize, void *arg)
   do
     ret = SSL_read (conn, buf, bufsize);
   while (ret == -1
-             || (SSL_get_error (conn, ret) == SSL_ERROR_SYSCALL
-                 && errno == EINTR));
+         && SSL_get_error (conn, ret) == SSL_ERROR_SYSCALL
+         && errno == EINTR);
 
   return ret;
 }
-- 
cgit v1.0-41-gc330

