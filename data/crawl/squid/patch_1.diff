----++++src/tunnel.cc
@@ -526,19 +526,11 @@ TunnelStateData::handleConnectResponse(const size_t chunkSize)
     // CONNECT response was successfully parsed
     request-&gt;hier.peer_reply_status = rep.sline.status();
 
-    // we need to relay the 401/407 responses when login=PASS(THRU)
-    const CachePeer *peer = server.conn-&gt;getPeer();
-    const char *pwd = (peer ? peer-&gt;login : nullptr);
-    const bool authRelated =
-        rep.sline.status() == Http::scUnauthorized ||
-        rep.sline.status() == Http::scProxyAuthenticationRequired;
-    const bool relay = authRelated &amp;&amp; pwd &amp;&amp;
-        (strcmp(pwd, &quot;PASS&quot;) == 0 || strcmp(pwd, &quot;PASSTHRU&quot;) == 0);
-
     // bail if we did not get an HTTP 200 (Connection Established) response
     if (rep.sline.status() != Http::scOkay) {
         // if we ever decide to reuse the peer connection, we must extract the error response first
-        informUserOfPeerError(&quot;unsupported CONNECT response status code&quot;, (relay ? rep.hdr_sz : 0));
+        *status_ptr = rep.sline.status(); // we are relaying peer response
+        informUserOfPeerError(&quot;unsupported CONNECT response status code&quot;, rep.hdr_sz);
         return;
     }
 
----++++GitHub