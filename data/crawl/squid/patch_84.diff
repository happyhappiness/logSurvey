@@ -6,9 +6,6 @@ config.guess
 config.h.in
 config.sub
 configure
-helpers/negotiate_auth/squid_kerb_auth/depcomp
-helpers/negotiate_auth/squid_kerb_auth/missing
-helpers/negotiate_auth/squid_kerb_auth/ska_config.h.in
 install-sh
 ltmain.sh
 Makefile.in
@@ -665,320 +665,256 @@ errors/errorpage.css:
 
 ==============================================================================
 
-helpers/basic_auth/DB/:
-
-Copyright (C) 2007 Henrik Nordstrom <henrik@henriknordstrom.net>
-Copyright (C) 2010 Luis Daniel Lucio Quiroz <dlucio@okay.com.mx> (Joomla support)
-This program is free software. You may redistribute copies of it under the
-terms of the GNU General Public License version 2, or (at youropinion) any
-later version.
-
-==============================================================================
+icons/silk/:
 
-helpers/basic_auth/fake/fake.cc,
-helpers/defines.h,
-helpers/url_rewrite/fake/:
+  Silk icon set 1.3
+  _________________________________________
+  Mark James
+  http://www.famfamfam.com/lab/icons/silk/
+  _________________________________________
 
-/*
- * Copyright (c) 2009-2014, Treehouse Networks Ltd. New Zealand
- * All rights reserved.
- *
- * Redistribution and use in source and binary forms, with or without
- * modification, are permitted provided that the following conditions
- * are met:
- *
- * 1. Redistributions of source code must retain the above copyright
- * notice, this list of conditions and the following disclaimer.
- *
- * 2. Redistributions in binary form must reproduce the above copyright
- * notice, this list of conditions and the following disclaimer in the
- * documentation and/or other materials provided with the distribution.
- *
- * THIS SOFTWARE IS PROVIDED BY THE COPYRIGHT HOLDERS AND CONTRIBUTORS
- * "AS IS" AND ANY EXPRESS OR IMPLIED WARRANTIES, INCLUDING, BUT NOT
- * LIMITED TO, THE IMPLIED WARRANTIES OF MERCHANTABILITY AND FITNESS
- * FOR A PARTICULAR PURPOSE ARE DISCLAIMED. IN NO EVENT SHALL THE
- * COPYRIGHT HOLDER OR CONTRIBUTORS BE LIABLE FOR ANY DIRECT, INDIRECT,
- * INCIDENTAL, SPECIAL, EXEMPLARY, OR CONSEQUENTIAL DAMAGES (INCLUDING,
- * BUT NOT LIMITED TO, PROCUREMENT OF SUBSTITUTE GOODS OR SERVICES;
- * LOSS OF USE, DATA, OR PROFITS; OR BUSINESS INTERRUPTION) HOWEVER
- * CAUSED AND ON ANY THEORY OF LIABILITY, WHETHER IN CONTRACT, STRICT
- * LIABILITY, OR TORT (INCLUDING NEGLIGENCE OR OTHERWISE) ARISING IN
- * ANY WAY OUT OF THE USE OF THIS SOFTWARE, EVEN IF ADVISED OF THE
- * POSSIBILITY OF SUCH DAMAGE.
- */
+  This work is licensed under a
+  Creative Commons Attribution 2.5 License.
+  [ http://creativecommons.org/licenses/by/2.5/ ]
 
-==============================================================================
+  This means you may use it for any purpose,
+  and make any changes you like.
+  All I ask is that you include a link back
+  to this page in your credits.
 
-helpers/basic_auth/getpwnam/:
+  Are you using this icon set? Send me an email
+  (including a link or picture if available) to
+  mjames@gmail.com
 
- * AUTHOR: Erik Hofman <erik.hofman@a1.nl>
- *         Robin Elfrink <robin@a1.nl>
+  Any other questions about this icon set please
+  contact mjames@gmail.com
 
-==============================================================================
 
-helpers/basic_auth/LDAP/:
+  The icons can also be used under Creative Commons Attribution 3.0 License
+  (Hi Debian folks!) with the following requirements:
 
- * License: squid_ldap_auth is free software; you can redistribute it
- * and/or modify it under the terms of the GNU General Public License
- * as published by the Free Software Foundation; either version 2,
- * or (at your option) any later version.
+    As an author, I would appreciate a reference to my authorship of
+    the Silk icon set contents within a readme file or equivalent
+    documentation for the software which includes the set or a subset
+    of the icons contained within. 
 
 ==============================================================================
 
-helpers/basic_auth/NCSA/basic_ncsa_auth.8:
+icons/SN.png:
 
-This file is distributed in the hope that it will be useful,
-but WITHOUT ANY WARRANTY; without even the implied warranty of
-MERCHANTABILITY or FITNESS FOR A PARTICULAR PURPOSE. See
-the GNU General Public License for more details.
+  Squid NOW icon - copyright Squid Project
 
-You should have received a copy of the GNU General Public License
-along with this file; if not, write to the Free Software
-Foundation, Inc., 59 Temple Place, Suite 330, Boston,
-MA 02111\-1307 USA
+  This work is licensed under the
+  Creative Commons Attribution-ShareAlike 3.0 Unported Liscence (CC BY-SA 3.0)
+  [ http://creativecommons.org/licenses/by-sa/3.0/ ]
 
 ==============================================================================
 
-helpers/basic_auth/NCSA/crypt_md5.cc:
+include/asn1.h,
+include/snmp_api_error.h,
+include/snmp_api_util.h,
+include/snmp_coexist.h,
+include/snmp_error.h,
+include/snmp-internal.h,
+include/snmp-mib.h,
+include/snmp_msg.h,
+include/snmp_pdu.h,
+include/snmp_session.h,
+include/snmp_vars.h,
+include/snmp.h,
+lib/snmplib/asn1.c,
+lib/snmplib/coexistence.c,
+lib/snmplib/snmp_api.c,
+lib/snmplib/snmp_api_error.c,
+lib/snmplib/snmp_error.c,
+lib/snmplib/snmp_msg.c,
+lib/snmplib/snmp_pdu.c,
+lib/snmplib/snmp_vars.c:
 
- * Shamelessly stolen from linux-pam, and adopted to work with
- * OpenSSL md5 implementation and any magic string
+ *           Copyright 1997 by Carnegie Mellon University
  *
- * Origin2: md5_crypt.c,v 1.1.1.1 2000/01/03 17:34:46 gafton Exp
+ *                       All Rights Reserved
  *
- * ----------------------------------------------------------------------------
- * "THE BEER-WARE LICENSE" (Revision 42):
- * <phk@login.dknet.dk> wrote this file.  As long as you retain this notice you
- * can do whatever you want with this stuff. If we meet some day, and you think
- * this stuff is worth it, you can buy me a beer in return.   Poul-Henning Kamp
- * ----------------------------------------------------------------------------
+ * Permission to use, copy, modify, and distribute this software and its
+ * documentation for any purpose and without fee is hereby granted,
+ * provided that the above copyright notice appear in all copies and that
+ * both that copyright notice and this permission notice appear in
+ * supporting documentation, and that the name of CMU not be
+ * used in advertising or publicity pertaining to distribution of the
+ * software without specific, written prior permission.
  *
- * Origin: Id: crypt.c,v 1.3 1995/05/30 05:42:22 rgrimes Exp
+ * CMU DISCLAIMS ALL WARRANTIES WITH REGARD TO THIS SOFTWARE, INCLUDING
+ * ALL IMPLIED WARRANTIES OF MERCHANTABILITY AND FITNESS, IN NO EVENT SHALL
+ * CMU BE LIABLE FOR ANY SPECIAL, INDIRECT OR CONSEQUENTIAL DAMAGES OR
+ * ANY DAMAGES WHATSOEVER RESULTING FROM LOSS OF USE, DATA OR PROFITS,
+ * WHETHER IN AN ACTION OF CONTRACT, NEGLIGENCE OR OTHER TORTIOUS ACTION,
+ * ARISING OUT OF OR IN CONNECTION WITH THE USE OR PERFORMANCE OF THIS
+ * SOFTWARE.
 
 ==============================================================================
 
-helpers/basic_auth/NIS/:
+include/base64.h:
+lib/base64.c:
+
+/*
+   Copyright (C) 2002 Niels Möller, Dan Egnor
 
- * Adapted By Rabellino Sergio (rabellino@di.unito.it) For Solaris 2.x
- * From NCSA Authentication module
+   This file is part of GNU Nettle.
 
- * Written By Rabellino Sergio (rabellino@di.unito.it) For Solaris 2.x
+   GNU Nettle is free software: you can redistribute it and/or
+   modify it under the terms of either:
 
-==============================================================================
+     * the GNU Lesser General Public License as published by the Free
+       Software Foundation; either version 3 of the License, or (at your
+       option) any later version.
 
-helpers/basic_auth/PAM/:
+   or
 
- * Copyright (C) 1999,2002,2003 Henrik Nordstrom <hno@squid-cache.org>
- *
- *  This program is free software; you can redistribute it and/or modify
- *  it under the terms of the GNU General Public License as published by
- *  the Free Software Foundation; either version 2 of the License, or
- *  (at your option) any later version.
- *
- *  This program is distributed in the hope that it will be useful,
- *  but WITHOUT ANY WARRANTY; without even the implied warranty of
- *  MERCHANTABILITY or FITNESS FOR A PARTICULAR PURPOSE.  See the
- *  GNU General Public License for more details.
- *
- *  You should have received a copy of the GNU General Public License
- *  along with this program; if not, write to the Free Software
- *  Foundation, Inc., 59 Temple Place, Suite 330, Boston, MA 02111, USA.
+     * the GNU General Public License as published by the Free
+       Software Foundation; either version 2 of the License, or (at your
+       option) any later version.
 
-==============================================================================
+   or both in parallel, as here.
 
-helpers/basic_auth/POP3/,
-helpers/external_acl/session/:
+   GNU Nettle is distributed in the hope that it will be useful,
+   but WITHOUT ANY WARRANTY; without even the implied warranty of
+   MERCHANTABILITY or FITNESS FOR A PARTICULAR PURPOSE.  See the GNU
+   General Public License for more details.
 
-# Copyright (C) 2006 Henrik Nordstrom <henrik@henriknordstrom.net>
-#
-# This program is free software; you can redistribute it and/or modify
-# it under the terms of the GNU General Public License as published by
-# the Free Software Foundation; either version 2 of the License, or
-# (at your option) any later version.
-#
-# This program is distributed in the hope that it will be useful,
-# but WITHOUT ANY WARRANTY; without even the implied warranty of
-# MERCHANTABILITY or FITNESS FOR A PARTICULAR PURPOSE.  See the
-# GNU General Public License for more details.
-#
-# You should have received a copy of the GNU General Public License
-# along with this program; if not, write to the Free Software
-# Foundation, Inc., 59 Temple Place, Suite 330, Boston, MA 02111, USA.
+   You should have received copies of the GNU General Public License and
+   the GNU Lesser General Public License along with this program.  If
+   not, see http://www.gnu.org/licenses/.
+*/
 
 ==============================================================================
 
-helpers/basic_auth/RADIUS/:
+include/heap.h,
+lib/heap.cc:
 
-This program is based on code from Livingston Enterprises, Inc. and parts are
+ * AUTHOR: John Dilley, Hewlett Packard
 
-		COPYRIGHT NOTICE SQUID_RAD_AUTH
+ * Copyright (C) 1999 by Hewlett Packard
 
-Copyright (C) 1992-1995 Livingston Enterprises, Inc and Cistron Internet Services
-B.V. who both have given permission to modify and distribute those parts. The new
-parts of the code is Copyright (C) 1998 R.M. van Selm <selm@cistron.nl> with
-modifications Copyright (C) 2004 Henrik Nordstrom <hno@squid-cache.org>
+==============================================================================
 
-Permission to use, copy, modify, and distribute this software for any purpose
-and without fee is hereby granted, provided that this copyright and permission
-notice appear on all copies and supporting documentation, the name of
-Livingston Enterprises, Inc. not be used in advertising or publicity pertaining
-to distribution of the program without specific prior permission, and notice be
-given in supporting documentation that copying and distribution is by
-permission of Livingston Enterprises, Inc. and Cistron Internet Services B.V.
+include/md5.h,
+lib/md5.c:
 
-Neither Livingston Enterprises, Inc. nor Cistron Internet Services B.V. nor I
-(R.M. van Selm) make representations about the suitability of this software for
-any purpose. It isprovided "as is" without express or implied warranty.
+ * The algorithm is due to Ron Rivest.  This code was
+ * written by Colin Plumb in 1993, no copyright is claimed.
+ * This code is in the public domain; do with it what you wish.
 
-Marc van Selm <selm@cistron.nl>
+==============================================================================
 
+include/parse.h,
+include/snmp_api.h,
+lib/snmplib/parse.c:
 
-		COPYRIGHT NOTICE SQUID_RAD_AUTH Documentation
+/***********************************************************
+        Copyright 1989 by Carnegie Mellon University
 
-Copyright (C) 2004 Henrik Nordstrom
+                      All Rights Reserved
 
-Permission to use, copy, modify, and distribute this software for any purpose
-and without fee is hereby granted, provided that this copyright and permission
-notice appear on all copies and supporting documentation, the name of Henrik
-Nordstrom. not be used in advertising or publicity pertaining to distribution
-of the program without specific prior permission.
+Permission to use, copy, modify, and distribute this software and its
+documentation for any purpose and without fee is hereby granted,
+provided that the above copyright notice appear in all copies and that
+both that copyright notice and this permission notice appear in
+supporting documentation, and that the name of CMU not be
+used in advertising or publicity pertaining to distribution of the
+software without specific, written prior permission.
 
-The author makes no representations about the suitability of this documentation
-for any purpose. It isprovided "as is" without express or implied warranty.
+CMU DISCLAIMS ALL WARRANTIES WITH REGARD TO THIS SOFTWARE, INCLUDING
+ALL IMPLIED WARRANTIES OF MERCHANTABILITY AND FITNESS, IN NO EVENT SHALL
+CMU BE LIABLE FOR ANY SPECIAL, INDIRECT OR CONSEQUENTIAL DAMAGES OR
+ANY DAMAGES WHATSOEVER RESULTING FROM LOSS OF USE, DATA OR PROFITS,
+WHETHER IN AN ACTION OF CONTRACT, NEGLIGENCE OR OTHER TORTIOUS ACTION,
+ARISING OUT OF OR IN CONNECTION WITH THE USE OR PERFORMANCE OF THIS
+SOFTWARE.
+******************************************************************/
 
-Henrik Nordstrom <hno@squid-cache.org>
+==============================================================================
 
-		COPYRIGHT NOTICE CISTRON RADIUS
+include/radix.h,
+lib/radix.c:
 
-/* This program is based on code from Livingston Enterprises, Inc. and parts are
- * Copyright (C) 1992-1995 Livingston Enterprises, Inc who has given permission
- * to modify and distribute those parts. The new code is Copyright (C) 1996-1997
- * Cistron Internet Services B.V.
+ * Copyright (c) 1988, 1989, 1993
+ *      The Regents of the University of California.  All rights reserved.
  *
- * Permission to use, copy, modify, and distribute this software for any purpose
- * and without fee is hereby granted, provided that this copyright and permission
- * notice appear on all copies and supporting documentation, the name of
- * Livingston Enterprises, Inc. not be used in advertising or publicity pertaining
- * to distribution of the program without specific prior permission, and notice be
- * given in supporting documentation that copying and distribution is by
- * permission of Livingston Enterprises, Inc. and Cistron Internet Services B.V.
-
- * Neither Livingston Enterprises, Inc. nor Cistron Internet Services B.V. make
- * representations about the suitability of this software for any purpose. It is
- * provided "as is" without express or implied warranty.
-*/
-
-		COPYRIGHT NOTICE LIVINGSTON RADIUS 1.16
-
-/*
- *
- *	RADIUS
- *	Remote Authentication Dial In User Service
- *
- *
- *	Livingston Enterprises, Inc.
- *	6920 Koll Center Parkway
- *	Pleasanton, CA   94566
- *
- *	Copyright 1992 Livingston Enterprises, Inc.
- *
- *	Permission to use, copy, modify, and distribute this software for any
- *	purpose and without fee is hereby granted, provided that this
- *	copyright and permission notice appear on all copies and supporting
- *	documentation, the name of Livingston Enterprises, Inc. not be used
- *	in advertising or publicity pertaining to distribution of the
- *	program without specific prior permission, and notice be given
- *	in supporting documentation that copying and distribution is by
- *	permission of Livingston Enterprises, Inc.   
- *
- *	Livingston Enterprises, Inc. makes no representations about
- *	the suitability of this software for any purpose.  It is
- *	provided "as is" without express or implied warranty.
+ * Redistribution and use in source and binary forms, with or without
+ * modification, are permitted provided that the following conditions
+ * are met:
+ * 1. Redistributions of source code must retain the above copyright
+ *    notice, this list of conditions and the following disclaimer.
+ * 2. Redistributions in binary form must reproduce the above copyright
+ *    notice, this list of conditions and the following disclaimer in the
+ *    documentation and/or other materials provided with the distribution.
+ * 3. Neither the name of the University nor the names of its contributors
+ *    may be used to endorse or promote products derived from this software
+ *    without specific prior written permission.
  *
+ * THIS SOFTWARE IS PROVIDED BY THE REGENTS AND CONTRIBUTORS ``AS IS'' AND
+ * ANY EXPRESS OR IMPLIED WARRANTIES, INCLUDING, BUT NOT LIMITED TO, THE
+ * IMPLIED WARRANTIES OF MERCHANTABILITY AND FITNESS FOR A PARTICULAR PURPOSE
+ * ARE DISCLAIMED.  IN NO EVENT SHALL THE REGENTS OR CONTRIBUTORS BE LIABLE
+ * FOR ANY DIRECT, INDIRECT, INCIDENTAL, SPECIAL, EXEMPLARY, OR CONSEQUENTIAL
+ * DAMAGES (INCLUDING, BUT NOT LIMITED TO, PROCUREMENT OF SUBSTITUTE GOODS
+ * OR SERVICES; LOSS OF USE, DATA, OR PROFITS; OR BUSINESS INTERRUPTION)
+ * HOWEVER CAUSED AND ON ANY THEORY OF LIABILITY, WHETHER IN CONTRACT, STRICT
+ * LIABILITY, OR TORT (INCLUDING NEGLIGENCE OR OTHERWISE) ARISING IN ANY WAY
+ * OUT OF THE USE OF THIS SOFTWARE, EVEN IF ADVISED OF THE POSSIBILITY OF
+ * SUCH DAMAGE.
 
+==============================================================================
 
-		COPYRIGHT NOTICE RSA Data Security MD5 (md5.c)
-
-MD5C.C - RSA Data Security, Inc., MD5 message-digest algorithm
-
-Copyright (C) 1991-2, RSA Data Security, Inc. Created 1991. All
-rights reserved.
-
-License to copy and use this software is granted provided that it
-is identified as the "RSA Data Security, Inc. MD5 Message-Digest
-Algorithm" in all material mentioning or referencing this software
-or this function.
-
-License is also granted to make and use derivative works provided
-that such works are identified as "derived from the RSA Data
-Security, Inc. MD5 Message-Digest Algorithm" in all material
-mentioning or referencing the derived work.
+include/rfc2617.h,
+lib/rfc2617.c:
 
-RSA Data Security, Inc. makes no representations concerning either
-the merchantability of this software or the suitability of this
-software for any particular purpose. It is provided "as is"
-without express or implied warranty of any kind.
+ * The source in this file is derived from the reference implementation
+ * in RFC 2617.
+ * RFC 2617 is Copyright (C) The Internet Society (1999).  All Rights Reserved.
 
-These notices must be retained in any copies of any part of this
-documentation and/or software.
+==============================================================================
 
+include/snmp_client.h,
+include/snmp_impl.h,
+lib/snmplib/mib.c:
 
-/*
- * The new parts of the code is Copyright (C) 1998 R.M. van Selm <selm@cistron.nl>
- * with modifications
- *      Copyright (C) 2004 Henrik Nordstrom <hno@squid-cache.org>
- *      Copyright (C) 2006 Henrik Nordstrom <hno@squid-cache.org>
- */
+/***********************************************************
+        Copyright 1988, 1989 by Carnegie Mellon University
 
-==============================================================================
+                      All Rights Reserved
 
-helpers/basic_auth/SASL/:
+Permission to use, copy, modify, and distribute this software and its
+documentation for any purpose and without fee is hereby granted,
+provided that the above copyright notice appear in all copies and that
+both that copyright notice and this permission notice appear in
+supporting documentation, and that the name of CMU not be
+used in advertising or publicity pertaining to distribution of the
+software without specific, written prior permission.
 
- * Copyright (C) 2002 Ian Castle <ian.castle@coldcomfortfarm.net>
- *
- *  This program is free software; you can redistribute it and/or modify
- *  it under the terms of the GNU General Public License as published by
- *  the Free Software Foundation; either version 2 of the License, or
- *  (at your option) any later version.
- *
- *  This program is distributed in the hope that it will be useful,
- *  but WITHOUT ANY WARRANTY; without even the implied warranty of
- *  MERCHANTABILITY or FITNESS FOR A PARTICULAR PURPOSE.  See the
- *  GNU General Public License for more details.
- *
- *  You should have received a copy of the GNU General Public License
- *  along with this program; if not, write to the Free Software
- *  Foundation, Inc., 59 Temple Place, Suite 330, Boston, MA 02111, USA.
+CMU DISCLAIMS ALL WARRANTIES WITH REGARD TO THIS SOFTWARE, INCLUDING
+ALL IMPLIED WARRANTIES OF MERCHANTABILITY AND FITNESS, IN NO EVENT SHALL
+CMU BE LIABLE FOR ANY SPECIAL, INDIRECT OR CONSEQUENTIAL DAMAGES OR
+ANY DAMAGES WHATSOEVER RESULTING FROM LOSS OF USE, DATA OR PROFITS,
+WHETHER IN AN ACTION OF CONTRACT, NEGLIGENCE OR OTHER TORTIOUS ACTION,
+ARISING OUT OF OR IN CONNECTION WITH THE USE OR PERFORMANCE OF THIS
+SOFTWARE.
+******************************************************************/
 
 ==============================================================================
 
-helpers/basic_auth/SMB/:
+include/snmp_util.h:
 
- *  Copyright (C) 1998  Richard Huveneers <richard@hekkihek.hacom.nl>
- *
- *  This program is free software; you can redistribute it and/or modify
- *  it under the terms of the GNU General Public License as published by
- *  the Free Software Foundation; either version 2 of the License, or
- *  (at your option) any later version.
- *
- *  This program is distributed in the hope that it will be useful,
- *  but WITHOUT ANY WARRANTY; without even the implied warranty of
- *  MERCHANTABILITY or FITNESS FOR A PARTICULAR PURPOSE.  See the
- *  GNU General Public License for more details.
- *
- *  You should have received a copy of the GNU General Public License
- *  along with this program; if not, write to the Free Software
+ * Copyright (c) 1997 FT/CNET/DES/GRL Olivier Montanuy
 
 ==============================================================================
 
-helpers/basic_auth/SMB_LM/:
+lib/rfcnb/,
+lib/smblib/:
 
- * (C) 2000 Antonino Iannella, Stellar-X Pty Ltd
- * Released under GPL, see COPYING-2.0 for details.
+  Copyright holders: Richard Sharpe, Andrew Tridgell, and Merik Karman
+  with updates by Squid contributors
 
- * Released under GNU Public License
- *
  * This program is free software; you can redistribute it and/or modify
  * it under the terms of the GNU General Public License as published by
  * the Free Software Foundation; either version 2 of the License, or
@@ -995,43 +931,49 @@ helpers/basic_auth/SMB_LM/:
 
 ==============================================================================
 
-helpers/basic_auth/SSPI/:
+lib/base64.c::base64_encode():
 
-  Guido Serassio, Torino - Italy
+Adopted from http://ftp.sunet.se/pub2/gnu/vm/base64-encode.c.
+Modified to work with strings instead of files.
 
-  Uses code from -
-    Antonino Iannella 2000
-    Andrew Tridgell 1997
-    Richard Sharpe 1996
-    Bill Welliver 1999
+==============================================================================
 
- * Distributed freely under the terms of the GNU General Public License,
- * version 2 or later. See the file COPYING for licensing details
- *
- * This program is distributed in the hope that it will be useful,
- * but WITHOUT ANY WARRANTY; without even the implied warranty of
- * MERCHANTABILITY or FITNESS FOR A PARTICULAR PURPOSE.  See the
- * GNU General Public License for more details.
+lib/dirent.c:
 
- * You should have received a copy of the GNU General Public License
- * along with this program; if not, write to the Free Software
- * Foundation, Inc., 59 Temple Place, Suite 330, Boston, MA 02111, USA.
+/*
+ * Implement dirent-style opendir(), readdir(), closedir(), rewinddir(),
+ * seekdir() and telldir on Windows - Based on mingw-runtime package sources.
+ * AUTHOR: Guido Serassio <serassio@squid-cache.org>
+ */
+
+/*
+ * Original file info follow:
+ *
+ * dirent.c
+ * This file has no copyright assigned and is placed in the Public Domain.
+ * This file is a part of the mingw-runtime package.
+ * No warranty is given; refer to the file DISCLAIMER within the package.
+ *
+ * Derived from DIRLIB.C by Matt J. Weinstein
+ * This note appears in the DIRLIB.H
+ * DIRLIB.H by M. J. Weinstein   Released to public domain 1-Jan-89
+ *
+ * Updated by Jeremy Bettis <jeremy@hksys.com>
+ * Significantly revised and rewinddir, seekdir and telldir added by Colin
+ * Peters <colin@fu.is.saga-u.ac.jp>
+ *
+ */
 
 ==============================================================================
 
-helpers/digest_auth/eDirectory/digest_ldap.c:
+lib/encrypt.c:
 
- * Copied From Samba-3.0.24 pdb_nds.c and trimmed down to the
- * limited functionality needed to access the plain text password only
- *
- * Original copyright & license follows:
- *
- * Copyright (C) Vince Brimhall                 2004-2005
+ * Copyright (C) 1991 Jochen Obalek
  *
  * This program is free software; you can redistribute it and/or modify
  * it under the terms of the GNU General Public License as published by
- * the Free Software Foundation; either version 2 of the License, or
- * (at your option) any later version.
+ * the Free Software Foundation; either version 2, or (at your option)
+ * any later version.
  *
  * This program is distributed in the hope that it will be useful,
  * but WITHOUT ANY WARRANTY; without even the implied warranty of
@@ -1044,26 +986,90 @@ helpers/digest_auth/eDirectory/digest_ldap.c:
 
 ==============================================================================
 
-helpers/digest_auth/file/,
-helpers/digest_auth/LDAP/:
-
+lib/getopt.c:
 
- * AUTHOR: Robert Collins.
- *
- * Based on ncsa_auth.c by Arjan de Vet <Arjan.deVet@adv.iae.nl>
+/*
+ * Copyright (c) 1987, 1993, 1994
+ *	The Regents of the University of California.  All rights reserved.
  *
- * LDAP backend extension by Flavio Pescuma,
- * MARA Systems AB <flavio@marasystems.com>
+ * Redistribution and use in source and binary forms, with or without
+ * modification, are permitted provided that the following conditions
+ * are met:
+ * 1. Redistributions of source code must retain the above copyright
+ *    notice, this list of conditions and the following disclaimer.
+ * 2. Redistributions in binary form must reproduce the above copyright
+ *    notice, this list of conditions and the following disclaimer in the
+ *    documentation and/or other materials provided with the distribution.
+ * 3. Neither the name of the University nor the names of its contributors
+ *    may be used to endorse or promote products derived from this software
+ *    without specific prior written permission.
  *
- * Example digest authentication program for Squid, based on the original
- * proxy_auth code from client_side.c, written by
- * Jon Thackray <jrmt@uk.gdscorp.com>.
+ * THIS SOFTWARE IS PROVIDED BY THE REGENTS AND CONTRIBUTORS ``AS IS'' AND
+ * ANY EXPRESS OR IMPLIED WARRANTIES, INCLUDING, BUT NOT LIMITED TO, THE
+ * IMPLIED WARRANTIES OF MERCHANTABILITY AND FITNESS FOR A PARTICULAR PURPOSE
+ * ARE DISCLAIMED.  IN NO EVENT SHALL THE REGENTS OR CONTRIBUTORS BE LIABLE
+ * FOR ANY DIRECT, INDIRECT, INCIDENTAL, SPECIAL, EXEMPLARY, OR CONSEQUENTIAL
+ * DAMAGES (INCLUDING, BUT NOT LIMITED TO, PROCUREMENT OF SUBSTITUTE GOODS
+ * OR SERVICES; LOSS OF USE, DATA, OR PROFITS; OR BUSINESS INTERRUPTION)
+ * HOWEVER CAUSED AND ON ANY THEORY OF LIABILITY, WHETHER IN CONTRACT, STRICT
+ * LIABILITY, OR TORT (INCLUDING NEGLIGENCE OR OTHERWISE) ARISING IN ANY WAY
+ * OUT OF THE USE OF THIS SOFTWARE, EVEN IF ADVISED OF THE POSSIBILITY OF
+ * SUCH DAMAGE.
+ */
 
- * Copyright (c) 2003  Robert Collins  <robertc@squid-cache.org>
+==============================================================================
+
+lib/radix.c:
+
+ *  Adapted from HTSUtils.c in CERN httpd 3.0 (http://info.cern.ch/httpd/)
+ *  by Darren Hardy <hardy@cs.colorado.edu>, November 1994.
 
 ==============================================================================
 
-helpers/external_acl/AD_group/:
+lib/Splay.cc:
+
+ * based on ftp://ftp.cs.cmu.edu/user/sleator/splaying/top-down-splay.c
+ * http://bobo.link.cs.cmu.edu/cgi-bin/splay/splay-cgi.pl
+
+==============================================================================
+
+libltdl/:
+
+   Copyright (C) Free Software Foundation, Inc.
+
+GNU Libltdl is free software; you can redistribute it and/or
+modify it under the terms of the GNU Lesser General Public
+License as published by the Free Software Foundation; either
+version 2 of the License, or (at your option) any later version.
+
+As a special exception to the GNU Lesser General Public License,
+if you distribute this file as part of a program or library that
+is built using GNU Libtool, you may include this file under the
+same distribution terms that you use for the rest of that program.
+
+GNU Libltdl is distributed in the hope that it will be useful,
+but WITHOUT ANY WARRANTY; without even the implied warranty of
+MERCHANTABILITY or FITNESS FOR A PARTICULAR PURPOSE.  See the
+GNU Lesser General Public License for more details.
+
+You should have received a copy of the GNU Lesser General Public
+License along with GNU Libltdl; see the file COPYING.LIB.  If not, a
+copy can be downloaded from  http://www.gnu.org/licenses/lgpl.html,
+or obtained by writing to the Free Software Foundation, Inc.,
+51 Franklin Street, Fifth Floor, Boston, MA 02110-1301, USA.
+
+
+==============================================================================
+
+src/access_log.cc:
+
+mcast_encode() in src/access_log.c is derived from Mark Atkinson's
+(mark_a@cix.compulink.co.uk) "Tiny Encryption Algorithm".
+http://www.io.com/~paulhart/game/algorithms/tea.html
+
+==============================================================================
+
+src/acl/external/AD_group/:
 
  * (C)2008-2009 Guido Serassio - Acme Consulting S.r.l.
  *
@@ -1094,7 +1100,7 @@ helpers/external_acl/AD_group/:
 
 ==============================================================================
 
-helpers/external_acl/delayer/:
+src/acl/external/delayer/:
 
 (C) 2014 Francesco Chemolli <kinkie@squid-cache.org>
 
@@ -1104,7 +1110,7 @@ later version.
 
 ==============================================================================
 
-helpers/external_acl/eDirectory_userip/ext_edirectory_userip_acl.cc:
+src/acl/external/eDirectory_userip/ext_edirectory_userip_acl.cc:
 
  * Copyright (C) 2009-2011 Chad E. Naugle
  *
@@ -1129,7 +1135,7 @@ helpers/external_acl/eDirectory_userip/ext_edirectory_userip_acl.cc:
 
 ==============================================================================
 
-helpers/external_acl/file_userip/:
+src/acl/external/file_userip/:
 
  * Copyright (C) 2002 Rodrigo Campos
  *
@@ -1151,9 +1157,9 @@ helpers/external_acl/file_userip/:
 
 ==============================================================================
 
-helpers/external_acl/kerberos_ldap_group/,
-helpers/negotiate_auth/kerberos/,
-helpers/negotiate_auth/wrapper/:
+src/acl/external/kerberos_ldap_group/,
+src/auth/negotiate/kerberos/,
+src/auth/negotiate/wrapper/:
 
  * Author: Markus Moeller (markus_moeller at compuserve.com)
  *
@@ -1180,7 +1186,7 @@ helpers/negotiate_auth/wrapper/:
 
 ==============================================================================
 
-helpers/external_acl/kerberos_ldap_group/support_ldap.cc:
+src/acl/external/kerberos_ldap_group/support_ldap.cc:
 
 /* get_attributes is partly from OpenLDAP Software <http://www.openldap.org/>.
  *
@@ -1198,7 +1204,7 @@ helpers/external_acl/kerberos_ldap_group/support_ldap.cc:
 
 ==============================================================================
 
-helpers/external_acl/LDAP_group/:
+src/acl/external/LDAP_group/:
 
  * Version 2.17
  *
@@ -1221,7 +1227,7 @@ helpers/external_acl/LDAP_group/:
 
 ==============================================================================
 
-helpers/external_acl/LM_group/:
+src/acl/external/LM_group/:
 
  * (C)2002,2005 Guido Serassio - Acme Consulting S.r.l.
  *
@@ -1249,7 +1255,7 @@ helpers/external_acl/LM_group/:
 
 ==============================================================================
 
-helpers/external_acl/SQL_session/:
+src/acl/external/SQL_session/:
 
 Copyright (C) 2012 Amos Jeffries <amosjeffries@squid-cache.org>
 Based on original work in DB_auth by Henrik Nordstrom <henrik@henriknordstrom.net>
@@ -1260,7 +1266,7 @@ later version.
 
 ==============================================================================
 
-helpers/external_acl/time_quota/:
+src/acl/external/time_quota/:
 
  * Copyright (C) 2011 Dr. Tilmann Bubeck <t.bubeck@reinform.de>
  *
@@ -1280,7 +1286,7 @@ helpers/external_acl/time_quota/:
 
 ==============================================================================
 
-helpers/external_acl/unix_group/:
+src/acl/external/unix_group/:
 
  * This is a helper for the external ACL interface for Squid Cache
  * Copyright (C) 2002 Rodrigo Albani de Campos (rodrigo@geekbunker.org)
@@ -1304,7 +1310,7 @@ helpers/external_acl/unix_group/:
 
 ==============================================================================
 
-helpers/external_acl/wbinfo_group/wbinfo_group.pl:
+src/acl/external/wbinfo_group/wbinfo_group.pl:
 
  This program is put in the public domain by Jerry Murdock 
  <jmurdock@itraktech.com>. It is distributed in the hope that it will
@@ -1313,366 +1319,320 @@ helpers/external_acl/wbinfo_group/wbinfo_group.pl:
 
 ==============================================================================
 
-helpers/log_daemon/DB/:
+src/auth/basic/DB/:
 
-  Copyright (C) 2008 by Marcello Romani
-
-  This library is free software; you can redistribute it and/or modify
-  it under the same terms as Perl itself, either Perl version 5.8.8 or,
-  at your option, any later version of Perl 5 you may have available.
+Copyright (C) 2007 Henrik Nordstrom <henrik@henriknordstrom.net>
+Copyright (C) 2010 Luis Daniel Lucio Quiroz <dlucio@okay.com.mx> (Joomla support)
+This program is free software. You may redistribute copies of it under the
+terms of the GNU General Public License version 2, or (at youropinion) any
+later version.
 
 ==============================================================================
 
-helpers/negotiate_auth/SSPI/,
-helpers/ntlm/SSPI/:
+src/auth/basic/fake/fake.cc,
+src/helper/protocol_defines.h,
+src/http/url_rewriters/fake/:
 
- * (C)2005 Guido Serassio - Acme Consulting S.r.l.
- *
- * Authors:
- *  Guido Serassio <guido.serassio@acmeconsulting.it>
- *  Acme Consulting S.r.l., Italy <http://www.acmeconsulting.it>
- *
- * With contributions from others mentioned in the change history section
- * below.
- *
- * Based on previous work of Francesco Chemolli and Robert Collins.
+/*
+ * Copyright (c) 2009-2014, Treehouse Networks Ltd. New Zealand
+ * All rights reserved.
  *
- * Dependencies: Windows 2000 and later.
+ * Redistribution and use in source and binary forms, with or without
+ * modification, are permitted provided that the following conditions
+ * are met:
  *
- * This program is free software; you can redistribute it and/or modify
- * it under the terms of the GNU General Public License as published by
- * the Free Software Foundation; either version 2 of the License, or
- * (at your option) any later version.
+ * 1. Redistributions of source code must retain the above copyright
+ * notice, this list of conditions and the following disclaimer.
  *
- * This program is distributed in the hope that it will be useful,
- * but WITHOUT ANY WARRANTY; without even the implied warranty of
- * MERCHANTABILITY or FITNESS FOR A PARTICULAR PURPOSE.  See the
- * GNU General Public License for more details.
+ * 2. Redistributions in binary form must reproduce the above copyright
+ * notice, this list of conditions and the following disclaimer in the
+ * documentation and/or other materials provided with the distribution.
  *
- * You should have received a copy of the GNU General Public License
- * along with this program; if not, write to the Free Software
- * Foundation, Inc., 59 Temple Place, Suite 330, Boston, MA 02111, USA.
-
-==============================================================================
-
-helpers/ntlm_auth/fake/ntlm_fake_auth.cc:
-
- * AUTHOR: Andrew Doran <ad@interlude.eu.org>
- * AUTHOR: Robert Collins <rbtcollins@hotmail.com>
- * AUTHOR: Guido Serassio <guido.serassio@acmeconsulting.it>
-
- * Example ntlm authentication program for Squid, based on the
- * original proxy_auth code from client_side.c, written by
- * Jon Thackray <jrmt@uk.gdscorp.com>. Initial ntlm code by
- * Andrew Doran <ad@interlude.eu.org>.
-
+ * THIS SOFTWARE IS PROVIDED BY THE COPYRIGHT HOLDERS AND CONTRIBUTORS
+ * "AS IS" AND ANY EXPRESS OR IMPLIED WARRANTIES, INCLUDING, BUT NOT
+ * LIMITED TO, THE IMPLIED WARRANTIES OF MERCHANTABILITY AND FITNESS
+ * FOR A PARTICULAR PURPOSE ARE DISCLAIMED. IN NO EVENT SHALL THE
+ * COPYRIGHT HOLDER OR CONTRIBUTORS BE LIABLE FOR ANY DIRECT, INDIRECT,
+ * INCIDENTAL, SPECIAL, EXEMPLARY, OR CONSEQUENTIAL DAMAGES (INCLUDING,
+ * BUT NOT LIMITED TO, PROCUREMENT OF SUBSTITUTE GOODS OR SERVICES;
+ * LOSS OF USE, DATA, OR PROFITS; OR BUSINESS INTERRUPTION) HOWEVER
+ * CAUSED AND ON ANY THEORY OF LIABILITY, WHETHER IN CONTRACT, STRICT
+ * LIABILITY, OR TORT (INCLUDING NEGLIGENCE OR OTHERWISE) ARISING IN
+ * ANY WAY OUT OF THE USE OF THIS SOFTWARE, EVEN IF ADVISED OF THE
+ * POSSIBILITY OF SUCH DAMAGE.
+ */
 
 ==============================================================================
 
-helpers/ntlm_auth/fake/ntlm_fake_auth.pl.in:
+src/auth/basic/getpwnam/:
 
-# (C) 2000 Francesco Chemolli <kinkie@kame.usr.dsi.unimi.it>
-# Distributed freely under the terms of the GNU General Public License,
-# version 2 or later. For the licensing terms, see the file COPYING that
-# came with Squid.
+ * AUTHOR: Erik Hofman <erik.hofman@a1.nl>
+ *         Robin Elfrink <robin@a1.nl>
 
 ==============================================================================
 
-helpers/ntlm_auth/smb_lm/:
-
- * (C) 2000 Francesco Chemolli <kinkie@kame.usr.dsi.unimi.it>
- * Distributed freely under the terms of the GNU General Public License,
- * version 2 or later. See the file COPYING for licensing details
- *
- * This program is distributed in the hope that it will be useful,
- * but WITHOUT ANY WARRANTY; without even the implied warranty of
- * MERCHANTABILITY or FITNESS FOR A PARTICULAR PURPOSE.  See the
- * GNU General Public License for more details.
+src/auth/basic/LDAP/:
 
- * You should have received a copy of the GNU General Public License
- * along with this program; if not, write to the Free Software
- * Foundation, Inc., 59 Temple Place, Suite 330, Boston, MA 02111, USA.
+ * License: squid_ldap_auth is free software; you can redistribute it
+ * and/or modify it under the terms of the GNU General Public License
+ * as published by the Free Software Foundation; either version 2,
+ * or (at your option) any later version.
 
 ==============================================================================
 
-helpers/storeid_rewrite/file/:
-
-Copyright (C) 2013 Alan Mizrahi <alan@mizrahi.com.ve>
-Based on code from Eliezer Croitoru <eliezer@ngtech.co.il>
-
-This program is free software; you can redistribute it and/or modify
-it under the terms of the GNU General Public License as published by
-the Free Software Foundation; either version 2 of the License, or
-(at your option) any later version.
+src/auth/basic/NCSA/basic_ncsa_auth.8:
 
-This program is distributed in the hope that it will be useful,
+This file is distributed in the hope that it will be useful,
 but WITHOUT ANY WARRANTY; without even the implied warranty of
-MERCHANTABILITY or FITNESS FOR A PARTICULAR PURPOSE.  See the
-GNU General Public License for more details.
+MERCHANTABILITY or FITNESS FOR A PARTICULAR PURPOSE. See
+the GNU General Public License for more details.
 
 You should have received a copy of the GNU General Public License
-along with this program; if not, write to the Free Software
-Foundation, Inc., 59 Temple Place, Suite 330, Boston, MA  02111-1307, USA.
-
-==============================================================================
-
-helpers/url_rewrite/LFS/rredir.cc:
-
- * version 0.1, 7 sep 1996
- * - initial version (Richard Huveneers <Richard.Huveneers@hekkihek.hacom.nl>)
+along with this file; if not, write to the Free Software
+Foundation, Inc., 59 Temple Place, Suite 330, Boston,
+MA 02111\-1307 USA
 
 ==============================================================================
 
-icons/silk/:
-
-  Silk icon set 1.3
-  _________________________________________
-  Mark James
-  http://www.famfamfam.com/lab/icons/silk/
-  _________________________________________
-
-  This work is licensed under a
-  Creative Commons Attribution 2.5 License.
-  [ http://creativecommons.org/licenses/by/2.5/ ]
-
-  This means you may use it for any purpose,
-  and make any changes you like.
-  All I ask is that you include a link back
-  to this page in your credits.
-
-  Are you using this icon set? Send me an email
-  (including a link or picture if available) to
-  mjames@gmail.com
-
-  Any other questions about this icon set please
-  contact mjames@gmail.com
-
-
-  The icons can also be used under Creative Commons Attribution 3.0 License
-  (Hi Debian folks!) with the following requirements:
+src/auth/basic/NCSA/crypt_md5.cc:
 
-    As an author, I would appreciate a reference to my authorship of
-    the Silk icon set contents within a readme file or equivalent
-    documentation for the software which includes the set or a subset
-    of the icons contained within. 
+ * Shamelessly stolen from linux-pam, and adopted to work with
+ * OpenSSL md5 implementation and any magic string
+ *
+ * Origin2: md5_crypt.c,v 1.1.1.1 2000/01/03 17:34:46 gafton Exp
+ *
+ * ----------------------------------------------------------------------------
+ * "THE BEER-WARE LICENSE" (Revision 42):
+ * <phk@login.dknet.dk> wrote this file.  As long as you retain this notice you
+ * can do whatever you want with this stuff. If we meet some day, and you think
+ * this stuff is worth it, you can buy me a beer in return.   Poul-Henning Kamp
+ * ----------------------------------------------------------------------------
+ *
+ * Origin: Id: crypt.c,v 1.3 1995/05/30 05:42:22 rgrimes Exp
 
 ==============================================================================
 
-icons/SN.png:
+src/auth/basic/NIS/:
 
-  Squid NOW icon - copyright Squid Project
+ * Adapted By Rabellino Sergio (rabellino@di.unito.it) For Solaris 2.x
+ * From NCSA Authentication module
 
-  This work is licensed under the
-  Creative Commons Attribution-ShareAlike 3.0 Unported Liscence (CC BY-SA 3.0)
-  [ http://creativecommons.org/licenses/by-sa/3.0/ ]
+ * Written By Rabellino Sergio (rabellino@di.unito.it) For Solaris 2.x
 
 ==============================================================================
 
-include/asn1.h,
-include/snmp_api_error.h,
-include/snmp_api_util.h,
-include/snmp_coexist.h,
-include/snmp_error.h,
-include/snmp-internal.h,
-include/snmp-mib.h,
-include/snmp_msg.h,
-include/snmp_pdu.h,
-include/snmp_session.h,
-include/snmp_vars.h,
-include/snmp.h,
-lib/snmplib/asn1.c,
-lib/snmplib/coexistence.c,
-lib/snmplib/snmp_api.c,
-lib/snmplib/snmp_api_error.c,
-lib/snmplib/snmp_error.c,
-lib/snmplib/snmp_msg.c,
-lib/snmplib/snmp_pdu.c,
-lib/snmplib/snmp_vars.c:
+src/auth/basic/PAM/:
 
- *           Copyright 1997 by Carnegie Mellon University
+ * Copyright (C) 1999,2002,2003 Henrik Nordstrom <hno@squid-cache.org>
  *
- *                       All Rights Reserved
+ *  This program is free software; you can redistribute it and/or modify
+ *  it under the terms of the GNU General Public License as published by
+ *  the Free Software Foundation; either version 2 of the License, or
+ *  (at your option) any later version.
  *
- * Permission to use, copy, modify, and distribute this software and its
- * documentation for any purpose and without fee is hereby granted,
- * provided that the above copyright notice appear in all copies and that
- * both that copyright notice and this permission notice appear in
- * supporting documentation, and that the name of CMU not be
- * used in advertising or publicity pertaining to distribution of the
- * software without specific, written prior permission.
+ *  This program is distributed in the hope that it will be useful,
+ *  but WITHOUT ANY WARRANTY; without even the implied warranty of
+ *  MERCHANTABILITY or FITNESS FOR A PARTICULAR PURPOSE.  See the
+ *  GNU General Public License for more details.
  *
- * CMU DISCLAIMS ALL WARRANTIES WITH REGARD TO THIS SOFTWARE, INCLUDING
- * ALL IMPLIED WARRANTIES OF MERCHANTABILITY AND FITNESS, IN NO EVENT SHALL
- * CMU BE LIABLE FOR ANY SPECIAL, INDIRECT OR CONSEQUENTIAL DAMAGES OR
- * ANY DAMAGES WHATSOEVER RESULTING FROM LOSS OF USE, DATA OR PROFITS,
- * WHETHER IN AN ACTION OF CONTRACT, NEGLIGENCE OR OTHER TORTIOUS ACTION,
- * ARISING OUT OF OR IN CONNECTION WITH THE USE OR PERFORMANCE OF THIS
- * SOFTWARE.
+ *  You should have received a copy of the GNU General Public License
+ *  along with this program; if not, write to the Free Software
+ *  Foundation, Inc., 59 Temple Place, Suite 330, Boston, MA 02111, USA.
 
 ==============================================================================
 
-include/base64.h:
-lib/base64.c:
-
-/*
-   Copyright (C) 2002 Niels Möller, Dan Egnor
-
-   This file is part of GNU Nettle.
-
-   GNU Nettle is free software: you can redistribute it and/or
-   modify it under the terms of either:
-
-     * the GNU Lesser General Public License as published by the Free
-       Software Foundation; either version 3 of the License, or (at your
-       option) any later version.
-
-   or
+src/auth/basic/POP3/,
+src/acl/external/session/:
 
-     * the GNU General Public License as published by the Free
-       Software Foundation; either version 2 of the License, or (at your
-       option) any later version.
+# Copyright (C) 2006 Henrik Nordstrom <henrik@henriknordstrom.net>
+#
+# This program is free software; you can redistribute it and/or modify
+# it under the terms of the GNU General Public License as published by
+# the Free Software Foundation; either version 2 of the License, or
+# (at your option) any later version.
+#
+# This program is distributed in the hope that it will be useful,
+# but WITHOUT ANY WARRANTY; without even the implied warranty of
+# MERCHANTABILITY or FITNESS FOR A PARTICULAR PURPOSE.  See the
+# GNU General Public License for more details.
+#
+# You should have received a copy of the GNU General Public License
+# along with this program; if not, write to the Free Software
+# Foundation, Inc., 59 Temple Place, Suite 330, Boston, MA 02111, USA.
 
-   or both in parallel, as here.
+==============================================================================
 
-   GNU Nettle is distributed in the hope that it will be useful,
-   but WITHOUT ANY WARRANTY; without even the implied warranty of
-   MERCHANTABILITY or FITNESS FOR A PARTICULAR PURPOSE.  See the GNU
-   General Public License for more details.
+src/auth/basic/RADIUS/:
 
-   You should have received copies of the GNU General Public License and
-   the GNU Lesser General Public License along with this program.  If
-   not, see http://www.gnu.org/licenses/.
-*/
+This program is based on code from Livingston Enterprises, Inc. and parts are
 
-==============================================================================
+		COPYRIGHT NOTICE SQUID_RAD_AUTH
 
-include/heap.h,
-lib/heap.cc:
+Copyright (C) 1992-1995 Livingston Enterprises, Inc and Cistron Internet Services
+B.V. who both have given permission to modify and distribute those parts. The new
+parts of the code is Copyright (C) 1998 R.M. van Selm <selm@cistron.nl> with
+modifications Copyright (C) 2004 Henrik Nordstrom <hno@squid-cache.org>
 
- * AUTHOR: John Dilley, Hewlett Packard
+Permission to use, copy, modify, and distribute this software for any purpose
+and without fee is hereby granted, provided that this copyright and permission
+notice appear on all copies and supporting documentation, the name of
+Livingston Enterprises, Inc. not be used in advertising or publicity pertaining
+to distribution of the program without specific prior permission, and notice be
+given in supporting documentation that copying and distribution is by
+permission of Livingston Enterprises, Inc. and Cistron Internet Services B.V.
 
- * Copyright (C) 1999 by Hewlett Packard
+Neither Livingston Enterprises, Inc. nor Cistron Internet Services B.V. nor I
+(R.M. van Selm) make representations about the suitability of this software for
+any purpose. It isprovided "as is" without express or implied warranty.
 
-==============================================================================
+Marc van Selm <selm@cistron.nl>
 
-include/md5.h,
-lib/md5.c:
 
- * The algorithm is due to Ron Rivest.  This code was
- * written by Colin Plumb in 1993, no copyright is claimed.
- * This code is in the public domain; do with it what you wish.
+		COPYRIGHT NOTICE SQUID_RAD_AUTH Documentation
 
-==============================================================================
+Copyright (C) 2004 Henrik Nordstrom
 
-include/parse.h,
-include/snmp_api.h,
-lib/snmplib/parse.c:
+Permission to use, copy, modify, and distribute this software for any purpose
+and without fee is hereby granted, provided that this copyright and permission
+notice appear on all copies and supporting documentation, the name of Henrik
+Nordstrom. not be used in advertising or publicity pertaining to distribution
+of the program without specific prior permission.
 
-/***********************************************************
-        Copyright 1989 by Carnegie Mellon University
+The author makes no representations about the suitability of this documentation
+for any purpose. It isprovided "as is" without express or implied warranty.
 
-                      All Rights Reserved
+Henrik Nordstrom <hno@squid-cache.org>
 
-Permission to use, copy, modify, and distribute this software and its
-documentation for any purpose and without fee is hereby granted,
-provided that the above copyright notice appear in all copies and that
-both that copyright notice and this permission notice appear in
-supporting documentation, and that the name of CMU not be
-used in advertising or publicity pertaining to distribution of the
-software without specific, written prior permission.
+		COPYRIGHT NOTICE CISTRON RADIUS
 
-CMU DISCLAIMS ALL WARRANTIES WITH REGARD TO THIS SOFTWARE, INCLUDING
-ALL IMPLIED WARRANTIES OF MERCHANTABILITY AND FITNESS, IN NO EVENT SHALL
-CMU BE LIABLE FOR ANY SPECIAL, INDIRECT OR CONSEQUENTIAL DAMAGES OR
-ANY DAMAGES WHATSOEVER RESULTING FROM LOSS OF USE, DATA OR PROFITS,
-WHETHER IN AN ACTION OF CONTRACT, NEGLIGENCE OR OTHER TORTIOUS ACTION,
-ARISING OUT OF OR IN CONNECTION WITH THE USE OR PERFORMANCE OF THIS
-SOFTWARE.
-******************************************************************/
+/* This program is based on code from Livingston Enterprises, Inc. and parts are
+ * Copyright (C) 1992-1995 Livingston Enterprises, Inc who has given permission
+ * to modify and distribute those parts. The new code is Copyright (C) 1996-1997
+ * Cistron Internet Services B.V.
+ *
+ * Permission to use, copy, modify, and distribute this software for any purpose
+ * and without fee is hereby granted, provided that this copyright and permission
+ * notice appear on all copies and supporting documentation, the name of
+ * Livingston Enterprises, Inc. not be used in advertising or publicity pertaining
+ * to distribution of the program without specific prior permission, and notice be
+ * given in supporting documentation that copying and distribution is by
+ * permission of Livingston Enterprises, Inc. and Cistron Internet Services B.V.
 
-==============================================================================
+ * Neither Livingston Enterprises, Inc. nor Cistron Internet Services B.V. make
+ * representations about the suitability of this software for any purpose. It is
+ * provided "as is" without express or implied warranty.
+*/
 
-include/radix.h,
-lib/radix.c:
+		COPYRIGHT NOTICE LIVINGSTON RADIUS 1.16
 
- * Copyright (c) 1988, 1989, 1993
- *      The Regents of the University of California.  All rights reserved.
+/*
  *
- * Redistribution and use in source and binary forms, with or without
- * modification, are permitted provided that the following conditions
- * are met:
- * 1. Redistributions of source code must retain the above copyright
- *    notice, this list of conditions and the following disclaimer.
- * 2. Redistributions in binary form must reproduce the above copyright
- *    notice, this list of conditions and the following disclaimer in the
- *    documentation and/or other materials provided with the distribution.
- * 3. Neither the name of the University nor the names of its contributors
- *    may be used to endorse or promote products derived from this software
- *    without specific prior written permission.
+ *	RADIUS
+ *	Remote Authentication Dial In User Service
+ *
+ *
+ *	Livingston Enterprises, Inc.
+ *	6920 Koll Center Parkway
+ *	Pleasanton, CA   94566
+ *
+ *	Copyright 1992 Livingston Enterprises, Inc.
+ *
+ *	Permission to use, copy, modify, and distribute this software for any
+ *	purpose and without fee is hereby granted, provided that this
+ *	copyright and permission notice appear on all copies and supporting
+ *	documentation, the name of Livingston Enterprises, Inc. not be used
+ *	in advertising or publicity pertaining to distribution of the
+ *	program without specific prior permission, and notice be given
+ *	in supporting documentation that copying and distribution is by
+ *	permission of Livingston Enterprises, Inc.   
+ *
+ *	Livingston Enterprises, Inc. makes no representations about
+ *	the suitability of this software for any purpose.  It is
+ *	provided "as is" without express or implied warranty.
  *
- * THIS SOFTWARE IS PROVIDED BY THE REGENTS AND CONTRIBUTORS ``AS IS'' AND
- * ANY EXPRESS OR IMPLIED WARRANTIES, INCLUDING, BUT NOT LIMITED TO, THE
- * IMPLIED WARRANTIES OF MERCHANTABILITY AND FITNESS FOR A PARTICULAR PURPOSE
- * ARE DISCLAIMED.  IN NO EVENT SHALL THE REGENTS OR CONTRIBUTORS BE LIABLE
- * FOR ANY DIRECT, INDIRECT, INCIDENTAL, SPECIAL, EXEMPLARY, OR CONSEQUENTIAL
- * DAMAGES (INCLUDING, BUT NOT LIMITED TO, PROCUREMENT OF SUBSTITUTE GOODS
- * OR SERVICES; LOSS OF USE, DATA, OR PROFITS; OR BUSINESS INTERRUPTION)
- * HOWEVER CAUSED AND ON ANY THEORY OF LIABILITY, WHETHER IN CONTRACT, STRICT
- * LIABILITY, OR TORT (INCLUDING NEGLIGENCE OR OTHERWISE) ARISING IN ANY WAY
- * OUT OF THE USE OF THIS SOFTWARE, EVEN IF ADVISED OF THE POSSIBILITY OF
- * SUCH DAMAGE.
 
-==============================================================================
 
-include/rfc2617.h,
-lib/rfc2617.c:
+		COPYRIGHT NOTICE RSA Data Security MD5 (md5.c)
 
- * The source in this file is derived from the reference implementation
- * in RFC 2617.
- * RFC 2617 is Copyright (C) The Internet Society (1999).  All Rights Reserved.
+MD5C.C - RSA Data Security, Inc., MD5 message-digest algorithm
 
-==============================================================================
+Copyright (C) 1991-2, RSA Data Security, Inc. Created 1991. All
+rights reserved.
 
-include/snmp_client.h,
-include/snmp_impl.h,
-lib/snmplib/mib.c:
+License to copy and use this software is granted provided that it
+is identified as the "RSA Data Security, Inc. MD5 Message-Digest
+Algorithm" in all material mentioning or referencing this software
+or this function.
 
-/***********************************************************
-        Copyright 1988, 1989 by Carnegie Mellon University
+License is also granted to make and use derivative works provided
+that such works are identified as "derived from the RSA Data
+Security, Inc. MD5 Message-Digest Algorithm" in all material
+mentioning or referencing the derived work.
 
-                      All Rights Reserved
+RSA Data Security, Inc. makes no representations concerning either
+the merchantability of this software or the suitability of this
+software for any particular purpose. It is provided "as is"
+without express or implied warranty of any kind.
 
-Permission to use, copy, modify, and distribute this software and its
-documentation for any purpose and without fee is hereby granted,
-provided that the above copyright notice appear in all copies and that
-both that copyright notice and this permission notice appear in
-supporting documentation, and that the name of CMU not be
-used in advertising or publicity pertaining to distribution of the
-software without specific, written prior permission.
+These notices must be retained in any copies of any part of this
+documentation and/or software.
 
-CMU DISCLAIMS ALL WARRANTIES WITH REGARD TO THIS SOFTWARE, INCLUDING
-ALL IMPLIED WARRANTIES OF MERCHANTABILITY AND FITNESS, IN NO EVENT SHALL
-CMU BE LIABLE FOR ANY SPECIAL, INDIRECT OR CONSEQUENTIAL DAMAGES OR
-ANY DAMAGES WHATSOEVER RESULTING FROM LOSS OF USE, DATA OR PROFITS,
-WHETHER IN AN ACTION OF CONTRACT, NEGLIGENCE OR OTHER TORTIOUS ACTION,
-ARISING OUT OF OR IN CONNECTION WITH THE USE OR PERFORMANCE OF THIS
-SOFTWARE.
-******************************************************************/
+
+/*
+ * The new parts of the code is Copyright (C) 1998 R.M. van Selm <selm@cistron.nl>
+ * with modifications
+ *      Copyright (C) 2004 Henrik Nordstrom <hno@squid-cache.org>
+ *      Copyright (C) 2006 Henrik Nordstrom <hno@squid-cache.org>
+ */
 
 ==============================================================================
 
-include/snmp_util.h:
+src/auth/basic/SASL/:
 
- * Copyright (c) 1997 FT/CNET/DES/GRL Olivier Montanuy
+ * Copyright (C) 2002 Ian Castle <ian.castle@coldcomfortfarm.net>
+ *
+ *  This program is free software; you can redistribute it and/or modify
+ *  it under the terms of the GNU General Public License as published by
+ *  the Free Software Foundation; either version 2 of the License, or
+ *  (at your option) any later version.
+ *
+ *  This program is distributed in the hope that it will be useful,
+ *  but WITHOUT ANY WARRANTY; without even the implied warranty of
+ *  MERCHANTABILITY or FITNESS FOR A PARTICULAR PURPOSE.  See the
+ *  GNU General Public License for more details.
+ *
+ *  You should have received a copy of the GNU General Public License
+ *  along with this program; if not, write to the Free Software
+ *  Foundation, Inc., 59 Temple Place, Suite 330, Boston, MA 02111, USA.
 
 ==============================================================================
 
-lib/rfcnb/,
-lib/smblib/:
+src/auth/basic/SMB/:
 
-  Copyright holders: Richard Sharpe, Andrew Tridgell, and Merik Karman
-  with updates by Squid contributors
+ *  Copyright (C) 1998  Richard Huveneers <richard@hekkihek.hacom.nl>
+ *
+ *  This program is free software; you can redistribute it and/or modify
+ *  it under the terms of the GNU General Public License as published by
+ *  the Free Software Foundation; either version 2 of the License, or
+ *  (at your option) any later version.
+ *
+ *  This program is distributed in the hope that it will be useful,
+ *  but WITHOUT ANY WARRANTY; without even the implied warranty of
+ *  MERCHANTABILITY or FITNESS FOR A PARTICULAR PURPOSE.  See the
+ *  GNU General Public License for more details.
+ *
+ *  You should have received a copy of the GNU General Public License
+ *  along with this program; if not, write to the Free Software
+
+==============================================================================
 
+src/auth/basic/SMB_LM/:
+
+ * (C) 2000 Antonino Iannella, Stellar-X Pty Ltd
+ * Released under GPL, see COPYING-2.0 for details.
+
+ * Released under GNU Public License
+ *
  * This program is free software; you can redistribute it and/or modify
  * it under the terms of the GNU General Public License as published by
  * the Free Software Foundation; either version 2 of the License, or
@@ -1689,49 +1649,43 @@ lib/smblib/:
 
 ==============================================================================
 
-lib/base64.c::base64_encode():
-
-Adopted from http://ftp.sunet.se/pub2/gnu/vm/base64-encode.c.
-Modified to work with strings instead of files.
-
-==============================================================================
+src/auth/basic/SSPI/:
 
-lib/dirent.c:
+  Guido Serassio, Torino - Italy
 
-/*
- * Implement dirent-style opendir(), readdir(), closedir(), rewinddir(),
- * seekdir() and telldir on Windows - Based on mingw-runtime package sources.
- * AUTHOR: Guido Serassio <serassio@squid-cache.org>
- */
+  Uses code from -
+    Antonino Iannella 2000
+    Andrew Tridgell 1997
+    Richard Sharpe 1996
+    Bill Welliver 1999
 
-/*
- * Original file info follow:
- *
- * dirent.c
- * This file has no copyright assigned and is placed in the Public Domain.
- * This file is a part of the mingw-runtime package.
- * No warranty is given; refer to the file DISCLAIMER within the package.
- *
- * Derived from DIRLIB.C by Matt J. Weinstein
- * This note appears in the DIRLIB.H
- * DIRLIB.H by M. J. Weinstein   Released to public domain 1-Jan-89
- *
- * Updated by Jeremy Bettis <jeremy@hksys.com>
- * Significantly revised and rewinddir, seekdir and telldir added by Colin
- * Peters <colin@fu.is.saga-u.ac.jp>
+ * Distributed freely under the terms of the GNU General Public License,
+ * version 2 or later. See the file COPYING for licensing details
  *
- */
+ * This program is distributed in the hope that it will be useful,
+ * but WITHOUT ANY WARRANTY; without even the implied warranty of
+ * MERCHANTABILITY or FITNESS FOR A PARTICULAR PURPOSE.  See the
+ * GNU General Public License for more details.
+
+ * You should have received a copy of the GNU General Public License
+ * along with this program; if not, write to the Free Software
+ * Foundation, Inc., 59 Temple Place, Suite 330, Boston, MA 02111, USA.
 
 ==============================================================================
 
-lib/encrypt.c:
+src/auth/digest/eDirectory/digest_ldap.c:
 
- * Copyright (C) 1991 Jochen Obalek
+ * Copied From Samba-3.0.24 pdb_nds.c and trimmed down to the
+ * limited functionality needed to access the plain text password only
+ *
+ * Original copyright & license follows:
+ *
+ * Copyright (C) Vince Brimhall                 2004-2005
  *
  * This program is free software; you can redistribute it and/or modify
  * it under the terms of the GNU General Public License as published by
- * the Free Software Foundation; either version 2, or (at your option)
- * any later version.
+ * the Free Software Foundation; either version 2 of the License, or
+ * (at your option) any later version.
  *
  * This program is distributed in the hope that it will be useful,
  * but WITHOUT ANY WARRANTY; without even the implied warranty of
@@ -1744,86 +1698,94 @@ lib/encrypt.c:
 
 ==============================================================================
 
-lib/getopt.c:
+src/auth/digest/file/,
+src/auth/digest/LDAP/:
 
-/*
- * Copyright (c) 1987, 1993, 1994
- *	The Regents of the University of California.  All rights reserved.
+
+ * AUTHOR: Robert Collins.
  *
- * Redistribution and use in source and binary forms, with or without
- * modification, are permitted provided that the following conditions
- * are met:
- * 1. Redistributions of source code must retain the above copyright
- *    notice, this list of conditions and the following disclaimer.
- * 2. Redistributions in binary form must reproduce the above copyright
- *    notice, this list of conditions and the following disclaimer in the
- *    documentation and/or other materials provided with the distribution.
- * 3. Neither the name of the University nor the names of its contributors
- *    may be used to endorse or promote products derived from this software
- *    without specific prior written permission.
+ * Based on ncsa_auth.c by Arjan de Vet <Arjan.deVet@adv.iae.nl>
  *
- * THIS SOFTWARE IS PROVIDED BY THE REGENTS AND CONTRIBUTORS ``AS IS'' AND
- * ANY EXPRESS OR IMPLIED WARRANTIES, INCLUDING, BUT NOT LIMITED TO, THE
- * IMPLIED WARRANTIES OF MERCHANTABILITY AND FITNESS FOR A PARTICULAR PURPOSE
- * ARE DISCLAIMED.  IN NO EVENT SHALL THE REGENTS OR CONTRIBUTORS BE LIABLE
- * FOR ANY DIRECT, INDIRECT, INCIDENTAL, SPECIAL, EXEMPLARY, OR CONSEQUENTIAL
- * DAMAGES (INCLUDING, BUT NOT LIMITED TO, PROCUREMENT OF SUBSTITUTE GOODS
- * OR SERVICES; LOSS OF USE, DATA, OR PROFITS; OR BUSINESS INTERRUPTION)
- * HOWEVER CAUSED AND ON ANY THEORY OF LIABILITY, WHETHER IN CONTRACT, STRICT
- * LIABILITY, OR TORT (INCLUDING NEGLIGENCE OR OTHERWISE) ARISING IN ANY WAY
- * OUT OF THE USE OF THIS SOFTWARE, EVEN IF ADVISED OF THE POSSIBILITY OF
- * SUCH DAMAGE.
- */
-
-==============================================================================
-
-lib/radix.c:
+ * LDAP backend extension by Flavio Pescuma,
+ * MARA Systems AB <flavio@marasystems.com>
+ *
+ * Example digest authentication program for Squid, based on the original
+ * proxy_auth code from client_side.c, written by
+ * Jon Thackray <jrmt@uk.gdscorp.com>.
 
- *  Adapted from HTSUtils.c in CERN httpd 3.0 (http://info.cern.ch/httpd/)
- *  by Darren Hardy <hardy@cs.colorado.edu>, November 1994.
+ * Copyright (c) 2003  Robert Collins  <robertc@squid-cache.org>
 
 ==============================================================================
 
-lib/Splay.cc:
+src/auth/negotiate/SSPI/,
+src/auth/ntlm/SSPI/:
 
- * based on ftp://ftp.cs.cmu.edu/user/sleator/splaying/top-down-splay.c
- * http://bobo.link.cs.cmu.edu/cgi-bin/splay/splay-cgi.pl
+ * (C)2005 Guido Serassio - Acme Consulting S.r.l.
+ *
+ * Authors:
+ *  Guido Serassio <guido.serassio@acmeconsulting.it>
+ *  Acme Consulting S.r.l., Italy <http://www.acmeconsulting.it>
+ *
+ * With contributions from others mentioned in the change history section
+ * below.
+ *
+ * Based on previous work of Francesco Chemolli and Robert Collins.
+ *
+ * Dependencies: Windows 2000 and later.
+ *
+ * This program is free software; you can redistribute it and/or modify
+ * it under the terms of the GNU General Public License as published by
+ * the Free Software Foundation; either version 2 of the License, or
+ * (at your option) any later version.
+ *
+ * This program is distributed in the hope that it will be useful,
+ * but WITHOUT ANY WARRANTY; without even the implied warranty of
+ * MERCHANTABILITY or FITNESS FOR A PARTICULAR PURPOSE.  See the
+ * GNU General Public License for more details.
+ *
+ * You should have received a copy of the GNU General Public License
+ * along with this program; if not, write to the Free Software
+ * Foundation, Inc., 59 Temple Place, Suite 330, Boston, MA 02111, USA.
 
 ==============================================================================
 
-libltdl/:
+src/auth/ntlm/fake/ntlm_fake_auth.cc:
 
-   Copyright (C) Free Software Foundation, Inc.
+ * AUTHOR: Andrew Doran <ad@interlude.eu.org>
+ * AUTHOR: Robert Collins <rbtcollins@hotmail.com>
+ * AUTHOR: Guido Serassio <guido.serassio@acmeconsulting.it>
 
-GNU Libltdl is free software; you can redistribute it and/or
-modify it under the terms of the GNU Lesser General Public
-License as published by the Free Software Foundation; either
-version 2 of the License, or (at your option) any later version.
+ * Example ntlm authentication program for Squid, based on the
+ * original proxy_auth code from client_side.c, written by
+ * Jon Thackray <jrmt@uk.gdscorp.com>. Initial ntlm code by
+ * Andrew Doran <ad@interlude.eu.org>.
 
-As a special exception to the GNU Lesser General Public License,
-if you distribute this file as part of a program or library that
-is built using GNU Libtool, you may include this file under the
-same distribution terms that you use for the rest of that program.
 
-GNU Libltdl is distributed in the hope that it will be useful,
-but WITHOUT ANY WARRANTY; without even the implied warranty of
-MERCHANTABILITY or FITNESS FOR A PARTICULAR PURPOSE.  See the
-GNU Lesser General Public License for more details.
+==============================================================================
 
-You should have received a copy of the GNU Lesser General Public
-License along with GNU Libltdl; see the file COPYING.LIB.  If not, a
-copy can be downloaded from  http://www.gnu.org/licenses/lgpl.html,
-or obtained by writing to the Free Software Foundation, Inc.,
-51 Franklin Street, Fifth Floor, Boston, MA 02110-1301, USA.
+src/auth/ntlm/fake/ntlm_fake_auth.pl.in:
 
+# (C) 2000 Francesco Chemolli <kinkie@kame.usr.dsi.unimi.it>
+# Distributed freely under the terms of the GNU General Public License,
+# version 2 or later. For the licensing terms, see the file COPYING that
+# came with Squid.
 
 ==============================================================================
 
-src/access_log.cc:
+src/auth/ntlm/smb_lm/:
 
-mcast_encode() in src/access_log.c is derived from Mark Atkinson's
-(mark_a@cix.compulink.co.uk) "Tiny Encryption Algorithm".
-http://www.io.com/~paulhart/game/algorithms/tea.html
+ * (C) 2000 Francesco Chemolli <kinkie@kame.usr.dsi.unimi.it>
+ * Distributed freely under the terms of the GNU General Public License,
+ * version 2 or later. See the file COPYING for licensing details
+ *
+ * This program is distributed in the hope that it will be useful,
+ * but WITHOUT ANY WARRANTY; without even the implied warranty of
+ * MERCHANTABILITY or FITNESS FOR A PARTICULAR PURPOSE.  See the
+ * GNU General Public License for more details.
+
+ * You should have received a copy of the GNU General Public License
+ * along with this program; if not, write to the Free Software
+ * Foundation, Inc., 59 Temple Place, Suite 330, Boston, MA 02111, USA.
 
 ==============================================================================
 
@@ -1847,6 +1809,23 @@ src/external_acl.c:
 
 ==============================================================================
 
+src/http/url_rewriters/LFS/rredir.cc:
+
+ * version 0.1, 7 sep 1996
+ * - initial version (Richard Huveneers <Richard.Huveneers@hekkihek.hacom.nl>)
+
+==============================================================================
+
+src/log/DB/:
+
+  Copyright (C) 2008 by Marcello Romani
+
+  This library is free software; you can redistribute it and/or modify
+  it under the same terms as Perl itself, either Perl version 5.8.8 or,
+  at your option, any later version of Perl 5 you may have available.
+
+==============================================================================
+
 src/repl/heap/store_heap_replacement.cc:
 
  * AUTHOR: John Dilley
@@ -1869,6 +1848,27 @@ later version.
 
 ==============================================================================
 
+src/store/id_rewriters/file/:
+
+Copyright (C) 2013 Alan Mizrahi <alan@mizrahi.com.ve>
+Based on code from Eliezer Croitoru <eliezer@ngtech.co.il>
+
+This program is free software; you can redistribute it and/or modify
+it under the terms of the GNU General Public License as published by
+the Free Software Foundation; either version 2 of the License, or
+(at your option) any later version.
+
+This program is distributed in the hope that it will be useful,
+but WITHOUT ANY WARRANTY; without even the implied warranty of
+MERCHANTABILITY or FITNESS FOR A PARTICULAR PURPOSE.  See the
+GNU General Public License for more details.
+
+You should have received a copy of the GNU General Public License
+along with this program; if not, write to the Free Software
+Foundation, Inc., 59 Temple Place, Suite 330, Boston, MA  02111-1307, USA.
+
+==============================================================================
+
 tools/helper-mux.pl:
 
 # AUTHOR: Francesco Chemolli <kinkie@squid-cache.org>
@@ -6,12 +6,12 @@
 ##
 
 AUTOMAKE_OPTIONS = dist-bzip2 1.5 foreign
-DIST_SUBDIRS	= compat lib libltdl scripts icons errors contrib doc helpers src test-suite tools
+DIST_SUBDIRS	= compat lib libltdl scripts icons errors contrib doc src test-suite tools
 SUBDIRS		= compat lib
 if ENABLE_LOADABLE_MODULES
 SUBDIRS += libltdl
 endif
-SUBDIRS += scripts icons errors doc helpers src tools test-suite
+SUBDIRS += scripts icons errors doc src tools test-suite
 
 DISTCLEANFILES = include/stamp-h include/stamp-h[0-9]*
 DEFAULT_PINGER = $(libexecdir)/`echo pinger | sed '$(transform);s/$$/$(EXEEXT)/'`
@@ -2499,10 +2499,10 @@ AC_ARG_ENABLE(auth-basic,
       all possible helpers. Default is to do so.
       To disable the basic authentication scheme, use --disable-auth-basic.
       To enable but build no helpers, specify "none".
-      To see available helpers, see the helpers/basic_auth directory. ]),[
+      To see available helpers, see the src/auth/basic/ directory. ]),[
 #nothing to do really
 ])
-m4_include([helpers/basic_auth/modules.m4])
+m4_include([src/auth/basic/helpers.m4])
 
 AC_ARG_ENABLE(auth-digest,
   AS_HELP_STRING([--enable-auth-digest="list of helpers"],
@@ -2511,24 +2511,24 @@ AC_ARG_ENABLE(auth-digest,
       all possible helpers. Default is to do so.
       To disable the Digest authentication scheme, use --disable-auth-digest.
       To enable but build no helpers, specify "none".
-      To see available helpers, see the helpers/digest_auth directory. ]),[
+      To see available helpers, see the src/auth/digest/ directory. ]),[
 #nothing to do, really
 ])
-m4_include([helpers/digest_auth/modules.m4])
+m4_include([src/auth/digest/helpers.m4])
 
 AC_ARG_ENABLE(auth-negotiate,
   AS_HELP_STRING([--enable-auth-negotiate="list of helpers"],
-     [Enable the Negotiate authentication scheme, and build the specified 
+     [Enable the Negotiate authentication scheme, and build the specified
       helpers.
       Not providing an explicit list of helpers will attempt build of
       all possible helpers. Default is to do so.
-      To disable the Negotiate authentication scheme, 
+      To disable the Negotiate authentication scheme,
       use --disable-auth-negotiate.
       To enable but build no helpers, specify "none".
-      To see available helpers, see the helpers/negotiate_auth directory. ]),[
+      To see available helpers, see the src/auth/negotiate/ directory. ]),[
 #nothing to do, really
 ])
-m4_include([helpers/negotiate_auth/modules.m4])
+m4_include([src/auth/negotiate/helpers.m4])
 
 AC_ARG_ENABLE(auth-ntlm,
   AS_HELP_STRING([--enable-auth-ntlm="list of helpers"],
@@ -2537,9 +2537,9 @@ AC_ARG_ENABLE(auth-ntlm,
       all possible helpers. Default is to do so.
       To disable the NTLM authentication scheme, use --disable-auth-ntlm.
       To enable but build no helpers, specify "none".
-      To see available helpers, see the helpers/ntlm_auth directory. ]),[
+      To see available helpers, see the src/auth/ntlm/ directory. ]),[
 ])
-m4_include([helpers/ntlm_auth/modules.m4])
+m4_include([src/auth/ntlm/helpers.m4])
 
 dnl Authentication libraries to build
 dnl This list will not be needed when each auth library has its own Makefile
@@ -2554,25 +2554,25 @@ AC_SUBST(AUTH_LIBS_TO_BUILD)
 dnl Select logging daemon helpers to build
 AC_ARG_ENABLE(log-daemon-helpers,
   AS_HELP_STRING([--enable-log-daemon-helpers="list of helpers"],
-                 [This option selects which logging daemon helpers to 
+                 [This option selects which logging daemon helpers to
                   build and install as part of the normal build process
-                  For a list of available helpers see the helpers/log_daemon
+                  For a list of available helpers see the src/log/
                   directory.]),[
 #nothing to do, really
 ])
-m4_include([helpers/log_daemon/modules.m4])
+m4_include([src/log/helpers.m4])
 
 AC_ARG_ENABLE(external-acl-helpers,
   AS_HELP_STRING([--enable-external-acl-helpers="list of helpers"],
-                 [Enable external_acl helpers support and thelpers themselves.
+                 [Enable external_acl helpers support and the helpers themselves.
                   Default is to build all buildable helpers and enable support.
                   To disable support, use --disable-external-acl-helpers.
                   To build no helpers, specify "none".
-                  To see available helpers, see the helpers/external_acl
+                  To see available helpers, see the src/acl/external/
                   directory]), [
 #nothing to do, really
 ])
-m4_include([helpers/external_acl/modules.m4])
+m4_include([src/acl/external/helpers.m4])
 
 dnl Select url_rewrite helpers to build
 AC_ARG_ENABLE(url-rewrite-helpers,
@@ -2582,9 +2582,9 @@ AC_ARG_ENABLE(url-rewrite-helpers,
                   process. The default is to attempt the build of all possible
                   helpers. Use --disable-url-rewrite-helpers to build none.
                   For a list of available helpers see the
-                  helpers/url_rewrite directory.]),[
+                  src/http/url_rewriters/ directory.]),[
 ])
-m4_include([helpers/url_rewrite/modules.m4])
+m4_include([src/http/url_rewriters/helpers.m4])
 
 dnl Select security helpers to build
 AC_ARG_ENABLE(security-cert-validator-helpers,
@@ -2596,7 +2596,7 @@ AC_ARG_ENABLE(security-cert-validator-helpers,
                   build none. For a list of available helpers see the
                   src/security/cert_validators/ directory.]),[
 ])
-m4_include([src/security/cert_validators/modules.m4])
+m4_include([src/security/cert_validators/helpers.m4])
 
 dnl Select storeid_rewrite helpers to build
 AC_ARG_ENABLE(storeid-rewrite-helpers,
@@ -2606,9 +2606,9 @@ AC_ARG_ENABLE(storeid-rewrite-helpers,
                   process. The default is to attempt the build of all possible
                   helpers. Use --disable-storeid-rewrite-helpers to build none.
                   For a list of available helpers see the
-                  helpers/storeid_rewrite directory.]),[
+                  src/store/id_rewriters/ directory.]),[
 ])
-m4_include([helpers/storeid_rewrite/modules.m4])
+m4_include([src/store/id_rewriters/helpers.m4])
 
 AC_ARG_WITH(valgrind-debug,
   AS_HELP_STRING([--with-valgrind-debug],
@@ -3796,54 +3796,6 @@ AC_CONFIG_FILES([
 	doc/manuals/Makefile
 	doc/release-notes/Makefile
 	errors/Makefile
-	helpers/Makefile
-	helpers/basic_auth/Makefile
-	helpers/basic_auth/DB/Makefile
-	helpers/basic_auth/fake/Makefile
-	helpers/basic_auth/getpwnam/Makefile
-	helpers/basic_auth/LDAP/Makefile
-	helpers/basic_auth/NCSA/Makefile
-	helpers/basic_auth/NIS/Makefile
-	helpers/basic_auth/PAM/Makefile
-	helpers/basic_auth/POP3/Makefile
-	helpers/basic_auth/RADIUS/Makefile
-	helpers/basic_auth/SASL/Makefile
-	helpers/basic_auth/SMB/Makefile
-	helpers/basic_auth/SMB_LM/Makefile
-	helpers/basic_auth/SSPI/Makefile
-	helpers/digest_auth/Makefile
-	helpers/digest_auth/eDirectory/Makefile
-	helpers/digest_auth/file/Makefile
-	helpers/digest_auth/LDAP/Makefile
-	helpers/external_acl/Makefile
-	helpers/external_acl/AD_group/Makefile
-	helpers/external_acl/delayer/Makefile
-	helpers/external_acl/eDirectory_userip/Makefile
-	helpers/external_acl/file_userip/Makefile
-	helpers/external_acl/kerberos_ldap_group/Makefile
-	helpers/external_acl/LDAP_group/Makefile
-	helpers/external_acl/LM_group/Makefile
-	helpers/external_acl/session/Makefile
-	helpers/external_acl/SQL_session/Makefile
-	helpers/external_acl/unix_group/Makefile
-	helpers/external_acl/wbinfo_group/Makefile
-	helpers/external_acl/time_quota/Makefile
-	helpers/log_daemon/Makefile
-	helpers/log_daemon/DB/Makefile
-	helpers/log_daemon/file/Makefile
-	helpers/negotiate_auth/Makefile
-	helpers/negotiate_auth/kerberos/Makefile
-	helpers/negotiate_auth/SSPI/Makefile
-	helpers/negotiate_auth/wrapper/Makefile
-	helpers/ntlm_auth/Makefile
-	helpers/ntlm_auth/fake/Makefile
-	helpers/ntlm_auth/smb_lm/Makefile
-	helpers/ntlm_auth/SSPI/Makefile
-	helpers/storeid_rewrite/Makefile
-	helpers/storeid_rewrite/file/Makefile
-	helpers/url_rewrite/Makefile
-	helpers/url_rewrite/fake/Makefile
-	helpers/url_rewrite/LFS/Makefile
 	icons/Makefile
 	lib/Makefile
 	lib/libTrie/Makefile
@@ -3856,15 +3808,50 @@ AC_CONFIG_FILES([
 	scripts/Makefile
 	src/Makefile
 	src/acl/Makefile
+	src/acl/external/Makefile
+	src/acl/external/AD_group/Makefile
+	src/acl/external/delayer/Makefile
+	src/acl/external/eDirectory_userip/Makefile
+	src/acl/external/file_userip/Makefile
+	src/acl/external/kerberos_ldap_group/Makefile
+	src/acl/external/LDAP_group/Makefile
+	src/acl/external/LM_group/Makefile
+	src/acl/external/session/Makefile
+	src/acl/external/SQL_session/Makefile
+	src/acl/external/unix_group/Makefile
+	src/acl/external/wbinfo_group/Makefile
+	src/acl/external/time_quota/Makefile
 	src/adaptation/Makefile
 	src/adaptation/icap/Makefile
 	src/adaptation/ecap/Makefile
 	src/anyp/Makefile
 	src/auth/Makefile
 	src/auth/basic/Makefile
+	src/auth/basic/DB/Makefile
+	src/auth/basic/fake/Makefile
+	src/auth/basic/getpwnam/Makefile
+	src/auth/basic/LDAP/Makefile
+	src/auth/basic/NCSA/Makefile
+	src/auth/basic/NIS/Makefile
+	src/auth/basic/PAM/Makefile
+	src/auth/basic/POP3/Makefile
+	src/auth/basic/RADIUS/Makefile
+	src/auth/basic/SASL/Makefile
+	src/auth/basic/SMB/Makefile
+	src/auth/basic/SMB_LM/Makefile
+	src/auth/basic/SSPI/Makefile
 	src/auth/digest/Makefile
+	src/auth/digest/eDirectory/Makefile
+	src/auth/digest/file/Makefile
+	src/auth/digest/LDAP/Makefile
 	src/auth/negotiate/Makefile
+	src/auth/negotiate/kerberos/Makefile
+	src/auth/negotiate/SSPI/Makefile
+	src/auth/negotiate/wrapper/Makefile
 	src/auth/ntlm/Makefile
+	src/auth/ntlm/fake/Makefile
+	src/auth/ntlm/SMB_LM/Makefile
+	src/auth/ntlm/SSPI/Makefile
 	src/base/Makefile
 	src/clients/Makefile
 	src/comm/Makefile
@@ -3884,11 +3871,16 @@ AC_CONFIG_FILES([
 	src/helper/Makefile
 	src/http/Makefile
 	src/http/one/Makefile
+	src/http/url_rewriters/Makefile
+	src/http/url_rewriters/fake/Makefile
+	src/http/url_rewriters/LFS/Makefile
 	src/icmp/Makefile
 	src/ident/Makefile
 	src/ip/Makefile
 	src/ipc/Makefile
 	src/log/Makefile
+	src/log/DB/Makefile
+	src/log/file/Makefile
 	src/mem/Makefile
 	src/mgr/Makefile
 	src/parser/Makefile
@@ -3900,6 +3892,8 @@ AC_CONFIG_FILES([
 	src/snmp/Makefile
 	src/ssl/Makefile
 	src/store/Makefile
+	src/store/id_rewriters/Makefile
+	src/store/id_rewriters/file/Makefile
 	test-suite/Makefile
 	tools/Makefile
 	tools/helper-mux/Makefile
@@ -44,8 +44,7 @@ The Squid-4 change history can be <url url="http://www.squid-cache.org/Versions/
 	<item>Configurable helper queue size
 	<item>Helper concurrency channels changes
 	<item>SSL support removal
-	<item>cert_valid.pl helper renamed
-	<item>MSNT-multi-domain helper removal
+	<item>Helper Binary Changes
 	<item>Secure ICAP
 	<item>Improved SMP support
 </itemize>
@@ -100,20 +99,21 @@ Most user-facing changes are reflected in squid.conf (see below).
    behaviour explicitly if needed.
 
 
-<sect1>cert_valid.pl helper renamed
+<sect1>Helper Binary Changes
+<p>The <em>basic_msnt_multi_domain_auth</em> helper has been removed. The
+   <em>basic_smb_lm_auth</em> helper performs the same actions without extra
+   Perl and Samba dependencies.
+
 <p>The <em>cert_valid.pl</em> testing helper has been renamed to
    <em>security_fake_certverify</em>, reflecting the Squid helper naming schema
    and that it does not actually perform any certificate checks.
 
-<p>This helper is also now built and installed by default. It is written in Perl
-   so does not require OpenSSL dependencies for installation. But does use the
-   Perl Crypt::OpenSSL::X509 module for execution.
+<p>The <em>security_fake_certverify</em> helper is also now built and installed
+   by default. It is written in Perl so does not require OpenSSL dependencies
+   for installation. But does use the Perl Crypt::OpenSSL::X509 module for execution.
 
-
-<sect1>MSNT-multi-domain helper removal
-<p>The <em>basic_msnt_multi_domain_auth</em> helper has been removed. The
-   <em>basic_smb_lm_auth</em> helper performs the same actions without extra
-   Perl and Samba dependencies.
+<p>The <em>ntlm_smb_lm_auth</em> helper is now built using <em>--enable-auth-ntlm="SMB_LM"</em>.
+   Notice the upper case where it was previously a (wrongly) lower cased acronym.
 
 
 <sect1>Secure ICAP
@@ -348,6 +348,10 @@ This section gives an account of those changes in three categories:
 	<tag>--enable-auth-basic</tag>
 	<p>The <em>MSNT-multi-domain</em> helper has been removed.
 
+	<tag>--enable-auth-ntlm</tag>
+	<p>The SMB LanMan helper is now built using <em>SMB_LM</em>
+	   (was lower case <em>smb_lm</em>).
+
 	<tag>--enable-diskio</tag>
 	<p>Auto-detection of SMP related modules has been fixed to
 	   actually auto-detect them without configuring the module
@@ -1,31 +0,0 @@
-## Copyright (C) 1996-2016 The Squid Software Foundation and contributors
-##
-## Squid software is distributed under GPLv2+ license and includes
-## contributions from numerous individuals and organizations.
-## Please see the COPYING and CONTRIBUTORS files for details.
-##
-
-EXTRA_DIST = defines.h
-
-DIST_SUBDIRS = \
-	basic_auth \
-	digest_auth \
-	external_acl \
-	log_daemon \
-	negotiate_auth \
-	ntlm_auth \
-	url_rewrite \
-	storeid_rewrite
-
-SUBDIRS = \
-	basic_auth \
-	digest_auth \
-	external_acl \
-	log_daemon \
-	negotiate_auth \
-	url_rewrite \
-	storeid_rewrite
-
-if ENABLE_AUTH_NTLM
-SUBDIRS += ntlm_auth
-endif
@@ -1,26 +0,0 @@
-## Copyright (C) 1996-2016 The Squid Software Foundation and contributors
-##
-## Squid software is distributed under GPLv2+ license and includes
-## contributions from numerous individuals and organizations.
-## Please see the COPYING and CONTRIBUTORS files for details.
-##
-
-## Alphabetical list of sub-directories to distribute with Squid:
-DIST_SUBDIRS = \
-	DB \
-	fake \
-	getpwnam \
-	LDAP \
-	NCSA \
-	NIS \
-	PAM \
-	POP3 \
-	RADIUS \
-	SASL \
-	SMB \
-	SMB_LM \
-	SSPI
-
-SUBDIRS	= $(BASIC_AUTH_HELPERS)
-
-EXTRA_DIST = modules.m4
@@ -1,16 +0,0 @@
-## Copyright (C) 1996-2016 The Squid Software Foundation and contributors
-##
-## Squid software is distributed under GPLv2+ license and includes
-## contributions from numerous individuals and organizations.
-## Please see the COPYING and CONTRIBUTORS files for details.
-##
-
-## Alphabetical list of sub-directories to distribute with Squid:
-DIST_SUBDIRS= \
-	eDirectory \
-	file \
-	LDAP
-
-SUBDIRS= $(DIGEST_AUTH_HELPERS)
-
-EXTRA_DIST = modules.m4
@@ -1,14 +0,0 @@
-## Copyright (C) 1996-2016 The Squid Software Foundation and contributors
-##
-## Squid software is distributed under GPLv2+ license and includes
-## contributions from numerous individuals and organizations.
-## Please see the COPYING and CONTRIBUTORS files for details.
-##
-
-## Alphabetical list of sub-directories to distribute with Squid:
-DIST_SUBDIRS = \
-	DB \
-	file
-
-SUBDIRS	= $(LOG_DAEMON_HELPERS)
-EXTRA_DIST = modules.m4
@@ -1,10 +0,0 @@
-## Copyright (C) 1996-2016 The Squid Software Foundation and contributors
-##
-## Squid software is distributed under GPLv2+ license and includes
-## contributions from numerous individuals and organizations.
-## Please see the COPYING and CONTRIBUTORS files for details.
-##
-
-DIST_SUBDIRS	= fake smb_lm SSPI
-SUBDIRS		= $(NTLM_AUTH_HELPERS)
-EXTRA_DIST	= modules.m4
@@ -1,9 +0,0 @@
-## Copyright (C) 1996-2016 The Squid Software Foundation and contributors
-##
-## Squid software is distributed under GPLv2+ license and includes
-## contributions from numerous individuals and organizations.
-## Please see the COPYING and CONTRIBUTORS files for details.
-##
-
-DIST_SUBDIRS	= file
-SUBDIRS		= $(STOREID_REWRITE_HELPERS)
@@ -1,9 +0,0 @@
-## Copyright (C) 1996-2016 The Squid Software Foundation and contributors
-##
-## Squid software is distributed under GPLv2+ license and includes
-## contributions from numerous individuals and organizations.
-## Please see the COPYING and CONTRIBUTORS files for details.
-##
-
-DIST_SUBDIRS	= fake LFS
-SUBDIRS		= $(URL_REWRITE_HELPERS)
@@ -8,6 +8,8 @@
 include $(top_srcdir)/src/Common.am
 include $(top_srcdir)/src/TestHeaders.am
 
+SUBDIRS= external
+
 noinst_LTLIBRARIES = libapi.la libstate.la libacls.la
 
 ## General data-independent ACL API
@@ -142,7 +144,7 @@ libacls_la_SOURCES = \
 	AclSizeLimit.h
 
 ## Add conditional sources
-## TODO: move these to their respectful dirs when those dirs are created
+## TODO: move these to their respective dirs when those dirs are created
 
 EXTRA_libacls_la_SOURCES =
 
@@ -167,22 +169,22 @@ SSL_ACLS = \
 if ENABLE_SSL
 libacls_la_SOURCES += $(SSL_ACLS)
 endif
+EXTRA_libacls_la_SOURCES += $(SSL_ACLS)
 
-if USE_ADAPTATION
-libacls_la_SOURCES += AdaptationService.h \
+ADAPT_ACLS= \
+	AdaptationService.h \
 	AdaptationService.cc \
 	AdaptationServiceData.h \
 	AdaptationServiceData.cc
-endif
-
-
-EXTRA_libacls_la_SOURCES += $(SSL_ACLS)
 
+if USE_ADAPTATION
+libacls_la_SOURCES += $(ADAPT_ACLS)
+endif
+EXTRA_libacls_la_SOURCES += $(ADAPT_ACLS)
 
 ARP_ACLS = Arp.cc Arp.h Eui64.cc Eui64.h
 
 if USE_SQUID_EUI
 libacls_la_SOURCES += $(ARP_ACLS)
 endif
-
 EXTRA_libacls_la_SOURCES += $(ARP_ACLS)
@@ -8,16 +8,17 @@
 include $(top_srcdir)/src/Common.am
 
 libexec_PROGRAMS = ext_ad_group_acl
-ext_ad_group_acl_SOURCES = ext_ad_group_acl.cc
 man_MANS = ext_ad_group_acl.8
 
+ext_ad_group_acl_SOURCES = ext_ad_group_acl.cc
+
 #
 # Currently activeds and adsiid libraries are not available on MinGW or Cygwin,
 # so the following library list is just a placeholder for future MinGW/Cygwin releases.
 # This helper can be compiled only using Microsoft Visual Studio.
 # TODO: test for these libraries in required.m4
 #
-LDADD = \
+ext_ad_group_acl_LDADD = \
 	$(COMPAT_LIB) \
 	-lnetapi32 \
 	-ladvapi32 \
@@ -66,7 +66,7 @@
  */
 
 #include "squid.h"
-#include "helpers/defines.h"
+#include "helper/protocol_defines.h"
 #include "include/util.h"
 
 #if _SQUID_CYGWIN_
@@ -7,15 +7,18 @@
 
 include $(top_srcdir)/src/Common.am
 
-libexec_PROGRAMS 		= ext_ldap_group_acl
-ext_ldap_group_acl_SOURCES	= ext_ldap_group_acl.cc
+libexec_PROGRAMS= ext_ldap_group_acl
+man_MANS= ext_ldap_group_acl.8
 
-man_MANS 			= ext_ldap_group_acl.8
-EXTRA_DIST			= ext_ldap_group_acl.8 required.m4
-
-LDADD = \
+ext_ldap_group_acl_SOURCES= \
+	ext_ldap_group_acl.cc
+ext_ldap_group_acl_LDADD= \
 	$(top_builddir)/lib/libmiscencoding.la \
 	$(COMPAT_LIB) \
 	$(LDAPLIB) \
 	$(LBERLIB) \
 	$(XTRA_LIBS)
+
+EXTRA_DIST= \
+	ext_ldap_group_acl.8 \
+	required.m4
@@ -38,7 +38,7 @@
  * OpenSSL libraries linked into openldap. See http://www.openssl.org/
  */
 #include "squid.h"
-#include "helpers/defines.h"
+#include "helper/protocol_defines.h"
 #include "rfc1738.h"
 #include "util.h"
 
@@ -7,17 +7,18 @@
 
 include $(top_srcdir)/src/Common.am
 
-libexec_PROGRAMS = ext_lm_group_acl
-ext_lm_group_acl_SOURCES = ext_lm_group_acl.cc
+libexec_PROGRAMS= ext_lm_group_acl
+man_MANS= ext_lm_group_acl.8
 
-LDADD = \
+ext_lm_group_acl_SOURCES= ext_lm_group_acl.cc
+ext_lm_group_acl_LDADD= \
 	$(top_builddir)/lib/libmiscencoding.la \
 	$(COMPAT_LIB) \
 	-lnetapi32 \
 	-ladvapi32 \
 	-lntdll \
 	$(XTRA_LIBS)
 
-man_MANS = ext_lm_group_acl.8
-
-EXTRA_DIST = required.m4 ext_lm_group_acl.8
+EXTRA_DIST= \
+	required.m4 \
+	ext_lm_group_acl.8
@@ -76,7 +76,7 @@
  */
 
 #include "squid.h"
-#include "helpers/defines.h"
+#include "helper/protocol_defines.h"
 #include "rfc1738.h"
 #include "util.h"
 
@@ -36,7 +36,7 @@
 
 /* Squid-3.X includes */
 #include "squid.h"
-#include "helpers/defines.h"
+#include "helper/protocol_defines.h"
 #include "rfc1738.h"
 #include "util.h"
 
@@ -8,16 +8,17 @@
 include $(top_srcdir)/src/Common.am
 
 libexec_PROGRAMS = ext_file_userip_acl
-ext_file_userip_acl_SOURCES = ext_file_userip_acl.cc
 man_MANS = ext_file_userip_acl.8
 
+ext_file_userip_acl_SOURCES= \
+	ext_file_userip_acl.cc
+ext_file_userip_acl_LDADD= \
+	$(top_builddir)/lib/libmiscencoding.la \
+	$(COMPAT_LIB) \
+	$(XTRA_LIBS)
+
 EXTRA_DIST = \
 	example.conf \
 	example-deny_all_but.conf \
 	ext_file_userip_acl.8 \
 	required.m4
-
-LDADD = \
-	$(top_builddir)/lib/libmiscencoding.la \
-	$(COMPAT_LIB) \
-	$(XTRA_LIBS)
@@ -27,7 +27,7 @@
  *
  */
 #include "squid.h"
-#include "helpers/defines.h"
+#include "helper/protocol_defines.h"
 #include "rfc1738.h"
 #include "util.h"
 
@@ -13,7 +13,7 @@
 #define list of modules to build
 auto_ext_acl_modules=no
 if test "x${enable_external_acl_helpers:=yes}" = "xyes" ;then
-  SQUID_LOOK_FOR_MODULES([$srcdir/helpers/external_acl],[enable_external_acl_helpers])
+  SQUID_LOOK_FOR_MODULES([$srcdir/src/acl/external],[enable_external_acl_helpers])
   auto_ext_acl_modules=yes
 fi
 if test "x$enable_external_acl_helpers" = "xnone" ; then
@@ -23,52 +23,52 @@ EXTERNAL_ACL_HELPERS=""
 enable_external_acl_helpers="`echo $enable_external_acl_helpers| sed -e 's/,/ /g;s/  */ /g'`"
 if test "x$enable_external_acl_helpers" != "xno" ; then
   for helper in $enable_external_acl_helpers ; do
-    dir="$srcdir/helpers/external_acl/$helper"
+    dir="$srcdir/src/acl/external/$helper"
 
       # modules converted to autoconf macros already
       # NP: we only need this list because m4_include() does not accept variables
       if test "x$helper" = "xAD_group" ; then
-        m4_include([helpers/external_acl/AD_group/required.m4])
+        m4_include([src/acl/external/AD_group/required.m4])
 
       elif test "x$helper" = "xLDAP_group" ; then
-        m4_include([helpers/external_acl/LDAP_group/required.m4])
+        m4_include([src/acl/external/LDAP_group/required.m4])
 
       elif test "x$helper" = "xLM_group" ; then
-        m4_include([helpers/external_acl/LM_group/required.m4])
+        m4_include([src/acl/external/LM_group/required.m4])
 
       elif test "x$helper" = "xdelayer" ; then
-        m4_include([helpers/external_acl/delayer/required.m4])
+        m4_include([src/acl/external/delayer/required.m4])
 
       elif test "x$helper" = "xSQL_session" ; then
-        m4_include([helpers/external_acl/SQL_session/required.m4])
+        m4_include([src/acl/external/SQL_session/required.m4])
 
       elif test "x$helper" = "xeDirectory_userip" ; then
-        m4_include([helpers/external_acl/eDirectory_userip/required.m4])
+        m4_include([src/acl/external/eDirectory_userip/required.m4])
 
       elif test "x$helper" = "xfile_userip" ; then
-        m4_include([helpers/external_acl/file_userip/required.m4])
+        m4_include([src/acl/external/file_userip/required.m4])
 
       elif test "x$helper" = "xkerberos_ldap_group" ; then
-        m4_include([helpers/external_acl/kerberos_ldap_group/required.m4])
+        m4_include([src/acl/external/kerberos_ldap_group/required.m4])
 
       elif test "x$helper" = "xsession" ; then
-        m4_include([helpers/external_acl/session/required.m4])
+        m4_include([src/acl/external/session/required.m4])
 
       elif test "x$helper" = "xtime_quota" ; then
-        m4_include([helpers/external_acl/time_quota/required.m4])
+        m4_include([src/acl/external/time_quota/required.m4])
 
       elif test "x$helper" = "xunix_group" ; then
-        m4_include([helpers/external_acl/unix_group/required.m4])
+        m4_include([src/acl/external/unix_group/required.m4])
 
       elif test "x$helper" = "xwbinfo_group" ; then
-        m4_include([helpers/external_acl/wbinfo_group/required.m4])
+        m4_include([src/acl/external/wbinfo_group/required.m4])
 
       # modules not yet converted to autoconf macros (or third party drop-in's)
       elif test -f "$dir/config.test" && sh "$dir/config.test" "$squid_host_os"; then
         BUILD_HELPER="$helper"
       fi
 
-      if test -d "$srcdir/helpers/external_acl/$helper"; then
+      if test -d "$srcdir/src/acl/external/$helper"; then
         if test "$BUILD_HELPER" != "$helper"; then
           if test "x$auto_ext_acl_modules" = "xyes"; then
             AC_MSG_NOTICE([external acl helper $helper ... found but cannot be built])
@@ -7,8 +7,11 @@
 
 include $(top_srcdir)/src/Common.am
 
-EXTRA_DIST = README required.m4 cert_tool ext_kerberos_ldap_group_acl.8
-SUBDIRS = 
+EXTRA_DIST= \
+	cert_tool \
+	ext_kerberos_ldap_group_acl.8 \
+	README \
+	required.m4
 
 AM_CPPFLAGS += -I$(srcdir)
 
@@ -36,7 +36,7 @@
  */
 
 #include "squid.h"
-#include "helpers/defines.h"
+#include "helper/protocol_defines.h"
 #include "rfc1738.h"
 #include "util.h"
 
@@ -7,11 +7,13 @@
 
 include $(top_srcdir)/src/Common.am
 
-libexec_PROGRAMS 		= ext_session_acl
-man_MANS 			= ext_session_acl.8
-EXTRA_DIST			= ext_session_acl.8 required.m4
-ext_session_acl_SOURCES		= ext_session_acl.cc
+libexec_PROGRAMS= ext_session_acl
+man_MANS= ext_session_acl.8
 
-LDADD = \
+ext_session_acl_SOURCES= \
+	ext_session_acl.cc
+ext_session_acl_LDADD = \
 	$(COMPAT_LIB) \
 	$(LIB_DB)
+
+EXTRA_DIST= ext_session_acl.8 required.m4
@@ -29,7 +29,7 @@
 #if HAVE_CONFIG_H
 #include "squid.h"
 #endif
-#include "helpers/defines.h"
+#include "helper/protocol_defines.h"
 
 #include <cstdlib>
 #include <cstring>
@@ -7,13 +7,15 @@
 
 include $(top_srcdir)/src/Common.am
 
-libexec_PROGRAMS 		= ext_time_quota_acl
-man_MANS 			= ext_time_quota_acl.8
-EXTRA_DIST			= ext_time_quota_acl.8 required.m4
-ext_time_quota_acl_SOURCES	= ext_time_quota_acl.cc
+libexec_PROGRAMS= ext_time_quota_acl
+man_MANS= ext_time_quota_acl.8
 
-DEFS += -DDEFAULT_QUOTA_DB=\"$(localstatedir)/ext_time_quota.db\" 
+DEFS += -DDEFAULT_QUOTA_DB=\"$(localstatedir)/ext_time_quota.db\"
 
-LDADD = \
+ext_time_quota_acl_SOURCES= \
+	ext_time_quota_acl.cc
+ext_time_quota_acl_LDADD = \
 	$(COMPAT_LIB) \
 	$(LIB_DB)
+
+EXTRA_DIST= ext_time_quota_acl.8 required.m4
@@ -27,7 +27,7 @@
  */
 
 #include "squid.h"
-#include "helpers/defines.h"
+#include "helper/protocol_defines.h"
 
 #include <cstdarg>
 #include <cstdlib>
@@ -10,9 +10,10 @@ include $(top_srcdir)/src/Common.am
 libexec_PROGRAMS 		= ext_unix_group_acl
 man_MANS 			= ext_unix_group_acl.8
 EXTRA_DIST			= ext_unix_group_acl.8 required.m4
-ext_unix_group_acl_SOURCES	= check_group.cc
 
-LDADD = \
+ext_unix_group_acl_SOURCES= \
+	check_group.cc
+ext_unix_group_acl_LDADD= \
 	$(top_builddir)/lib/libmiscencoding.la \
 	$(COMPAT_LIB) \
 	$(XTRA_LIBS)
@@ -62,7 +62,7 @@
  *
  */
 #include "squid.h"
-#include "helpers/defines.h"
+#include "helper/protocol_defines.h"
 #include "rfc1738.h"
 #include "util.h"
 
@@ -12,7 +12,7 @@ man_MANS 		= basic_ldap_auth.8
 EXTRA_DIST		= basic_ldap_auth.8 required.m4
 basic_ldap_auth_SOURCES	= basic_ldap_auth.cc
 
-LDADD = \
+basic_ldap_auth_LDADD = \
 	$(top_builddir)/lib/libmiscencoding.la \
 	$(COMPAT_LIB) \
 	$(LDAPLIB) \
@@ -8,6 +8,24 @@
 include $(top_srcdir)/src/Common.am
 include $(top_srcdir)/src/TestHeaders.am
 
+DIST_SUBDIRS = \
+        DB \
+        fake \
+        getpwnam \
+        LDAP \
+        NCSA \
+        NIS \
+        PAM \
+        POP3 \
+        RADIUS \
+        SASL \
+        SMB \
+        SMB_LM \
+        SSPI
+
+SUBDIRS = $(BASIC_AUTH_HELPERS)
+EXTRA_DIST= helpers.m4
+
 noinst_LTLIBRARIES = libbasic.la
 
 libbasic_la_SOURCES = \
@@ -8,17 +8,18 @@
 include $(top_srcdir)/src/Common.am
 
 libexec_PROGRAMS	= basic_ncsa_auth
-basic_ncsa_auth_SOURCES	= basic_ncsa_auth.cc crypt_md5.cc crypt_md5.h
 man_MANS 		= basic_ncsa_auth.8
 EXTRA_DIST		= basic_ncsa_auth.8 required.m4
-LDADD = \
+
+basic_ncsa_auth_SOURCES= \
+	basic_ncsa_auth.cc \
+	crypt_md5.cc \
+	crypt_md5.h
+basic_ncsa_auth_LDADD= \
 	$(top_builddir)/lib/libmisccontainers.la \
 	$(top_builddir)/lib/libmiscencoding.la \
 	$(COMPAT_LIB) \
 	$(NETTLELIB) \
 	$(CRYPTLIB) \
 	$(SSLLIB) \
 	$(XTRA_LIBS)
-
-## we need our local files too (but avoid -I. at all costs)
-AM_CPPFLAGS += -I$(srcdir)
@@ -25,8 +25,8 @@
  */
 
 #include "squid.h"
-#include "crypt_md5.h"
-#include "helpers/defines.h"
+#include "auth/basic/NCSA/crypt_md5.h"
+#include "helper/protocol_defines.h"
 #include "rfc1738.h"
 
 #include <string>
@@ -24,7 +24,7 @@
  */
 
 #include "squid.h"
-#include "crypt_md5.h"
+#include "auth/basic/NCSA/crypt_md5.h"
 #include "md5.h"
 
 #include <cstring>
@@ -7,17 +7,14 @@
 
 include $(top_srcdir)/src/Common.am
 
-## we need our local files too (but avoid -I. at all costs)
-AM_CPPFLAGS += -I$(srcdir)
-
 libexec_PROGRAMS = basic_nis_auth
 
-basic_nis_auth_SOURCES = \
+basic_nis_auth_SOURCES= \
 	basic_nis_auth.cc \
 	nis_support.h \
 	nis_support.cc
 
-basic_nis_auth_LDADD = \
+basic_nis_auth_LDADD= \
 	$(top_builddir)/lib/libmiscencoding.la \
 	$(COMPAT_LIB) \
 	$(CRYPTLIB) \
@@ -13,7 +13,7 @@
 
 #include "squid.h"
 #include "hash.h"
-#include "nis_support.h"
+#include "auth/basic/NIS/nis_support.h"
 #include "rfc1738.h"
 #include "util.h"
 
@@ -44,9 +44,9 @@ main(int argc, char **argv)
     setbuf(stdout, NULL);
 
     if (argc != 3) {
-        fprintf(stderr, "Usage: basic_yp_auth <domainname> <nis map for password>\n");
+        fprintf(stderr, "Usage: basic_nis_auth <domainname> <nis map for password>\n");
         fprintf(stderr, "\n");
-        fprintf(stderr, "Example basic_yp_auth mydomain.com passwd.byname\n");
+        fprintf(stderr, "Example basic_nis_auth mydomain.com passwd.byname\n");
         exit(1);
     }
     nisdomain = argv[1];
@@ -35,7 +35,7 @@
 #include <rpcsvc/yp_prot.h>
 #endif
 
-#include "nis_support.h"
+#include "auth/basic/NIS/nis_support.h"
 
 #define NO_YPERR 0      /* There is no error */
 
@@ -10,8 +10,8 @@ include $(top_srcdir)/src/Common.am
 man_MANS		= basic_pam_auth.8
 EXTRA_DIST		= basic_pam_auth.8 required.m4
 libexec_PROGRAMS	= basic_pam_auth
-basic_pam_auth_SOURCES	= basic_pam_auth.cc
 
+basic_pam_auth_SOURCES	= basic_pam_auth.cc
 basic_pam_auth_LDADD = \
 	$(top_builddir)/lib/libmiscencoding.la \
 	$(COMPAT_LIB) \
@@ -71,7 +71,7 @@
  *  Initial version
  */
 #include "squid.h"
-#include "helpers/defines.h"
+#include "helper/protocol_defines.h"
 #include "rfc1738.h"
 #include "util.h"
 
@@ -7,19 +7,17 @@
 
 include $(top_srcdir)/src/Common.am
 
-## we need our local files too (but avoid -I. at all costs)
-AM_CPPFLAGS += -I$(srcdir)
-
 libexec_PROGRAMS 	= basic_radius_auth
 man_MANS 		= basic_radius_auth.8
 EXTRA_DIST		= basic_radius_auth.8 required.m4
-basic_radius_auth_SOURCES = \
-			basic_radius_auth.cc \
-			radius.h \
-			radius-util.cc \
-			radius-util.h
 
-basic_radius_auth_LDADD = \
+basic_radius_auth_SOURCES= \
+	basic_radius_auth.cc \
+	radius.h \
+	radius-util.cc \
+	radius-util.h
+
+basic_radius_auth_LDADD= \
 	$(top_builddir)/lib/libmiscencoding.la \
 	$(COMPAT_LIB) \
 	$(NETTLELIB) \
@@ -54,10 +54,10 @@
  */
 
 #include "squid.h"
-#include "helpers/defines.h"
+#include "auth/basic/RADIUS/radius-util.h"
+#include "auth/basic/RADIUS/radius.h"
+#include "helper/protocol_defines.h"
 #include "md5.h"
-#include "radius-util.h"
-#include "radius.h"
 
 #include <cctype>
 #include <cerrno>
@@ -45,8 +45,8 @@ char util_sccsid[] =
     "		2.1 Copyright 1997 Cistron Internet Services B.V.";
 
 #include "squid.h"
+#include "auth/basic/RADIUS/radius-util.h"
 #include "md5.h"
-#include "radius-util.h"
 
 #include <cctype>
 #include <csignal>
@@ -7,16 +7,18 @@
 
 include $(top_srcdir)/src/Common.am
 
-man_MANS = basic_sasl_auth.8
-libexec_PROGRAMS = basic_sasl_auth
-basic_sasl_auth_SOURCES = basic_sasl_auth.cc
-basic_sasl_auth_LDADD = \
+man_MANS= basic_sasl_auth.8
+libexec_PROGRAMS= basic_sasl_auth
+
+basic_sasl_auth_SOURCES= \
+	basic_sasl_auth.cc
+basic_sasl_auth_LDADD= \
 	$(top_builddir)/lib/libmiscencoding.la \
 	$(COMPAT_LIB) \
 	$(LIBSASL) \
 	$(XTRA_LIBS)
 
-EXTRA_DIST = \
+EXTRA_DIST= \
 	basic_sasl_auth.8 \
 	basic_sasl_auth.conf \
 	basic_sasl_auth.pam \
@@ -33,7 +33,7 @@
  *
  */
 #include "squid.h"
-#include "helpers/defines.h"
+#include "helper/protocol_defines.h"
 #include "rfc1738.h"
 #include "util.h"
 
@@ -10,12 +10,15 @@ include $(top_srcdir)/src/Common.am
 if !ENABLE_WIN32SPECIFIC
 libexec_SCRIPTS	= basic_smb_auth.sh
 libexec_PROGRAMS = basic_smb_auth
-endif 
+endif
+
 basic_smb_auth_SOURCES= basic_smb_auth.cc
 basic_smb_auth_CXXFLAGS = -DHELPERSCRIPT=\"$(libexecdir)/basic_smb_auth.sh\"
 basic_smb_auth_LDADD = \
-		$(top_builddir)/lib/libmiscencoding.la \
-		$(COMPAT_LIB) \
-		$(XTRA_LIBS)
+	$(top_builddir)/lib/libmiscencoding.la \
+	$(COMPAT_LIB) \
+	$(XTRA_LIBS)
 
-EXTRA_DIST = basic_smb_auth.sh required.m4
+EXTRA_DIST= \
+	basic_smb_auth.sh \
+	required.m4
@@ -25,7 +25,7 @@
  */
 
 #include "squid.h"
-#include "helpers/defines.h"
+#include "helper/protocol_defines.h"
 #include "rfc1738.h"
 #include "util.h"
 
@@ -7,25 +7,21 @@
 
 include $(top_srcdir)/src/Common.am
 
-libexec_PROGRAMS = basic_smb_lm_auth
+libexec_PROGRAMS= basic_smb_lm_auth
 
-basic_smb_lm_auth_SOURCES = \
+basic_smb_lm_auth_SOURCES= \
 	msntauth.cc \
 	msntauth.h \
 	valid.cc \
 	valid.h
-
-EXTRA_DIST = \
-	msntauth-v2.0.lsm \
-	README.html \
-	required.m4
-
-LDADD = \
+basic_smb_lm_auth_LDADD= \
 	$(top_builddir)/lib/smblib/libsmblib.la \
 	$(top_builddir)/lib/rfcnb/librfcnb.la \
 	$(top_builddir)/lib/libmiscencoding.la \
 	$(COMPAT_LIB) \
 	$(XTRA_LIBS)
 
-## we need our local files too (but avoid -I. at all costs)
-AM_CPPFLAGS += -I$(srcdir) -I$(top_srcdir)/lib
+EXTRA_DIST= \
+	msntauth-v2.0.lsm \
+	README.html \
+	required.m4
@@ -48,8 +48,8 @@
 #include <vector> //todo: turn into multimap
 #include <syslog.h>
 
-#include "msntauth.h"
-#include "valid.h"
+#include "auth/basic/SMB_LM/msntauth.h"
+#include "auth/basic/SMB_LM/valid.h"
 
 static char msntauth_version[] = "Msntauth v3.0.0 (C) 2 Sep 2001 Stellar-X Antonino Iannella.\nModified by the Squid HTTP Proxy team 2002-2014";
 
@@ -7,6 +7,9 @@
  */
 
 #include "squid.h"
+#include "auth/basic/SMB_LM/valid.h"
+#include "smblib/smblib.h"
+
 #if HAVE_SYS_TYPES_H
 #include <sys/types.h>
 #endif
@@ -16,8 +19,6 @@
 #if HAVE_SYSLOG_H
 #include <syslog.h>
 #endif
-#include "smblib/smblib.h"
-#include "valid.h"
 
 // BACKUP is unused
 int
@@ -7,9 +7,6 @@
 
 include $(top_srcdir)/src/Common.am
 
-## we need our local files too (but avoid -I. at all costs)
-AM_CPPFLAGS += -I$(srcdir)
-
 if ENABLE_WIN32SPECIFIC
 libexec_PROGRAMS = basic_sspi_auth
 endif
@@ -33,10 +33,10 @@
 */
 
 #include "squid.h"
-#include "helpers/defines.h"
+#include "auth/basic/SSPI/valid.h"
+#include "helper/protocol_defines.h"
 #include "rfc1738.h"
 #include "util.h"
-#include "valid.h"
 
 #if GETOPT_H
 #include <getopt.h>
@@ -46,7 +46,7 @@
 #if _SQUID_CYGWIN_
 #include <wchar.h>
 #endif
-#include "valid.h"
+#include "auth/basic/SSPI/valid.h"
 
 char Default_NTDomain[DNLEN+1] = NTV_DEFAULT_DOMAIN;
 const char * errormsg;
@@ -8,8 +8,8 @@
 include $(top_srcdir)/src/Common.am
 
 libexec_PROGRAMS = basic_fake_auth
-basic_fake_auth_SOURCES = fake.cc
 
-LDADD = $(COMPAT_LIB)
+basic_fake_auth_SOURCES = fake.cc
+basic_fake_auth_LDADD = $(COMPAT_LIB)
 
 EXTRA_DIST = required.m4
@@ -43,7 +43,7 @@
  */
 
 #include "squid.h"
-#include "helpers/defines.h"
+#include "helper/protocol_defines.h"
 
 #include <iostream>
 #include <string>
@@ -33,7 +33,7 @@
  */
 
 #include "squid.h"
-#include "helpers/defines.h"
+#include "helper/protocol_defines.h"
 #include "rfc1738.h"
 
 #include <cstdlib>
@@ -21,7 +21,7 @@ fi
 #define list of modules to build
 auto_auth_basic_modules=no
 if test "x$enable_auth_basic" = "xyes" ; then
-    SQUID_LOOK_FOR_MODULES([$srcdir/helpers/basic_auth],[enable_auth_basic])
+    SQUID_LOOK_FOR_MODULES([$srcdir/src/auth/basic],[enable_auth_basic])
   auto_auth_basic_modules=yes
 fi
 #handle the "none" special case
@@ -36,55 +36,55 @@ if test "x$enable_auth_basic" != "xno" ; then
     AUTH_MODULES="$AUTH_MODULES basic"
     AC_DEFINE([HAVE_AUTH_MODULE_BASIC],1,[Basic auth module is built])
     for helper in $enable_auth_basic; do
-      dir="$srcdir/helpers/basic_auth/$helper"
+      dir="$srcdir/src/auth/basic/$helper"
 
       # modules converted to autoconf macros already
       # NP: we only need this list because m4_include() does not accept variables
       if test "x$helper" = "xDB" ; then
-        m4_include([helpers/basic_auth/DB/required.m4])
+        m4_include([src/auth/basic/DB/required.m4])
 
       elif test "x$helper" = "xLDAP" ; then
-        m4_include([helpers/basic_auth/LDAP/required.m4])
+        m4_include([src/auth/basic/LDAP/required.m4])
 
       elif test "x$helper" = "xNCSA" ; then
-        m4_include([helpers/basic_auth/NCSA/required.m4])
+        m4_include([src/auth/basic/NCSA/required.m4])
 
       elif test "x$helper" = "xNIS" ; then
-        m4_include([helpers/basic_auth/NIS/required.m4])
+        m4_include([src/auth/basic/NIS/required.m4])
 
       elif test "x$helper" = "xPAM" ; then
-        m4_include([helpers/basic_auth/PAM/required.m4])
+        m4_include([src/auth/basic/PAM/required.m4])
 
       elif test "x$helper" = "xPOP3" ; then
-        m4_include([helpers/basic_auth/POP3/required.m4])
+        m4_include([src/auth/basic/POP3/required.m4])
 
       elif test "x$helper" = "xRADIUS" ; then
-        m4_include([helpers/basic_auth/RADIUS/required.m4])
+        m4_include([src/auth/basic/RADIUS/required.m4])
 
       elif test "x$helper" = "xSASL" ; then
-        m4_include([helpers/basic_auth/SASL/required.m4])
+        m4_include([src/auth/basic/SASL/required.m4])
 
       elif test "x$helper" = "xSMB" ; then
-        m4_include([helpers/basic_auth/SMB/required.m4])
+        m4_include([src/auth/basic/SMB/required.m4])
 
       elif test "x$helper" = "xSMB_LM" ; then
-        m4_include([helpers/basic_auth/SMB_LM/required.m4])
+        m4_include([src/auth/basic/SMB_LM/required.m4])
 
       elif test "x$helper" = "xSSPI" ; then
-        m4_include([helpers/basic_auth/SSPI/required.m4])
+        m4_include([src/auth/basic/SSPI/required.m4])
 
       elif test "x$helper" = "xfake" ; then
-        m4_include([helpers/basic_auth/fake/required.m4])
+        m4_include([src/auth/basic/fake/required.m4])
 
       elif test "x$helper" = "xgetpwnam" ; then
-        m4_include([helpers/basic_auth/getpwnam/required.m4])
+        m4_include([src/auth/basic/getpwnam/required.m4])
 
       # modules not yet converted to autoconf macros (or third party drop-in's)
       elif test -f "$dir/config.test" && sh "$dir/config.test" "$squid_host_os"; then
         BUILD_HELPER="$helper"
       fi
 
-      if test -d "$srcdir/helpers/basic_auth/$helper"; then
+      if test -d "$srcdir/src/auth/basic/$helper"; then
         if test "$BUILD_HELPER" != "$helper"; then
           if test "x$auto_auth_basic_modules" = "xyes"; then
             AC_MSG_NOTICE([Basic auth helper $helper ... found but cannot be built])
@@ -7,16 +7,15 @@
 
 include $(top_srcdir)/src/Common.am
 
-## we need our local files too (but avoid -I. at all costs)
-AM_CPPFLAGS += -I$(srcdir)
+libexec_PROGRAMS= digest_ldap_auth
 
-libexec_PROGRAMS = digest_ldap_auth
-digest_ldap_auth_SOURCES = digest_pw_auth.cc \
+digest_ldap_auth_SOURCES= \
 	digest_common.h \
+	digest_pw_auth.cc \
 	ldap_backend.cc \
 	ldap_backend.h
 
-digest_ldap_auth_LDADD = \
+digest_ldap_auth_LDADD= \
 	$(top_builddir)/lib/libmiscencoding.la \
 	$(COMPAT_LIB) \
 	$(LDAPLIB) \
@@ -26,4 +25,4 @@ digest_ldap_auth_LDADD = \
 	$(SSLLIB) \
 	$(XTRA_LIBS)
 
-EXTRA_DIST = required.m4
+EXTRA_DIST= required.m4
@@ -13,6 +13,10 @@
 #ifndef SQUID_DIGEST_COMMON_H_
 #define SQUID_DIGEST_COMMON_H_
 
+#include "hash.h"
+#include "rfc2617.h"
+#include "util.h"
+
 #include <cctype>
 #include <cstdlib>
 #include <cstring>
@@ -29,10 +33,6 @@
 #include <crypt.h>
 #endif
 
-#include "hash.h"
-#include "rfc2617.h"
-#include "util.h"
-
 typedef struct _request_data {
     int channelId;
     char *user;
@@ -37,9 +37,9 @@
  */
 
 #include "squid.h"
-#include "digest_common.h"
-#include "helpers/defines.h"
-#include "ldap_backend.h"
+#include "auth/digest/LDAP/digest_common.h"
+#include "auth/digest/LDAP/ldap_backend.h"
+#include "helper/protocol_defines.h"
 
 #define PROGRAM_NAME "digest_ldap_auth"
 
@@ -15,7 +15,7 @@
 
 #define LDAP_DEPRECATED 1
 
-#include "ldap_backend.h"
+#include "auth/digest/LDAP/ldap_backend.h"
 
 #if _SQUID_WINDOWS_ && !_SQUID_CYGWIN_
 
@@ -10,7 +10,7 @@
  * AUTHOR: Flavio Pescuma. <flavio@marasystems.com>
  */
 
-#include "digest_common.h"
+#include "auth/digest/LDAP/digest_common.h"
 
 extern int LDAPArguments(int argc, char **argv);
 extern void LDAPHHA1(RequestData * requestData);
@@ -8,9 +8,13 @@
 include $(top_srcdir)/src/Common.am
 include $(top_srcdir)/src/TestHeaders.am
 
-noinst_LTLIBRARIES = libdigest.la
+DIST_SUBDIRS= eDirectory file LDAP
+SUBDIRS= $(DIGEST_AUTH_HELPERS)
+EXTRA_DIST= helpers.m4
 
-libdigest_la_SOURCES = \
+noinst_LTLIBRARIES= libdigest.la
+
+libdigest_la_SOURCES= \
 	Config.cc \
 	Config.h \
 	Scheme.cc \
@@ -7,11 +7,10 @@
 
 include $(top_srcdir)/src/Common.am
 
-## we need our local files too (but avoid -I. at all costs)
-AM_CPPFLAGS += -I$(srcdir)
+libexec_PROGRAMS= digest_edirectory_auth
 
-libexec_PROGRAMS = digest_edirectory_auth
-digest_edirectory_auth_SOURCES = digest_pw_auth.cc \
+digest_edirectory_auth_SOURCES= \
+	digest_pw_auth.cc \
 	digest_common.h \
 	ldap_backend.cc \
 	ldap_backend.h \
@@ -28,4 +27,4 @@ digest_edirectory_auth_LDADD = \
 	$(SSLLIB) \
 	$(XTRA_LIBS)
 
-EXTRA_DIST = required.m4
+EXTRA_DIST= required.m4
@@ -13,6 +13,10 @@
 #ifndef SQUID_DIGEST_COMMON_H_
 #define SQUID_DIGEST_COMMON_H_
 
+#include "hash.h"
+#include "rfc2617.h"
+#include "util.h"
+
 #include <cctype>
 #include <cstdlib>
 #include <cstring>
@@ -32,10 +36,6 @@
 #include <crypt.h>
 #endif
 
-#include "hash.h"
-#include "rfc2617.h"
-#include "util.h"
-
 typedef struct _request_data {
     int channelId;
     char *user;
@@ -36,9 +36,9 @@
  * Copyright (c) 2003  Robert Collins  <robertc@squid-cache.org>
  */
 #include "squid.h"
-#include "digest_common.h"
-#include "helpers/defines.h"
-#include "ldap_backend.h"
+#include "auth/digest/eDirectory/digest_common.h"
+#include "auth/digest/eDirectory/ldap_backend.h"
+#include "helper/protocol_defines.h"
 
 #define PROGRAM_NAME "digest_edirectory_auth"
 
@@ -31,7 +31,7 @@
  */
 
 #include "squid.h"
-#include "digest_common.h"
+#include "auth/digest/eDirectory/digest_common.h"
 
 #if _SQUID_WINDOWS_ && !_SQUID_CYGWIN_
 
@@ -13,7 +13,7 @@
 
 #define LDAP_DEPRECATED 1
 
-#include "ldap_backend.h"
+#include "auth/digest/eDirectory/ldap_backend.h"
 
 #if _SQUID_WINDOWS_ && !_SQUID_CYGWIN_
 
@@ -48,7 +48,7 @@ PFldap_start_tls_s Win32_ldap_start_tls_s;
 #include <ldap.h>
 
 #endif
-#include "edir_ldapext.h"
+#include "auth/digest/eDirectory/edir_ldapext.h"
 #define PROGRAM_NAME "digest_pw_auth(LDAP_backend)"
 
 /* Globals */
@@ -8,10 +8,9 @@
 
 /*
  * AUTHOR: Flavio Pescuma. <flavio@marasystems.com>
- *
  */
 
-#include "digest_common.h"
+#include "auth/digest/eDirectory/digest_common.h"
 extern int LDAPArguments(int argc, char **argv);
 extern void LDAPHHA1(RequestData * requestData);
 
@@ -7,17 +7,16 @@
 
 include $(top_srcdir)/src/Common.am
 
-## we need our local files too (but avoid -I. at all costs)
-AM_CPPFLAGS += -I$(srcdir)
+man_MANS= digest_file_auth.8
+libexec_PROGRAMS= digest_file_auth
 
-man_MANS = digest_file_auth.8
-libexec_PROGRAMS = digest_file_auth
-digest_file_auth_SOURCES = digest_file_auth.cc \
+digest_file_auth_SOURCES= \
 	digest_common.h \
+	digest_file_auth.cc \
 	text_backend.cc \
 	text_backend.h
 
-LDADD = \
+digest_file_auth_LDADD = \
 	$(top_builddir)/lib/libmisccontainers.la \
 	$(top_builddir)/lib/libmiscencoding.la \
 	$(COMPAT_LIB) \
@@ -26,4 +25,6 @@ LDADD = \
 	$(SSLLIB) \
 	$(XTRA_LIBS)
 
-EXTRA_DIST = digest_file_auth.8 required.m4
+EXTRA_DIST= \
+	digest_file_auth.8 \
+	required.m4
@@ -40,9 +40,9 @@
  */
 
 #include "squid.h"
-#include "digest_common.h"
-#include "helpers/defines.h"
-#include "text_backend.h"
+#include "auth/digest/file/digest_common.h"
+#include "auth/digest/file/text_backend.h"
+#include "helper/protocol_defines.h"
 
 static void
 GetHHA1(RequestData * requestData)
@@ -36,7 +36,7 @@
  */
 
 #include "squid.h"
-#include "text_backend.h"
+#include "auth/digest/file/text_backend.h"
 
 static hash_table *hash = NULL;
 static HASHFREE my_free;
@@ -6,7 +6,7 @@
  * Please see the COPYING and CONTRIBUTORS files for details.
  */
 
-#include "digest_common.h"
+#include "auth/digest/file/digest_common.h"
 
 extern void TextArguments(int argc, char **argv);
 extern void TextHHA1(RequestData * requestData);
@@ -21,7 +21,7 @@ fi
 #define list of modules to build
 auto_auth_digest_modules=no
 if test "x$enable_auth_digest" = "xyes" ; then
-    SQUID_LOOK_FOR_MODULES([$srcdir/helpers/digest_auth],[enable_auth_digest])
+    SQUID_LOOK_FOR_MODULES([$srcdir/src/auth/digest],[enable_auth_digest])
   auto_auth_digest_modules=yes
 fi
 #handle the "none" special case
@@ -35,25 +35,25 @@ if test "x$enable_auth_digest" != "xno" ; then
     AUTH_MODULES="$AUTH_MODULES digest"
     AC_DEFINE([HAVE_AUTH_MODULE_DIGEST],1,[Digest auth module is built])
     for helper in $enable_auth_digest; do
-      dir="$srcdir/helpers/digest_auth/$helper"
+      dir="$srcdir/src/auth/digest/$helper"
 
       # modules converted to autoconf macros already
       # NP: we only need this list because m4_include() does not accept variables
-      if test "x$helper" = "xLDAP" ; then
-        m4_include([helpers/digest_auth/LDAP/required.m4])
-
-      elif test "x$helper" = "xeDirectory" ; then
-        m4_include([helpers/digest_auth/eDirectory/required.m4])
+      if test "x$helper" = "xeDirectory" ; then
+        m4_include([src/auth/digest/eDirectory/required.m4])
 
       elif test "x$helper" = "xfile" ; then
-        m4_include([helpers/digest_auth/file/required.m4])
+        m4_include([src/auth/digest/file/required.m4])
+
+      elif test "x$helper" = "xLDAP" ; then
+        m4_include([src/auth/digest/LDAP/required.m4])
 
       # modules not yet converted to autoconf macros (or third party drop-in's)
       elif test -f "$dir/config.test" && sh "$dir/config.test" "$squid_host_os"; then
         BUILD_HELPER="$helper"
       fi
 
-      if test -d "$srcdir/helpers/digest_auth/$helper"; then
+      if test -d "$srcdir/src/auth/digest/$helper"; then
         if test "$BUILD_HELPER" != "$helper"; then
           if test "x$auto_auth_digest_modules" = "xyes"; then
             AC_MSG_NOTICE([Digest auth helper $helper ... found but cannot be built])
@@ -8,6 +8,10 @@
 include $(top_srcdir)/src/Common.am
 include $(top_srcdir)/src/TestHeaders.am
 
+DIST_SUBDIRS= kerberos SSPI wrapper
+SUBDIRS= $(NEGOTIATE_AUTH_HELPERS)
+EXTRA_DIST= helpers.m4
+
 noinst_LTLIBRARIES = libnegotiate.la
 
 libnegotiate_la_SOURCES = \
@@ -9,13 +9,15 @@ include $(top_srcdir)/src/Common.am
 
 libexec_PROGRAMS = negotiate_sspi_auth
 
-negotiate_sspi_auth_SOURCES = negotiate_sspi_auth.cc
-
-LDADD = \
+negotiate_sspi_auth_SOURCES = \
+	negotiate_sspi_auth.cc
+negotiate_sspi_auth_LDADD = \
 	$(top_builddir)/lib/libsspwin32.la \
 	$(top_builddir)/lib/libmiscencoding.la \
 	$(COMPAT_LIB) \
 	-ladvapi32 \
 	$(XTRA_LIBS)
 
-EXTRA_DIST = readme.txt required.m4
+EXTRA_DIST= \
+	readme.txt \
+	required.m4
@@ -45,7 +45,7 @@
 
 #include "squid.h"
 #include "base64.h"
-#include "helpers/defines.h"
+#include "helper/protocol_defines.h"
 #include "ntlmauth/ntlmauth.h"
 #include "ntlmauth/support_bits.cci"
 #include "sspwin32.h"
@@ -16,12 +16,12 @@ if test "x$enable_auth_negotiate" = "x"; then
 fi
 #conflicts with global
 if test "x$enable_auth_negotiate" != "xno" -a "x$enable_auth" = "xno" ; then
-    AC_MSG_ERROR([Negotiate auth requested but auth disabled])
+  AC_MSG_ERROR([Negotiate auth requested but auth disabled])
 fi
 #define list of modules to build
 auto_auth_negotiate_modules=no
 if test "x$enable_auth_negotiate" = "xyes" ; then
-    SQUID_LOOK_FOR_MODULES([$srcdir/helpers/negotiate_auth],[enable_auth_negotiate])
+  SQUID_LOOK_FOR_MODULES([$srcdir/src/auth/negotiate],[enable_auth_negotiate])
   auto_auth_negotiate_modules=yes
 fi
 #handle the "none" special case
@@ -35,25 +35,25 @@ if test "x$enable_auth_negotiate" != "xno" ; then
     AUTH_MODULES="$AUTH_MODULES negotiate"
     AC_DEFINE([HAVE_AUTH_MODULE_NEGOTIATE],1,[Negotiate auth module is built])
     for helper in $enable_auth_negotiate; do
-      dir="$srcdir/helpers/negotiate_auth/$helper"
+      dir="$srcdir/src/auth/negotiate/$helper"
 
       # modules converted to autoconf macros already
       # NP: we only need this list because m4_include() does not accept variables
       if test "x$helper" = "xSSPI" ; then
-        m4_include([helpers/negotiate_auth/SSPI/required.m4])
+        m4_include([src/auth/negotiate/SSPI/required.m4])
 
       elif test "x$helper" = "xkerberos" ; then
-        m4_include([helpers/negotiate_auth/kerberos/required.m4])
+        m4_include([src/auth/negotiate/kerberos/required.m4])
 
       elif test "x$helper" = "xwrapper" ; then
-        m4_include([helpers/negotiate_auth/wrapper/required.m4])
+        m4_include([src/auth/negotiate/wrapper/required.m4])
 
       # modules not yet converted to autoconf macros (or third party drop-in's)
       elif test -f "$dir/config.test" && sh "$dir/config.test" "$squid_host_os"; then
         BUILD_HELPER="$helper"
       fi
 
-      if test -d "$srcdir/helpers/negotiate_auth/$helper"; then
+      if test -d "$srcdir/src/auth/negotiate/$helper"; then
         if test "$BUILD_HELPER" != "$helper"; then
           if test "x$auto_auth_negotiate_modules" = "xyes"; then
             AC_MSG_NOTICE([Negotiate auth helper $helper ... found but cannot be built])
@@ -7,29 +7,37 @@
 
 include $(top_srcdir)/src/Common.am
 
-EXTRA_DIST = README required.m4 negotiate_kerberos_auth.8
-SUBDIRS = 
+EXTRA_DIST= \
+	README \
+	required.m4 \
+	negotiate_kerberos_auth.8
 
-libexec_PROGRAMS = negotiate_kerberos_auth negotiate_kerberos_auth_test
+libexec_PROGRAMS = \
+	negotiate_kerberos_auth \
+	negotiate_kerberos_auth_test
 
 AM_CPPFLAGS += -I$(srcdir)
 
-negotiate_kerberos_auth_SOURCES = negotiate_kerberos_auth.cc negotiate_kerberos_pac.cc negotiate_kerberos.h
-negotiate_kerberos_auth_LDFLAGS = 
-negotiate_kerberos_auth_LDADD = \
+negotiate_kerberos_auth_SOURCES= \
+	negotiate_kerberos_auth.cc \
+	negotiate_kerberos_pac.cc \
+	negotiate_kerberos.h
+negotiate_kerberos_auth_LDFLAGS=
+negotiate_kerberos_auth_LDADD= \
 	$(top_builddir)/lib/libmiscencoding.la \
 	$(COMPAT_LIB) \
 	$(NETTLELIB) \
 	$(KRB5LIBS) \
 	$(XTRA_LIBS)
 
-negotiate_kerberos_auth_test_SOURCES = negotiate_kerberos_auth_test.cc
-negotiate_kerberos_auth_test_LDFLAGS = 
-negotiate_kerberos_auth_test_LDADD = \
+negotiate_kerberos_auth_test_SOURCES= \
+	negotiate_kerberos_auth_test.cc
+negotiate_kerberos_auth_test_LDFLAGS=
+negotiate_kerberos_auth_test_LDADD= \
 	$(top_builddir)/lib/libmiscencoding.la \
 	$(COMPAT_LIB) \
 	$(NETTLELIB) \
 	$(KRB5LIBS) \
 	$(XTRA_LIBS)
 
-man_MANS = negotiate_kerberos_auth.8
+man_MANS= negotiate_kerberos_auth.8
@@ -7,12 +7,13 @@
 
 include $(top_srcdir)/src/Common.am
 
-EXTRA_DIST = required.m4
+EXTRA_DIST= required.m4
 
-libexec_PROGRAMS = negotiate_wrapper_auth
+libexec_PROGRAMS= negotiate_wrapper_auth
 
-negotiate_wrapper_auth_SOURCES = negotiate_wrapper.cc
-negotiate_wrapper_auth_LDADD = \
+negotiate_wrapper_auth_SOURCES= \
+	negotiate_wrapper.cc
+negotiate_wrapper_auth_LDADD= \
 	$(top_builddir)/lib/libmiscencoding.la \
 	$(COMPAT_LIB) \
 	$(NETTLELIB) \
@@ -8,6 +8,10 @@
 include $(top_srcdir)/src/Common.am
 include $(top_srcdir)/src/TestHeaders.am
 
+DIST_SUBDIRS= fake SMB_LM SSPI
+SUBDIRS= $(NTLM_AUTH_HELPERS)
+EXTRA_DIST= helpers.m4
+
 noinst_LTLIBRARIES = libntlm.la
 
 libntlm_la_SOURCES = \
@@ -8,8 +8,8 @@
 include $(top_srcdir)/src/Common.am
 
 libexec_PROGRAMS = ntlm_smb_lm_auth
-ntlm_smb_lm_auth_SOURCES = ntlm_smb_lm_auth.cc
 
+ntlm_smb_lm_auth_SOURCES = ntlm_smb_lm_auth.cc
 ntlm_smb_lm_auth_LDADD = \
 	$(top_builddir)/lib/smblib/libsmblib.la \
 	$(top_builddir)/lib/rfcnb/librfcnb.la \
@@ -20,6 +20,4 @@ ntlm_smb_lm_auth_LDADD = \
 	$(CRYPTLIB) \
 	$(XTRA_LIBS)
 
-AM_CPPFLAGS += -I$(top_srcdir)/lib
-
 EXTRA_DIST = required.m4
@@ -24,7 +24,7 @@
 #include "squid.h"
 #include "base64.h"
 #include "compat/debug.h"
-#include "helpers/defines.h"
+#include "helper/protocol_defines.h"
 #include "ntlmauth/ntlmauth.h"
 #include "ntlmauth/support_bits.cci"
 #include "rfcnb/rfcnb.h"
@@ -10,6 +10,6 @@
 #
 # XXX: do we really need the mingw check?
 if test "$squid_host_os" != "mingw"; then
-  BUILD_HELPER="smb_lm"
+  BUILD_HELPER="SMB_LM"
   AC_CHECK_HEADERS([w32api/windows.h windows.h],[BUILD_HELPER=""])
 fi
@@ -7,13 +7,11 @@
 
 include $(top_srcdir)/src/Common.am
 
-man_MANS = ntlm_sspi_auth.8
+man_MANS= ntlm_sspi_auth.8
+libexec_PROGRAMS= ntlm_sspi_auth
 
-libexec_PROGRAMS = ntlm_sspi_auth
-
-ntlm_sspi_auth_SOURCES = ntlm_sspi_auth.cc
-
-LDADD = \
+ntlm_sspi_auth_SOURCES= ntlm_sspi_auth.cc
+ntlm_sspi_auth_LDADD= \
 	$(top_builddir)/lib/ntlmauth/libntlmauth.la \
 	$(top_builddir)/lib/libsspwin32.la \
 	$(top_builddir)/lib/libmiscencoding.la \
@@ -22,4 +20,6 @@ LDADD = \
 	-ladvapi32 \
 	$(XTRA_LIBS)
 
-EXTRA_DIST = ntlm_sspi_auth.8 required.m4
+EXTRA_DIST= \
+	ntlm_sspi_auth.8 \
+	required.m4
@@ -73,7 +73,7 @@
 
 #include "squid.h"
 #include "base64.h"
-#include "helpers/defines.h"
+#include "helper/protocol_defines.h"
 #include "ntlmauth/ntlmauth.h"
 #include "ntlmauth/support_bits.cci"
 #include "sspwin32.h"
@@ -7,22 +7,21 @@
 
 include $(top_srcdir)/src/Common.am
 
-libexec_PROGRAMS = ntlm_fake_auth
-ntlm_fake_auth_SOURCES	= ntlm_fake_auth.cc
+libexec_PROGRAMS= ntlm_fake_auth
 
-ntlm_fake_auth_LDADD = \
+ntlm_fake_auth_SOURCES= ntlm_fake_auth.cc
+ntlm_fake_auth_LDADD= \
 	$(top_builddir)/lib/ntlmauth/libntlmauth.la \
 	$(top_builddir)/lib/libmiscencoding.la \
 	$(COMPAT_LIB) \
 	$(NETTLELIB) \
 	$(CRYPTLIB) \
 	$(XTRA_LIBS)
 
-AM_CPPFLAGS += -I$(top_srcdir)/lib
-
 ## Demo using perl.
 ## ntlm_fake_auth.pl: ntlm_fake_auth.pl.in
 ##	$(subst_perlshell)
 
-EXTRA_DIST = required.m4 \
-	ntlm_fake_auth.pl.in
+EXTRA_DIST= \
+	ntlm_fake_auth.pl.in \
+	required.m4
@@ -35,7 +35,7 @@
 
 #include "squid.h"
 #include "base64.h"
-#include "helpers/defines.h"
+#include "helper/protocol_defines.h"
 #include "ntlmauth/ntlmauth.h"
 #include "ntlmauth/support_bits.cci"
 
@@ -21,7 +21,7 @@ fi
 #define list of modules to build
 auto_auth_ntlm_modules=no
 if test "x$enable_auth_ntlm" = "xyes" ; then
-    SQUID_LOOK_FOR_MODULES([$srcdir/helpers/ntlm_auth],[enable_auth_ntlm])
+    SQUID_LOOK_FOR_MODULES([$srcdir/src/auth/ntlm],[enable_auth_ntlm])
   auto_auth_ntlm_modules=yes
 fi
 #handle the "none" special case
@@ -36,25 +36,25 @@ if test "x$enable_auth_ntlm" != "xno" ; then
     AUTH_MODULES="$AUTH_MODULES ntlm"
     AC_DEFINE([HAVE_AUTH_MODULE_NTLM],1,[NTLM auth module is built])
     for helper in $enable_auth_ntlm; do
-      dir="$srcdir/helpers/ntlm_auth/$helper"
+      dir="$srcdir/src/auth/ntlm/$helper"
 
       # modules converted to autoconf macros already
       # NP: we only need this list because m4_include() does not accept variables
       if test "x$helper" = "xfake" ; then
-        m4_include([helpers/ntlm_auth/fake/required.m4])
+        m4_include([src/auth/ntlm/fake/required.m4])
 
-      elif test "x$helper" = "xSSPI" ; then
-        m4_include([helpers/ntlm_auth/SSPI/required.m4])
+      elif test "x$helper" = "xSMB_LM" ; then
+        m4_include([src/auth/ntlm/SMB_LM/required.m4])
 
-      elif test "x$helper" = "xsmb_lm" ; then
-        m4_include([helpers/ntlm_auth/smb_lm/required.m4])
+      elif test "x$helper" = "xSSPI" ; then
+        m4_include([src/auth/ntlm/SSPI/required.m4])
 
       # modules not yet converted to autoconf macros (or third party drop-in's)
       elif test -f "$dir/config.test" && sh "$dir/config.test" "$squid_host_os"; then
         BUILD_HELPER="$helper"
       fi
 
-      if test -d "$srcdir/helpers/ntlm_auth/$helper"; then
+      if test -d "$srcdir/src/auth/ntlm/$helper"; then
         if test "$BUILD_HELPER" != "$helper"; then
           if test "x$auto_auth_ntlm_modules" = "xyes"; then
             AC_MSG_NOTICE([NTLM auth helper $helper ... found but cannot be built])
@@ -18,3 +18,5 @@ libhelper_la_SOURCES = \
 	Reply.h \
 	Request.h \
 	ResultCode.h
+
+EXTRA_DIST= protocol_defines.h
@@ -8,8 +8,8 @@
 include $(top_srcdir)/src/Common.am
 include $(top_srcdir)/src/TestHeaders.am
 
-SUBDIRS = one
-DIST_SUBDIRS = one
+SUBDIRS = one url_rewriters
+DIST_SUBDIRS = one url_rewriters
 
 noinst_LTLIBRARIES = libsquid-http.la
 
@@ -0,0 +1,9 @@
+## Copyright (C) 1996-2016 The Squid Software Foundation and contributors
+##
+## Squid software is distributed under GPLv2+ license and includes
+## contributions from numerous individuals and organizations.
+## Please see the COPYING and CONTRIBUTORS files for details.
+##
+
+DIST_SUBDIRS= fake LFS
+SUBDIRS= $(URL_REWRITE_HELPERS)
@@ -6,12 +6,11 @@
 ##
 
 include $(top_srcdir)/src/Common.am
- 
+
 libexec_PROGRAMS = url_fake_rewrite
-url_fake_rewrite_SOURCES = fake.cc
+libexec_SCRIPTS = url_fake_rewrite.sh
 
+url_fake_rewrite_SOURCES = fake.cc
 url_fake_rewrite_LDADD = $(COMPAT_LIB)
 
-libexec_SCRIPTS = url_fake_rewrite.sh
-
 EXTRA_DIST = url_fake_rewrite.sh required.m4
@@ -43,7 +43,7 @@
  */
 
 #include "squid.h"
-#include "helpers/defines.h"
+#include "helper/protocol_defines.h"
 
 #include <cstring>
 
@@ -13,7 +13,7 @@
 #define list of modules to build
 auto_urlrewrite_modules=no
 if test "x${enable_url_rewrite_helpers:=yes}" = "xyes" ; then
-    SQUID_LOOK_FOR_MODULES([$srcdir/helpers/url_rewrite],[enable_url_rewrite_helpers])
+    SQUID_LOOK_FOR_MODULES([$srcdir/src/http/url_rewriters],[enable_url_rewrite_helpers])
   auto_urlrewrite_modules=yes
 fi
 
@@ -22,22 +22,22 @@ AC_MSG_NOTICE([URL rewrite helper candidates: $enable_url_rewrite_helpers])
 URL_REWRITE_HELPERS=""
 if test "x$enable_url_rewrite_helpers" != "xno" ; then
   for helper in $enable_url_rewrite_helpers; do
-    dir="$srcdir/helpers/url_rewrite/$helper"
+    dir="$srcdir/src/http/url_rewriters/$helper"
 
     # modules converted to autoconf macros already
     # NP: we only need this list because m4_include() does not accept variables
     if test "x$helper" = "xfake" ; then
-      m4_include([helpers/url_rewrite/fake/required.m4])
+      m4_include([src/http/url_rewriters/fake/required.m4])
 
     elif test "x$helper" = "xLFS" ; then
-      m4_include([helpers/url_rewrite/LFS/required.m4])
+      m4_include([src/http/url_rewriters/LFS/required.m4])
 
     # modules not yet converted to autoconf macros (or third party drop-in's)
     elif test -f "$dir/config.test" && sh "$dir/config.test" "$squid_host_os"; then
       BUILD_HELPER="$helper"
     fi
 
-    if test -d "$srcdir/helpers/url_rewrite/$helper"; then
+    if test -d "$srcdir/src/http/url_rewriters/$helper"; then
       if test "$BUILD_HELPER" != "$helper"; then
         if test "x$auto_urlrewrite_modules" = "xyes"; then
           AC_MSG_NOTICE([URL rewrite helper $helper ... found but cannot be built])
@@ -8,6 +8,10 @@
 include $(top_srcdir)/src/Common.am
 include $(top_srcdir)/src/TestHeaders.am
 
+DIST_SUBDIRS= DB file
+SUBDIRS= $(LOG_DAEMON_HELPERS)
+EXTRA_DIST= helpers.m4
+
 noinst_LTLIBRARIES = liblog.la
 
 liblog_la_SOURCES = \
@@ -10,6 +10,6 @@ include $(top_srcdir)/src/Common.am
 libexec_PROGRAMS = log_file_daemon
 log_file_daemon_SOURCES = log_file_daemon.cc
 log_file_daemon_LDADD = \
-	-L$(top_builddir)/lib $(COMPAT_LIB) \
+	$(COMPAT_LIB) \
 	$(XTRA_LIBS)
 EXTRA_DIST = required.m4
@@ -28,7 +28,7 @@
 #include <paths.h>
 #endif
 
-#include "defines.h"
+#include "helper/protocol_defines.h"
 
 /* parse buffer - ie, length of longest expected line */
 #define LOGFILE_BUF_LEN     65536
@@ -14,7 +14,7 @@
 auto_logdaemon_modules=no
 if test "x${enable_log_daemon_helpers:=yes}" = "xyes" ;then
   enable_log_daemon_helpers=""
-  SQUID_LOOK_FOR_MODULES([$srcdir/helpers/log_daemon],[enable_log_daemon_helpers])
+  SQUID_LOOK_FOR_MODULES([$srcdir/src/log],[enable_log_daemon_helpers])
   auto_logdaemon_modules=yes
 fi
 if test "x$enable_log_daemon_helpers" = "xnone" ; then
@@ -25,22 +25,22 @@ LOG_DAEMON_HELPERS=""
 enable_log_daemon_helpers="`echo $enable_log_daemon_helpers| sed -e 's/,/ /g;s/  */ /g'`"
 if test "x$enable_log_daemon_helpers" != "xno"; then
   for helper in $enable_log_daemon_helpers ; do
-    dir="$srcdir/helpers/log_daemon/$helper"
+    dir="$srcdir/src/log/$helper"
 
     # modules converted to autoconf macros already
     # NP: we only need this list because m4_include() does not accept variables
     if test "x$helper" = "xDB" ; then
-      m4_include([helpers/log_daemon/DB/required.m4])
+      m4_include([src/log/DB/required.m4])
 
     elif test "x$helper" = "xfile" ; then
-      m4_include([helpers/log_daemon/file/required.m4])
+      m4_include([src/log/file/required.m4])
 
     # modules not yet converted to autoconf macros (or third party drop-in's)
     elif test -f "$dir/config.test" && sh "$dir/config.test" "$squid_host_os"; then
       BUILD_HELPER="$helper"
     fi
 
-    if test -d "$srcdir/helpers/log_daemon/$helper"; then
+    if test -d "$srcdir/src/log/$helper"; then
       if test "$BUILD_HELPER" != "$helper"; then
         if test "x$auto_logdaemon_modules" = "xyes"; then
           AC_MSG_NOTICE([Log daemon helper $helper ... found but cannot be built])
@@ -7,4 +7,4 @@
 
 DIST_SUBDIRS= fake
 SUBDIRS= $(SECURITY_CERTV_HELPERS)
-
+EXTRA_DIST= helpers.m4
@@ -7,7 +7,7 @@
  */
 
 #include "squid.h"
-#include "helpers/defines.h"
+#include "helper/protocol_defines.h"
 #include "ssl/certificate_db.h"
 #include "ssl/crtd_message.h"
 
@@ -8,6 +8,8 @@
 include $(top_srcdir)/src/Common.am
 include $(top_srcdir)/src/TestHeaders.am
 
+SUBDIRS= id_rewriters
+
 noinst_LTLIBRARIES = libstore.la
 
 libstore_la_SOURCES= \
@@ -5,5 +5,6 @@
 ## Please see the COPYING and CONTRIBUTORS files for details.
 ##
 
-DIST_SUBDIRS	= kerberos SSPI wrapper
-SUBDIRS		= $(NEGOTIATE_AUTH_HELPERS)
+DIST_SUBDIRS= file
+SUBDIRS= $(STOREID_REWRITE_HELPERS)
+EXTRA_DIST= helpers.m4
@@ -13,7 +13,7 @@
 #define list of modules to build
 auto_storeid_modules=no
 if test "x${enable_storeid_rewrite_helpers:=yes}" = "xyes" ; then
-    SQUID_LOOK_FOR_MODULES([$srcdir/helpers/storeid_rewrite],[enable_storeid_rewrite_helpers])
+    SQUID_LOOK_FOR_MODULES([$srcdir/src/store/id_rewriters],[enable_storeid_rewrite_helpers])
   auto_storeid_modules=yes
 fi
 
@@ -22,19 +22,19 @@ AC_MSG_NOTICE([Store-ID rewrite helper candidates: $enable_storeid_rewrite_helpe
 STOREID_REWRITE_HELPERS=""
 if test "x$enable_storeid_rewrite_helpers" != "xno" ; then
   for helper in $enable_storeid_rewrite_helpers; do
-    dir="$srcdir/helpers/storeid_rewrite/$helper"
+    dir="$srcdir/src/store/id_rewriters/$helper"
 
     # modules converted to autoconf macros already
     # NP: we only need this list because m4_include() does not accept variables
     if test "x$helper" = "xfile" ; then
-      m4_include([helpers/storeid_rewrite/file/required.m4])
+      m4_include([src/store/id_rewriters/file/required.m4])
 
     # modules not yet converted to autoconf macros (or third party drop-in's)
     elif test -f "$dir/config.test" && sh "$dir/config.test" "$squid_host_os"; then
       BUILD_HELPER="$helper"
     fi
 
-    if test -d "$srcdir/helpers/storeid_rewrite/$helper"; then
+    if test -d "$srcdir/src/store/id_rewriters/$helper"; then
       if test "$BUILD_HELPER" != "$helper"; then
         if test "x$auto_storeid_modules" = "xyes"; then
           AC_MSG_NOTICE([Store-ID rewrite helper $helper ... found but cannot be built])