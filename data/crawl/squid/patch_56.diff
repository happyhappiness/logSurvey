----++++src/tools.cc
@@ -534,19 +534,22 @@ leave_suid(void)
     }
 
 #if HAVE_SETRESUID
-
-    if (setresuid(Config2.effectiveUserID, Config2.effectiveUserID, 0) &lt; 0)
-        debugs(50, DBG_CRITICAL, &quot;ALERT: setresuid: &quot; &lt;&lt; xstrerror());
+    if (setresuid(Config2.effectiveUserID, Config2.effectiveUserID, 0) &lt; 0) {
+        const auto xerrno = errno;
+        fatalf(&quot;FATAL: setresuid: %s&quot;, xstrerr(xerrno));
+    }
 
 #elif HAVE_SETEUID
-
-    if (seteuid(Config2.effectiveUserID) &lt; 0)
-        debugs(50, DBG_CRITICAL, &quot;ALERT: seteuid: &quot; &lt;&lt; xstrerror());
+    if (seteuid(Config2.effectiveUserID) &lt; 0) {
+        const auto xerrno = errno;
+        fatalf(&quot;FATAL: seteuid: %s&quot;, xstrerr(xerrno));
+    }
 
 #else
-
-    if (setuid(Config2.effectiveUserID) &lt; 0)
-        debugs(50, DBG_CRITICAL, &quot;ALERT: setuid: &quot; &lt;&lt; xstrerror());
+    if (setuid(Config2.effectiveUserID) &lt; 0) {
+        const auto xerrno = errno;
+        fatalf(&quot;FATAL: setuid: %s&quot;, xstrerr(xerrno));
+    }
 
 #endif
 
@@ -566,8 +569,10 @@ enter_suid(void)
 {
     debugs(21, 3, &quot;enter_suid: PID &quot; &lt;&lt; getpid() &lt;&lt; &quot; taking root privileges&quot;);
 #if HAVE_SETRESUID
-    if (setresuid((uid_t)-1, 0, (uid_t)-1) &lt; 0)
-        debugs (21, 3, &quot;enter_suid: setresuid failed: &quot; &lt;&lt; xstrerror ());
+    if (setresuid((uid_t)-1, 0, (uid_t)-1) &lt; 0) {
+        const auto xerrno = errno;
+        debugs (21, 3, &quot;enter_suid: setresuid failed: &quot; &lt;&lt; xstrerr(xerrno));
+    }
 #else
 
     setuid(0);
----++++GitHub