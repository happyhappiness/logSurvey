@@ -55,6 +55,7 @@
 
 const char *authenticate_ntlm_domain = "WORKGROUP";
 int debug_enabled = 0;
+int strip_domain_enabled = 0;
 int NTLM_packet_debug_enabled = 0;
 
 /* NTLM authentication by ad@interlude.eu.org - 07/1999 */
@@ -327,6 +328,7 @@ usage(void)
     fprintf(stderr,
 	"Usage: %s [-d] [-v] [-h]\n"
 	" -d  enable debugging.\n"
+	" -S  strip domain from username.\n"
 	" -v  enable verbose NTLM packet debugging.\n"
 	" -h  this message\n\n",
 	my_program_name);
@@ -339,7 +341,7 @@ process_options(int argc, char *argv[])
     int opt, had_error = 0;
 
     opterr = 0;
-    while (-1 != (opt = getopt(argc, argv, "hdv"))) {
+    while (-1 != (opt = getopt(argc, argv, "hdvS"))) {
 	switch (opt) {
 	case 'd':
 	    debug_enabled = 1;
@@ -348,6 +350,9 @@ process_options(int argc, char *argv[])
 	    debug_enabled = 1;
 	    NTLM_packet_debug_enabled = 1;
 	    break;
+	case 'S':
+	    strip_domain_enabled = 1;
+	    break;
 	case 'h':
 	    usage();
 	    exit(0);
@@ -423,7 +428,12 @@ main(int argc, char *argv[])
 	    if (!ntlmCheckHeader((ntlmhdr *) decoded, NTLM_AUTHENTICATE)) {
 		if (!ntlmDecodeAuth((struct ntlm_authenticate *) decoded, user, 256)) {
 		    lc(user);
+		    if (strip_domain_enabled) {
+			strtok_r(user, "\\", &p);
+			SEND2("AF %s", p);
+			} else {
 		    SEND2("AF %s", user);
+		    }
 		} else {
 		    lc(user);
 		    SEND2("NA invalid credentials, user=%s", user);
@@ -40,7 +40,7 @@ PRE_UNINSTALL = :
 POST_UNINSTALL = :
 build_triplet = @build@
 host_triplet = @host@
-check_PROGRAMS = tests/testAll$(EXEEXT)
+check_PROGRAMS = testHeaders$(EXEEXT) tests/testAll$(EXEEXT)
 subdir = lib
 DIST_COMMON = $(srcdir)/Makefile.am $(srcdir)/Makefile.in drand48.c \
 	getaddrinfo.c getnameinfo.c inet_ntoa.c inet_ntop.c \
@@ -89,6 +89,9 @@ libsspwin32_a_AR = $(AR) $(ARFLAGS)
 libsspwin32_a_LIBADD =
 am_libsspwin32_a_OBJECTS = sspwin32.$(OBJEXT)
 libsspwin32_a_OBJECTS = $(am_libsspwin32_a_OBJECTS)
+testHeaders_SOURCES = testHeaders.c
+testHeaders_OBJECTS = testHeaders.$(OBJEXT)
+testHeaders_LDADD = $(LDADD)
 am__tests_testAll_SOURCES_DIST = tests/testArray.h tests/testArray.cc \
 	tests/testIPAddress.h tests/testIPAddress.cc IPAddress.cc \
 	tests/testRFC1035.h tests/testRFC1035.cc tests/testMain.cc \
@@ -121,10 +124,11 @@ CXXLINK = $(LIBTOOL) --tag=CXX --mode=link $(CXXLD) $(AM_CXXFLAGS) \
 	$(CXXFLAGS) $(AM_LDFLAGS) $(LDFLAGS) -o $@
 SOURCES = $(libmiscutil_a_SOURCES) $(EXTRA_libmiscutil_a_SOURCES) \
 	$(libntlmauth_a_SOURCES) $(libregex_a_SOURCES) \
-	$(libsspwin32_a_SOURCES) $(tests_testAll_SOURCES)
+	$(libsspwin32_a_SOURCES) testHeaders.c \
+	$(tests_testAll_SOURCES)
 DIST_SOURCES = $(am__libmiscutil_a_SOURCES_DIST) \
 	$(EXTRA_libmiscutil_a_SOURCES) $(libntlmauth_a_SOURCES) \
-	$(libregex_a_SOURCES) $(libsspwin32_a_SOURCES) \
+	$(libregex_a_SOURCES) $(libsspwin32_a_SOURCES) testHeaders.c \
 	$(am__tests_testAll_SOURCES_DIST)
 RECURSIVE_TARGETS = all-recursive check-recursive dvi-recursive \
 	html-recursive info-recursive install-data-recursive \
@@ -552,6 +556,7 @@ distclean-compile:
 @AMDEP_TRUE@@am__include@ @am__quote@./$(DEPDIR)/strtoll.Po@am__quote@
 @AMDEP_TRUE@@am__include@ @am__quote@./$(DEPDIR)/stub_memaccount.Po@am__quote@
 @AMDEP_TRUE@@am__include@ @am__quote@./$(DEPDIR)/testArray.Po@am__quote@
+@AMDEP_TRUE@@am__include@ @am__quote@./$(DEPDIR)/testHeaders.Po@am__quote@
 @AMDEP_TRUE@@am__include@ @am__quote@./$(DEPDIR)/testIPAddress.Po@am__quote@
 @AMDEP_TRUE@@am__include@ @am__quote@./$(DEPDIR)/testMain.Po@am__quote@
 @AMDEP_TRUE@@am__include@ @am__quote@./$(DEPDIR)/testRFC1035.Po@am__quote@
@@ -1012,6 +1017,9 @@ uninstall-info: uninstall-info-recursive
 
 install: all
 install-strip: all
+
+testHeaders: $(top_srcdir)/include/*.h
+	$(top_srcdir)/test-suite/testheaders.sh "$(CXXCOMPILE)" "$(top_srcdir)/include" || exit 1
 # Tell versions [3.59,3.63) of GNU make to not export all variables.
 # Otherwise a system limit (for SysV at least) may be exceeded.
 .NOEXPORT:
@@ -101,7 +101,7 @@ EventLoop::runOnce()
     bool sawActivity = false;
     runOnceResult = true;
     error = false;
-    loop_delay = 1000; /* 1s default delay */
+    loop_delay = EVENT_LOOP_TIMEOUT;
 
     AsyncEngine *waitingEngine = primaryEngine;
     if (!waitingEngine && !engines.empty())
@@ -1,4 +1,3 @@
-
 /*
  * $Id: EventLoop.h,v 1.4 2008/02/12 23:49:44 rousskov Exp $
  *
@@ -39,68 +38,77 @@
 #include "AsyncEngine.h"
 #include "SquidTime.h"
 
-/* An event loop. An event loop is the core inner loop of squid.
+#define EVENT_LOOP_TIMEOUT	1000 /* 1s timeout */
+
+/** An event loop. An event loop is the core inner loop of squid.
  * The event loop can be run until exit, or once. After it finishes control
  * returns to the caller. If desired it can be run again.
- *
+ \par
  * The event loop cannot be run once it is running until it has finished.
  */
-
 class EventLoop
 {
 
 public:
     EventLoop();
-    /* register an async engine which will be given the opportunity to perform
+
+    /** register an async engine which will be given the opportunity to perform
      * in-main-thread tasks each event loop.
      */
     void registerEngine(AsyncEngine *engine);
-    /* start the event loop running. The loop will run until it is stopped by
+
+    /** start the event loop running. The loop will run until it is stopped by
      * calling stop(), or when the loop is completely idle - nothing 
      * dispatched in a loop, and all engines idle.
      */
     void run();
-    /* run the loop once. This may not complete all events! It should therefor
+
+    /** run the loop once. This may not complete all events! It should therefor
      * be used with care.
      * TODO: signal in runOnce whether or not the loop is over - IDLE vs OK vs
      * TIMEOUT?
      */
     bool runOnce();
-    /* set the primary async engine. The primary async engine recieves the
+
+    /** set the primary async engine. The primary async engine recieves the
      * lowest requested timeout gathered from the other engines each loop.
      * (There is a default of 10ms if all engines are idle or request higher
      * delays).
      * If no primary has been nominated, the last async engine added is 
      * implicitly the default.
      */
     void setPrimaryEngine(AsyncEngine * engine);
-    /* set the time service. There can be only one time service set at any
+
+    /** set the time service. There can be only one time service set at any
      * time. The time service is invoked on each loop 
      */
     void setTimeService(TimeEngine *engine);
-    /* stop the event loop - it will finish the current loop and then return to the
+
+    /** stop the event loop - it will finish the current loop and then return to the
      * caller of run().
      */
     void stop();
 
     int errcount;
 
 private:
-    /* setup state variables prior to running */
+    /** setup state variables prior to running */
     void prepareToRun();
-    /* check an individual engine */
+
+    /** check an individual engine */
     void checkEngine(AsyncEngine * engine, bool const primary);
-    /* dispatch calls and events scheduled during checkEngine() */
+
+    /** dispatch calls and events scheduled during checkEngine() */
     bool dispatchCalls();
 
     bool last_loop;
     typedef Vector<AsyncEngine *> engine_vector;
     engine_vector engines;
     TimeEngine * timeService;
     AsyncEngine * primaryEngine;
-    int loop_delay; /* the delay to be given to the primary engine */
-    bool error; /* has an error occured in this loop */
-    bool runOnceResult; /* the result from runOnce */
+    int loop_delay; /**< the delay to be given to the primary engine */
+    bool error; /**< has an error occured in this loop */
+    bool runOnceResult; /**< the result from runOnce */
 };
 
 
@@ -246,7 +246,7 @@ httpHdrCcPackInto(const HttpHdrCc * cc, Packer * p)
             if (flag == CC_S_MAXAGE)
                 packerPrintf(p, "=%d", (int) cc->s_maxage);
 
-            if (flag == CC_MAX_STALE)
+            if (flag == CC_MAX_STALE && cc->max_stale >= 0)
                 packerPrintf(p, "=%d", (int) cc->max_stale);
 
             pcount++;
@@ -263,8 +263,10 @@ ICMPSquid::Open(void)
     debugs(37, 4, HERE << "Pinger handle: 0x" << std::hex << hIpc << std::dec << ", PID: " << pid);
 
 #endif /* _SQUID_MSWIN_ */
-#endif /* USE_ICMP */
     return icmp_sock;
+#else /* USE_ICMP */
+    return -1;
+#endif /* USE_ICMP */
 }
 
 void
@@ -48,14 +48,13 @@ PRE_UNINSTALL = :
 POST_UNINSTALL = :
 build_triplet = @build@
 host_triplet = @host@
-check_PROGRAMS = tests/testAuth$(EXEEXT) \
+check_PROGRAMS = testHeaders$(EXEEXT) tests/testAuth$(EXEEXT) \
 	tests/testACLMaxUserIP$(EXEEXT) tests/testBoilerplate$(EXEEXT) \
 	tests/testCacheManager$(EXEEXT) tests/testDiskIO$(EXEEXT) \
 	tests/testEvent$(EXEEXT) tests/testEventLoop$(EXEEXT) \
-	tests/testHeaders$(EXEEXT) tests/test_http_range$(EXEEXT) \
-	tests/testHttpRequest$(EXEEXT) tests/testICMP$(EXEEXT) \
-	tests/testStore$(EXEEXT) tests/testString$(EXEEXT) \
-	tests/testURL$(EXEEXT) @STORE_TESTS@
+	tests/test_http_range$(EXEEXT) tests/testHttpRequest$(EXEEXT) \
+	tests/testICMP$(EXEEXT) tests/testStore$(EXEEXT) \
+	tests/testString$(EXEEXT) tests/testURL$(EXEEXT) @STORE_TESTS@
 EXTRA_PROGRAMS = DiskIO/DiskDaemon/diskd$(EXEEXT) unlinkd$(EXEEXT) \
 	pinger$(EXEEXT) dnsserver$(EXEEXT) recv-announce$(EXEEXT) \
 	tests/testUfs$(EXEEXT) tests/testCoss$(EXEEXT) \
@@ -137,7 +136,7 @@ am_libauth_la_OBJECTS = AuthConfig.lo AuthScheme.lo AuthUser.lo \
 libauth_la_OBJECTS = $(am_libauth_la_OBJECTS)
 libsquid_la_LIBADD =
 am_libsquid_la_OBJECTS = comm.lo CommCalls.lo IPInterception.lo \
-	ICAP/AsyncJob.lo TextException.lo
+	ICAP/AsyncJob.lo SquidConfig.lo TextException.lo
 libsquid_la_OBJECTS = $(am_libsquid_la_OBJECTS)
 am__installdirs = "$(DESTDIR)$(bindir)" "$(DESTDIR)$(libexecdir)" \
 	"$(DESTDIR)$(sbindir)" "$(DESTDIR)$(datadir)" \
@@ -224,8 +223,8 @@ am__squid_SOURCES_DIST = access_log.cc AccessLogEntry.h acl.cc \
 	DiskIO/ReadRequest.cc DiskIO/ReadRequest.h \
 	DiskIO/WriteRequest.cc DiskIO/WriteRequest.h DiskIO/DiskFile.h \
 	DiskIO/DiskIOStrategy.h DiskIO/IORequestor.h \
-	DiskIO/DiskIOModule.h dlink.h dns_internal.cc dns.cc enums.h \
-	errorpage.cc ElementList.h ESI.cc ESI.h ESIAssign.cc \
+	DiskIO/DiskIOModule.h dlink.h dlink.cc dns_internal.cc dns.cc \
+	enums.h errorpage.cc ElementList.h ESI.cc ESI.h ESIAssign.cc \
 	ESIAssign.h ESIAttempt.h ESIContext.cc ESIContext.h \
 	ESICustomParser.cc ESICustomParser.h ESIElement.h ESIExcept.h \
 	ESIExpatParser.cc ESIExpatParser.h ESIExpression.cc \
@@ -341,9 +340,9 @@ am_squid_OBJECTS = access_log.$(OBJEXT) acl.$(OBJEXT) \
 	clientStream.$(OBJEXT) CompletionDispatcher.$(OBJEXT) \
 	$(am__objects_7) ConfigOption.$(OBJEXT) ConfigParser.$(OBJEXT) \
 	debug.$(OBJEXT) $(am__objects_9) disk.$(OBJEXT) \
-	$(am__objects_10) $(am__objects_11) errorpage.$(OBJEXT) \
-	$(am__objects_13) ETag.$(OBJEXT) event.$(OBJEXT) \
-	EventLoop.$(OBJEXT) external_acl.$(OBJEXT) \
+	$(am__objects_10) dlink.$(OBJEXT) $(am__objects_11) \
+	errorpage.$(OBJEXT) $(am__objects_13) ETag.$(OBJEXT) \
+	event.$(OBJEXT) EventLoop.$(OBJEXT) external_acl.$(OBJEXT) \
 	ExternalACLEntry.$(OBJEXT) fd.$(OBJEXT) fde.$(OBJEXT) \
 	filemap.$(OBJEXT) forward.$(OBJEXT) fqdncache.$(OBJEXT) \
 	ftp.$(OBJEXT) gopher.$(OBJEXT) helper.$(OBJEXT) \
@@ -419,6 +418,10 @@ am__EXTRA_squid_SOURCES_DIST = fs/aufs/StoreFSaufs.cc \
 nodist_squid_OBJECTS = repl_modules.$(OBJEXT) globals.$(OBJEXT) \
 	string_arrays.$(OBJEXT)
 squid_OBJECTS = $(am_squid_OBJECTS) $(nodist_squid_OBJECTS)
+testHeaders_SOURCES = testHeaders.c
+testHeaders_OBJECTS = testHeaders.$(OBJEXT)
+testHeaders_LDADD = $(LDADD)
+testHeaders_DEPENDENCIES = libsquid.la libauth.la
 am__objects_32 = event.$(OBJEXT) AsyncCallQueue.$(OBJEXT) \
 	AsyncCall.$(OBJEXT)
 am__objects_33 = ../test-suite/test_tools.$(OBJEXT) globals.$(OBJEXT)
@@ -480,35 +483,36 @@ am__tests_testCacheManager_SOURCES_DIST = debug.cc globals.cc \
 	DelayConfig.h DelayPool.cc DelayPool.h DelayPools.h \
 	DelaySpec.cc DelaySpec.h DelayTagged.cc DelayTagged.h \
 	DelayUser.cc DelayUser.h DelayVector.cc DelayVector.h \
-	NullDelayId.cc NullDelayId.h disk.cc dns_internal.cc dns.cc \
-	errorpage.cc ElementList.h ESI.cc ESI.h ESIAssign.cc \
-	ESIAssign.h ESIAttempt.h ESIContext.cc ESIContext.h \
-	ESICustomParser.cc ESICustomParser.h ESIElement.h ESIExcept.h \
-	ESIExpatParser.cc ESIExpatParser.h ESIExpression.cc \
-	ESIExpression.h ESIInclude.cc ESIInclude.h ESILiteral.h \
-	ESILibxml2Parser.cc ESILibxml2Parser.h ESIParser.cc \
-	ESIParser.h ESISegment.cc ESISegment.h ESISequence.cc \
-	ESISequence.h ESIVar.h ESIVarState.cc ESIVarState.h ETag.cc \
-	external_acl.cc ExternalACLEntry.cc fd.cc fde.cc forward.cc \
-	fqdncache.cc ftp.cc gopher.cc helper.cc htcp.cc htcp.h http.cc \
-	HttpBody.cc HttpHeader.cc HttpHeaderTools.cc HttpHdrCc.cc \
-	HttpHdrContRange.cc HttpHdrRange.cc HttpHdrSc.cc \
-	HttpHdrScTarget.cc HttpMsg.cc HttpReply.cc HttpStatusLine.cc \
-	ICMP.h icmp.cc ICMPConfig.h ICMPSquid.h ICMPSquid.cc icp_v2.cc \
-	icp_v3.cc ACLIdent.cc ACLIdent.h ident.cc ipc.cc ipc_win32.cc \
-	ipcache.cc int.cc internal.cc list.cc logfile.cc multicast.cc \
-	mem_node.cc MemBuf.cc MemObject.cc mime.cc neighbors.cc \
-	net_db.cc Packer.cc Parsing.cc pconn.cc peer_digest.cc \
-	peer_select.cc redirect.cc referer.cc refresh.cc \
-	RemovalPolicy.cc Server.cc snmp_core.cc snmp_agent.cc \
-	ACLCertificateData.cc ACLCertificateData.h ACLCertificate.cc \
-	ACLCertificate.h ACLSslError.cc ACLSslError.h \
-	ACLSslErrorData.cc ACLSslErrorData.h ssl_support.cc \
-	ssl_support.h stat.cc StatHist.cc stmem.cc store.cc \
-	store_client.cc store_digest.cc store_dir.cc store_io.cc \
-	store_key_md5.cc store_log.cc store_rebuild.cc store_swapin.cc \
-	store_swapmeta.cc store_swapout.cc StoreFileSystem.cc \
-	StoreIOState.cc StoreMeta.cc StoreMetaMD5.cc StoreMetaSTD.cc \
+	NullDelayId.cc NullDelayId.h disk.cc dlink.h dlink.cc \
+	dns_internal.cc dns.cc errorpage.cc ElementList.h ESI.cc ESI.h \
+	ESIAssign.cc ESIAssign.h ESIAttempt.h ESIContext.cc \
+	ESIContext.h ESICustomParser.cc ESICustomParser.h ESIElement.h \
+	ESIExcept.h ESIExpatParser.cc ESIExpatParser.h \
+	ESIExpression.cc ESIExpression.h ESIInclude.cc ESIInclude.h \
+	ESILiteral.h ESILibxml2Parser.cc ESILibxml2Parser.h \
+	ESIParser.cc ESIParser.h ESISegment.cc ESISegment.h \
+	ESISequence.cc ESISequence.h ESIVar.h ESIVarState.cc \
+	ESIVarState.h ETag.cc external_acl.cc ExternalACLEntry.cc \
+	fd.cc fde.cc forward.cc fqdncache.cc ftp.cc gopher.cc \
+	helper.cc htcp.cc htcp.h http.cc HttpBody.cc HttpHeader.cc \
+	HttpHeaderTools.cc HttpHdrCc.cc HttpHdrContRange.cc \
+	HttpHdrRange.cc HttpHdrSc.cc HttpHdrScTarget.cc HttpMsg.cc \
+	HttpReply.cc HttpStatusLine.cc ICMP.h icmp.cc ICMPConfig.h \
+	ICMPSquid.h ICMPSquid.cc icp_v2.cc icp_v3.cc ACLIdent.cc \
+	ACLIdent.h ident.cc ipc.cc ipc_win32.cc ipcache.cc int.cc \
+	internal.cc list.cc logfile.cc multicast.cc mem_node.cc \
+	MemBuf.cc MemObject.cc mime.cc neighbors.cc net_db.cc \
+	Packer.cc Parsing.cc pconn.cc peer_digest.cc peer_select.cc \
+	redirect.cc referer.cc refresh.cc RemovalPolicy.cc Server.cc \
+	snmp_core.cc snmp_agent.cc ACLCertificateData.cc \
+	ACLCertificateData.h ACLCertificate.cc ACLCertificate.h \
+	ACLSslError.cc ACLSslError.h ACLSslErrorData.cc \
+	ACLSslErrorData.h ssl_support.cc ssl_support.h stat.cc \
+	StatHist.cc stmem.cc store.cc store_client.cc store_digest.cc \
+	store_dir.cc store_io.cc store_key_md5.cc store_log.cc \
+	store_rebuild.cc store_swapin.cc store_swapmeta.cc \
+	store_swapout.cc StoreFileSystem.cc StoreIOState.cc \
+	StoreMeta.cc StoreMetaMD5.cc StoreMetaSTD.cc \
 	StoreMetaSTDLFS.cc StoreMetaUnpacker.cc StoreMetaURL.cc \
 	StoreMetaVary.cc StoreSwapLogData.cc event.cc \
 	AsyncCallQueue.cc AsyncCall.cc tools.cc tunnel.cc SwapDir.cc \
@@ -529,41 +533,42 @@ am_tests_testCacheManager_OBJECTS = debug.$(OBJEXT) globals.$(OBJEXT) \
 	client_side.$(OBJEXT) client_side_reply.$(OBJEXT) \
 	client_side_request.$(OBJEXT) clientStream.$(OBJEXT) \
 	$(am__objects_7) ConfigOption.$(OBJEXT) ConfigParser.$(OBJEXT) \
-	$(am__objects_9) disk.$(OBJEXT) $(am__objects_11) \
-	errorpage.$(OBJEXT) $(am__objects_13) ETag.$(OBJEXT) \
-	external_acl.$(OBJEXT) ExternalACLEntry.$(OBJEXT) fd.$(OBJEXT) \
-	fde.$(OBJEXT) forward.$(OBJEXT) fqdncache.$(OBJEXT) \
-	ftp.$(OBJEXT) gopher.$(OBJEXT) helper.$(OBJEXT) \
-	$(am__objects_14) http.$(OBJEXT) HttpBody.$(OBJEXT) \
-	HttpHeader.$(OBJEXT) HttpHeaderTools.$(OBJEXT) \
-	HttpHdrCc.$(OBJEXT) HttpHdrContRange.$(OBJEXT) \
-	HttpHdrRange.$(OBJEXT) HttpHdrSc.$(OBJEXT) \
-	HttpHdrScTarget.$(OBJEXT) HttpMsg.$(OBJEXT) \
-	HttpReply.$(OBJEXT) HttpStatusLine.$(OBJEXT) $(am__objects_15) \
-	icp_v2.$(OBJEXT) icp_v3.$(OBJEXT) $(am__objects_17) \
-	$(am__objects_18) ipcache.$(OBJEXT) int.$(OBJEXT) \
-	internal.$(OBJEXT) list.$(OBJEXT) logfile.$(OBJEXT) \
-	multicast.$(OBJEXT) mem_node.$(OBJEXT) MemBuf.$(OBJEXT) \
-	MemObject.$(OBJEXT) mime.$(OBJEXT) neighbors.$(OBJEXT) \
-	net_db.$(OBJEXT) Packer.$(OBJEXT) Parsing.$(OBJEXT) \
-	pconn.$(OBJEXT) peer_digest.$(OBJEXT) peer_select.$(OBJEXT) \
-	redirect.$(OBJEXT) referer.$(OBJEXT) refresh.$(OBJEXT) \
-	RemovalPolicy.$(OBJEXT) Server.$(OBJEXT) $(am__objects_22) \
-	$(am__objects_24) stat.$(OBJEXT) StatHist.$(OBJEXT) \
-	stmem.$(OBJEXT) store.$(OBJEXT) store_client.$(OBJEXT) \
-	store_digest.$(OBJEXT) store_dir.$(OBJEXT) store_io.$(OBJEXT) \
-	store_key_md5.$(OBJEXT) store_log.$(OBJEXT) \
-	store_rebuild.$(OBJEXT) store_swapin.$(OBJEXT) \
-	store_swapmeta.$(OBJEXT) store_swapout.$(OBJEXT) \
-	StoreFileSystem.$(OBJEXT) StoreIOState.$(OBJEXT) \
-	StoreMeta.$(OBJEXT) StoreMetaMD5.$(OBJEXT) \
-	StoreMetaSTD.$(OBJEXT) StoreMetaSTDLFS.$(OBJEXT) \
-	StoreMetaUnpacker.$(OBJEXT) StoreMetaURL.$(OBJEXT) \
-	StoreMetaVary.$(OBJEXT) StoreSwapLogData.$(OBJEXT) \
-	$(am__objects_32) tools.$(OBJEXT) tunnel.$(OBJEXT) \
-	SwapDir.$(OBJEXT) url.$(OBJEXT) URLScheme.$(OBJEXT) \
-	urn.$(OBJEXT) useragent.$(OBJEXT) wccp2.$(OBJEXT) \
-	whois.$(OBJEXT) $(am__objects_26) wordlist.$(OBJEXT)
+	$(am__objects_9) disk.$(OBJEXT) dlink.$(OBJEXT) \
+	$(am__objects_11) errorpage.$(OBJEXT) $(am__objects_13) \
+	ETag.$(OBJEXT) external_acl.$(OBJEXT) \
+	ExternalACLEntry.$(OBJEXT) fd.$(OBJEXT) fde.$(OBJEXT) \
+	forward.$(OBJEXT) fqdncache.$(OBJEXT) ftp.$(OBJEXT) \
+	gopher.$(OBJEXT) helper.$(OBJEXT) $(am__objects_14) \
+	http.$(OBJEXT) HttpBody.$(OBJEXT) HttpHeader.$(OBJEXT) \
+	HttpHeaderTools.$(OBJEXT) HttpHdrCc.$(OBJEXT) \
+	HttpHdrContRange.$(OBJEXT) HttpHdrRange.$(OBJEXT) \
+	HttpHdrSc.$(OBJEXT) HttpHdrScTarget.$(OBJEXT) \
+	HttpMsg.$(OBJEXT) HttpReply.$(OBJEXT) HttpStatusLine.$(OBJEXT) \
+	$(am__objects_15) icp_v2.$(OBJEXT) icp_v3.$(OBJEXT) \
+	$(am__objects_17) $(am__objects_18) ipcache.$(OBJEXT) \
+	int.$(OBJEXT) internal.$(OBJEXT) list.$(OBJEXT) \
+	logfile.$(OBJEXT) multicast.$(OBJEXT) mem_node.$(OBJEXT) \
+	MemBuf.$(OBJEXT) MemObject.$(OBJEXT) mime.$(OBJEXT) \
+	neighbors.$(OBJEXT) net_db.$(OBJEXT) Packer.$(OBJEXT) \
+	Parsing.$(OBJEXT) pconn.$(OBJEXT) peer_digest.$(OBJEXT) \
+	peer_select.$(OBJEXT) redirect.$(OBJEXT) referer.$(OBJEXT) \
+	refresh.$(OBJEXT) RemovalPolicy.$(OBJEXT) Server.$(OBJEXT) \
+	$(am__objects_22) $(am__objects_24) stat.$(OBJEXT) \
+	StatHist.$(OBJEXT) stmem.$(OBJEXT) store.$(OBJEXT) \
+	store_client.$(OBJEXT) store_digest.$(OBJEXT) \
+	store_dir.$(OBJEXT) store_io.$(OBJEXT) store_key_md5.$(OBJEXT) \
+	store_log.$(OBJEXT) store_rebuild.$(OBJEXT) \
+	store_swapin.$(OBJEXT) store_swapmeta.$(OBJEXT) \
+	store_swapout.$(OBJEXT) StoreFileSystem.$(OBJEXT) \
+	StoreIOState.$(OBJEXT) StoreMeta.$(OBJEXT) \
+	StoreMetaMD5.$(OBJEXT) StoreMetaSTD.$(OBJEXT) \
+	StoreMetaSTDLFS.$(OBJEXT) StoreMetaUnpacker.$(OBJEXT) \
+	StoreMetaURL.$(OBJEXT) StoreMetaVary.$(OBJEXT) \
+	StoreSwapLogData.$(OBJEXT) $(am__objects_32) tools.$(OBJEXT) \
+	tunnel.$(OBJEXT) SwapDir.$(OBJEXT) url.$(OBJEXT) \
+	URLScheme.$(OBJEXT) urn.$(OBJEXT) useragent.$(OBJEXT) \
+	wccp2.$(OBJEXT) whois.$(OBJEXT) $(am__objects_26) \
+	wordlist.$(OBJEXT)
 nodist_tests_testCacheManager_OBJECTS = repl_modules.$(OBJEXT) \
 	string_arrays.$(OBJEXT)
 tests_testCacheManager_OBJECTS = $(am_tests_testCacheManager_OBJECTS) \
@@ -707,40 +712,40 @@ am__tests_testEvent_SOURCES_DIST = debug.cc EventLoop.h EventLoop.cc \
 	DelayConfig.h DelayPool.cc DelayPool.h DelayPools.h \
 	DelaySpec.cc DelaySpec.h DelayTagged.cc DelayTagged.h \
 	DelayUser.cc DelayUser.h DelayVector.cc DelayVector.h \
-	NullDelayId.cc NullDelayId.h disk.cc dns_internal.cc dns.cc \
-	errorpage.cc ElementList.h ESI.cc ESI.h ESIAssign.cc \
-	ESIAssign.h ESIAttempt.h ESIContext.cc ESIContext.h \
-	ESICustomParser.cc ESICustomParser.h ESIElement.h ESIExcept.h \
-	ESIExpatParser.cc ESIExpatParser.h ESIExpression.cc \
-	ESIExpression.h ESIInclude.cc ESIInclude.h ESILiteral.h \
-	ESILibxml2Parser.cc ESILibxml2Parser.h ESIParser.cc \
-	ESIParser.h ESISegment.cc ESISegment.h ESISequence.cc \
-	ESISequence.h ESIVar.h ESIVarState.cc ESIVarState.h ETag.cc \
-	external_acl.cc ExternalACLEntry.cc fd.cc fde.cc forward.cc \
-	fqdncache.cc ftp.cc gopher.cc helper.cc htcp.cc htcp.h http.cc \
-	HttpBody.cc HttpHeader.cc HttpHeaderTools.cc HttpHdrCc.cc \
-	HttpHdrContRange.cc HttpHdrRange.cc HttpHdrSc.cc \
-	HttpHdrScTarget.cc HttpMsg.cc HttpReply.cc HttpStatusLine.cc \
-	ICMP.h icmp.cc ICMPConfig.h ICMPSquid.h ICMPSquid.cc icp_v2.cc \
-	icp_v3.cc ACLIdent.cc ACLIdent.h ident.cc ipc.cc ipc_win32.cc \
-	ipcache.cc int.cc internal.cc list.cc logfile.cc multicast.cc \
-	mem_node.cc MemBuf.cc MemObject.cc mime.cc neighbors.cc \
-	net_db.cc Packer.cc Parsing.cc pconn.cc peer_digest.cc \
-	peer_select.cc redirect.cc referer.cc refresh.cc Server.cc \
-	snmp_core.cc snmp_agent.cc ACLCertificateData.cc \
-	ACLCertificateData.h ACLCertificate.cc ACLCertificate.h \
-	ACLSslError.cc ACLSslError.h ACLSslErrorData.cc \
-	ACLSslErrorData.h ssl_support.cc ssl_support.h stat.cc \
-	StatHist.cc stmem.cc store.cc store_client.cc store_digest.cc \
-	store_dir.cc store_io.cc store_key_md5.cc store_log.cc \
-	store_rebuild.cc store_swapin.cc store_swapmeta.cc \
-	store_swapout.cc StoreFileSystem.cc StoreIOState.cc \
-	StoreMeta.cc StoreMetaMD5.cc StoreMetaSTD.cc \
-	StoreMetaSTDLFS.cc StoreMetaUnpacker.cc StoreMetaURL.cc \
-	StoreMetaVary.cc StoreSwapLogData.cc event.cc \
-	AsyncCallQueue.cc AsyncCall.cc tools.cc tunnel.cc SwapDir.cc \
-	url.cc URLScheme.cc urn.cc useragent.cc wccp2.cc whois.cc \
-	win32.cc wordlist.cc
+	NullDelayId.cc NullDelayId.h disk.cc dlink.h dlink.cc \
+	dns_internal.cc dns.cc errorpage.cc ElementList.h ESI.cc ESI.h \
+	ESIAssign.cc ESIAssign.h ESIAttempt.h ESIContext.cc \
+	ESIContext.h ESICustomParser.cc ESICustomParser.h ESIElement.h \
+	ESIExcept.h ESIExpatParser.cc ESIExpatParser.h \
+	ESIExpression.cc ESIExpression.h ESIInclude.cc ESIInclude.h \
+	ESILiteral.h ESILibxml2Parser.cc ESILibxml2Parser.h \
+	ESIParser.cc ESIParser.h ESISegment.cc ESISegment.h \
+	ESISequence.cc ESISequence.h ESIVar.h ESIVarState.cc \
+	ESIVarState.h ETag.cc external_acl.cc ExternalACLEntry.cc \
+	fd.cc fde.cc forward.cc fqdncache.cc ftp.cc gopher.cc \
+	helper.cc htcp.cc htcp.h http.cc HttpBody.cc HttpHeader.cc \
+	HttpHeaderTools.cc HttpHdrCc.cc HttpHdrContRange.cc \
+	HttpHdrRange.cc HttpHdrSc.cc HttpHdrScTarget.cc HttpMsg.cc \
+	HttpReply.cc HttpStatusLine.cc ICMP.h icmp.cc ICMPConfig.h \
+	ICMPSquid.h ICMPSquid.cc icp_v2.cc icp_v3.cc ACLIdent.cc \
+	ACLIdent.h ident.cc ipc.cc ipc_win32.cc ipcache.cc int.cc \
+	internal.cc list.cc logfile.cc multicast.cc mem_node.cc \
+	MemBuf.cc MemObject.cc mime.cc neighbors.cc net_db.cc \
+	Packer.cc Parsing.cc pconn.cc peer_digest.cc peer_select.cc \
+	redirect.cc referer.cc refresh.cc Server.cc snmp_core.cc \
+	snmp_agent.cc ACLCertificateData.cc ACLCertificateData.h \
+	ACLCertificate.cc ACLCertificate.h ACLSslError.cc \
+	ACLSslError.h ACLSslErrorData.cc ACLSslErrorData.h \
+	ssl_support.cc ssl_support.h stat.cc StatHist.cc stmem.cc \
+	store.cc store_client.cc store_digest.cc store_dir.cc \
+	store_io.cc store_key_md5.cc store_log.cc store_rebuild.cc \
+	store_swapin.cc store_swapmeta.cc store_swapout.cc \
+	StoreFileSystem.cc StoreIOState.cc StoreMeta.cc \
+	StoreMetaMD5.cc StoreMetaSTD.cc StoreMetaSTDLFS.cc \
+	StoreMetaUnpacker.cc StoreMetaURL.cc StoreMetaVary.cc \
+	StoreSwapLogData.cc event.cc AsyncCallQueue.cc AsyncCall.cc \
+	tools.cc tunnel.cc SwapDir.cc url.cc URLScheme.cc urn.cc \
+	useragent.cc wccp2.cc whois.cc win32.cc wordlist.cc
 am_tests_testEvent_OBJECTS = debug.$(OBJEXT) EventLoop.$(OBJEXT) \
 	globals.$(OBJEXT) HttpRequest.$(OBJEXT) \
 	HttpRequestMethod.$(OBJEXT) mem.$(OBJEXT) \
@@ -757,41 +762,41 @@ am_tests_testEvent_OBJECTS = debug.$(OBJEXT) EventLoop.$(OBJEXT) \
 	client_side.$(OBJEXT) client_side_reply.$(OBJEXT) \
 	client_side_request.$(OBJEXT) clientStream.$(OBJEXT) \
 	$(am__objects_7) ConfigOption.$(OBJEXT) ConfigParser.$(OBJEXT) \
-	$(am__objects_9) disk.$(OBJEXT) $(am__objects_11) \
-	errorpage.$(OBJEXT) $(am__objects_13) ETag.$(OBJEXT) \
-	external_acl.$(OBJEXT) ExternalACLEntry.$(OBJEXT) fd.$(OBJEXT) \
-	fde.$(OBJEXT) forward.$(OBJEXT) fqdncache.$(OBJEXT) \
-	ftp.$(OBJEXT) gopher.$(OBJEXT) helper.$(OBJEXT) \
-	$(am__objects_14) http.$(OBJEXT) HttpBody.$(OBJEXT) \
-	HttpHeader.$(OBJEXT) HttpHeaderTools.$(OBJEXT) \
-	HttpHdrCc.$(OBJEXT) HttpHdrContRange.$(OBJEXT) \
-	HttpHdrRange.$(OBJEXT) HttpHdrSc.$(OBJEXT) \
-	HttpHdrScTarget.$(OBJEXT) HttpMsg.$(OBJEXT) \
-	HttpReply.$(OBJEXT) HttpStatusLine.$(OBJEXT) $(am__objects_15) \
-	icp_v2.$(OBJEXT) icp_v3.$(OBJEXT) $(am__objects_17) \
-	$(am__objects_18) ipcache.$(OBJEXT) int.$(OBJEXT) \
-	internal.$(OBJEXT) list.$(OBJEXT) logfile.$(OBJEXT) \
-	multicast.$(OBJEXT) mem_node.$(OBJEXT) MemBuf.$(OBJEXT) \
-	MemObject.$(OBJEXT) mime.$(OBJEXT) neighbors.$(OBJEXT) \
-	net_db.$(OBJEXT) Packer.$(OBJEXT) Parsing.$(OBJEXT) \
-	pconn.$(OBJEXT) peer_digest.$(OBJEXT) peer_select.$(OBJEXT) \
-	redirect.$(OBJEXT) referer.$(OBJEXT) refresh.$(OBJEXT) \
-	Server.$(OBJEXT) $(am__objects_22) $(am__objects_24) \
-	stat.$(OBJEXT) StatHist.$(OBJEXT) stmem.$(OBJEXT) \
-	store.$(OBJEXT) store_client.$(OBJEXT) store_digest.$(OBJEXT) \
-	store_dir.$(OBJEXT) store_io.$(OBJEXT) store_key_md5.$(OBJEXT) \
-	store_log.$(OBJEXT) store_rebuild.$(OBJEXT) \
-	store_swapin.$(OBJEXT) store_swapmeta.$(OBJEXT) \
-	store_swapout.$(OBJEXT) StoreFileSystem.$(OBJEXT) \
-	StoreIOState.$(OBJEXT) StoreMeta.$(OBJEXT) \
-	StoreMetaMD5.$(OBJEXT) StoreMetaSTD.$(OBJEXT) \
-	StoreMetaSTDLFS.$(OBJEXT) StoreMetaUnpacker.$(OBJEXT) \
-	StoreMetaURL.$(OBJEXT) StoreMetaVary.$(OBJEXT) \
-	StoreSwapLogData.$(OBJEXT) $(am__objects_32) tools.$(OBJEXT) \
-	tunnel.$(OBJEXT) SwapDir.$(OBJEXT) url.$(OBJEXT) \
-	URLScheme.$(OBJEXT) urn.$(OBJEXT) useragent.$(OBJEXT) \
-	wccp2.$(OBJEXT) whois.$(OBJEXT) $(am__objects_26) \
-	wordlist.$(OBJEXT)
+	$(am__objects_9) disk.$(OBJEXT) dlink.$(OBJEXT) \
+	$(am__objects_11) errorpage.$(OBJEXT) $(am__objects_13) \
+	ETag.$(OBJEXT) external_acl.$(OBJEXT) \
+	ExternalACLEntry.$(OBJEXT) fd.$(OBJEXT) fde.$(OBJEXT) \
+	forward.$(OBJEXT) fqdncache.$(OBJEXT) ftp.$(OBJEXT) \
+	gopher.$(OBJEXT) helper.$(OBJEXT) $(am__objects_14) \
+	http.$(OBJEXT) HttpBody.$(OBJEXT) HttpHeader.$(OBJEXT) \
+	HttpHeaderTools.$(OBJEXT) HttpHdrCc.$(OBJEXT) \
+	HttpHdrContRange.$(OBJEXT) HttpHdrRange.$(OBJEXT) \
+	HttpHdrSc.$(OBJEXT) HttpHdrScTarget.$(OBJEXT) \
+	HttpMsg.$(OBJEXT) HttpReply.$(OBJEXT) HttpStatusLine.$(OBJEXT) \
+	$(am__objects_15) icp_v2.$(OBJEXT) icp_v3.$(OBJEXT) \
+	$(am__objects_17) $(am__objects_18) ipcache.$(OBJEXT) \
+	int.$(OBJEXT) internal.$(OBJEXT) list.$(OBJEXT) \
+	logfile.$(OBJEXT) multicast.$(OBJEXT) mem_node.$(OBJEXT) \
+	MemBuf.$(OBJEXT) MemObject.$(OBJEXT) mime.$(OBJEXT) \
+	neighbors.$(OBJEXT) net_db.$(OBJEXT) Packer.$(OBJEXT) \
+	Parsing.$(OBJEXT) pconn.$(OBJEXT) peer_digest.$(OBJEXT) \
+	peer_select.$(OBJEXT) redirect.$(OBJEXT) referer.$(OBJEXT) \
+	refresh.$(OBJEXT) Server.$(OBJEXT) $(am__objects_22) \
+	$(am__objects_24) stat.$(OBJEXT) StatHist.$(OBJEXT) \
+	stmem.$(OBJEXT) store.$(OBJEXT) store_client.$(OBJEXT) \
+	store_digest.$(OBJEXT) store_dir.$(OBJEXT) store_io.$(OBJEXT) \
+	store_key_md5.$(OBJEXT) store_log.$(OBJEXT) \
+	store_rebuild.$(OBJEXT) store_swapin.$(OBJEXT) \
+	store_swapmeta.$(OBJEXT) store_swapout.$(OBJEXT) \
+	StoreFileSystem.$(OBJEXT) StoreIOState.$(OBJEXT) \
+	StoreMeta.$(OBJEXT) StoreMetaMD5.$(OBJEXT) \
+	StoreMetaSTD.$(OBJEXT) StoreMetaSTDLFS.$(OBJEXT) \
+	StoreMetaUnpacker.$(OBJEXT) StoreMetaURL.$(OBJEXT) \
+	StoreMetaVary.$(OBJEXT) StoreSwapLogData.$(OBJEXT) \
+	$(am__objects_32) tools.$(OBJEXT) tunnel.$(OBJEXT) \
+	SwapDir.$(OBJEXT) url.$(OBJEXT) URLScheme.$(OBJEXT) \
+	urn.$(OBJEXT) useragent.$(OBJEXT) wccp2.$(OBJEXT) \
+	whois.$(OBJEXT) $(am__objects_26) wordlist.$(OBJEXT)
 nodist_tests_testEvent_OBJECTS = repl_modules.$(OBJEXT) \
 	string_arrays.$(OBJEXT)
 tests_testEvent_OBJECTS = $(am_tests_testEvent_OBJECTS) \
@@ -814,40 +819,40 @@ am__tests_testEventLoop_SOURCES_DIST = debug.cc EventLoop.h \
 	DelayConfig.h DelayPool.cc DelayPool.h DelayPools.h \
 	DelaySpec.cc DelaySpec.h DelayTagged.cc DelayTagged.h \
 	DelayUser.cc DelayUser.h DelayVector.cc DelayVector.h \
-	NullDelayId.cc NullDelayId.h disk.cc dns_internal.cc dns.cc \
-	errorpage.cc ElementList.h ESI.cc ESI.h ESIAssign.cc \
-	ESIAssign.h ESIAttempt.h ESIContext.cc ESIContext.h \
-	ESICustomParser.cc ESICustomParser.h ESIElement.h ESIExcept.h \
-	ESIExpatParser.cc ESIExpatParser.h ESIExpression.cc \
-	ESIExpression.h ESIInclude.cc ESIInclude.h ESILiteral.h \
-	ESILibxml2Parser.cc ESILibxml2Parser.h ESIParser.cc \
-	ESIParser.h ESISegment.cc ESISegment.h ESISequence.cc \
-	ESISequence.h ESIVar.h ESIVarState.cc ESIVarState.h ETag.cc \
-	external_acl.cc ExternalACLEntry.cc fd.cc fde.cc forward.cc \
-	fqdncache.cc ftp.cc gopher.cc helper.cc htcp.cc htcp.h http.cc \
-	HttpBody.cc HttpHeader.cc HttpHeaderTools.cc HttpHdrCc.cc \
-	HttpHdrContRange.cc HttpHdrRange.cc HttpHdrSc.cc \
-	HttpHdrScTarget.cc HttpMsg.cc HttpReply.cc HttpStatusLine.cc \
-	ICMP.h icmp.cc ICMPConfig.h ICMPSquid.h ICMPSquid.cc icp_v2.cc \
-	icp_v3.cc ACLIdent.cc ACLIdent.h ident.cc ipc.cc ipc_win32.cc \
-	ipcache.cc int.cc internal.cc list.cc logfile.cc multicast.cc \
-	mem_node.cc MemBuf.cc MemObject.cc mime.cc neighbors.cc \
-	net_db.cc Packer.cc Parsing.cc pconn.cc peer_digest.cc \
-	peer_select.cc redirect.cc referer.cc refresh.cc Server.cc \
-	snmp_core.cc snmp_agent.cc ACLCertificateData.cc \
-	ACLCertificateData.h ACLCertificate.cc ACLCertificate.h \
-	ACLSslError.cc ACLSslError.h ACLSslErrorData.cc \
-	ACLSslErrorData.h ssl_support.cc ssl_support.h stat.cc \
-	StatHist.cc stmem.cc store.cc store_client.cc store_digest.cc \
-	store_dir.cc store_io.cc store_key_md5.cc store_log.cc \
-	store_rebuild.cc store_swapin.cc store_swapmeta.cc \
-	store_swapout.cc StoreFileSystem.cc StoreIOState.cc \
-	StoreMeta.cc StoreMetaMD5.cc StoreMetaSTD.cc \
-	StoreMetaSTDLFS.cc StoreMetaUnpacker.cc StoreMetaURL.cc \
-	StoreMetaVary.cc StoreSwapLogData.cc event.cc \
-	AsyncCallQueue.cc AsyncCall.cc tools.cc tunnel.cc SwapDir.cc \
-	url.cc URLScheme.cc urn.cc useragent.cc wccp2.cc whois.cc \
-	win32.cc wordlist.cc
+	NullDelayId.cc NullDelayId.h disk.cc dlink.h dlink.cc \
+	dns_internal.cc dns.cc errorpage.cc ElementList.h ESI.cc ESI.h \
+	ESIAssign.cc ESIAssign.h ESIAttempt.h ESIContext.cc \
+	ESIContext.h ESICustomParser.cc ESICustomParser.h ESIElement.h \
+	ESIExcept.h ESIExpatParser.cc ESIExpatParser.h \
+	ESIExpression.cc ESIExpression.h ESIInclude.cc ESIInclude.h \
+	ESILiteral.h ESILibxml2Parser.cc ESILibxml2Parser.h \
+	ESIParser.cc ESIParser.h ESISegment.cc ESISegment.h \
+	ESISequence.cc ESISequence.h ESIVar.h ESIVarState.cc \
+	ESIVarState.h ETag.cc external_acl.cc ExternalACLEntry.cc \
+	fd.cc fde.cc forward.cc fqdncache.cc ftp.cc gopher.cc \
+	helper.cc htcp.cc htcp.h http.cc HttpBody.cc HttpHeader.cc \
+	HttpHeaderTools.cc HttpHdrCc.cc HttpHdrContRange.cc \
+	HttpHdrRange.cc HttpHdrSc.cc HttpHdrScTarget.cc HttpMsg.cc \
+	HttpReply.cc HttpStatusLine.cc ICMP.h icmp.cc ICMPConfig.h \
+	ICMPSquid.h ICMPSquid.cc icp_v2.cc icp_v3.cc ACLIdent.cc \
+	ACLIdent.h ident.cc ipc.cc ipc_win32.cc ipcache.cc int.cc \
+	internal.cc list.cc logfile.cc multicast.cc mem_node.cc \
+	MemBuf.cc MemObject.cc mime.cc neighbors.cc net_db.cc \
+	Packer.cc Parsing.cc pconn.cc peer_digest.cc peer_select.cc \
+	redirect.cc referer.cc refresh.cc Server.cc snmp_core.cc \
+	snmp_agent.cc ACLCertificateData.cc ACLCertificateData.h \
+	ACLCertificate.cc ACLCertificate.h ACLSslError.cc \
+	ACLSslError.h ACLSslErrorData.cc ACLSslErrorData.h \
+	ssl_support.cc ssl_support.h stat.cc StatHist.cc stmem.cc \
+	store.cc store_client.cc store_digest.cc store_dir.cc \
+	store_io.cc store_key_md5.cc store_log.cc store_rebuild.cc \
+	store_swapin.cc store_swapmeta.cc store_swapout.cc \
+	StoreFileSystem.cc StoreIOState.cc StoreMeta.cc \
+	StoreMetaMD5.cc StoreMetaSTD.cc StoreMetaSTDLFS.cc \
+	StoreMetaUnpacker.cc StoreMetaURL.cc StoreMetaVary.cc \
+	StoreSwapLogData.cc event.cc AsyncCallQueue.cc AsyncCall.cc \
+	tools.cc tunnel.cc SwapDir.cc url.cc URLScheme.cc urn.cc \
+	useragent.cc wccp2.cc whois.cc win32.cc wordlist.cc
 am_tests_testEventLoop_OBJECTS = debug.$(OBJEXT) EventLoop.$(OBJEXT) \
 	globals.$(OBJEXT) HttpRequest.$(OBJEXT) \
 	HttpRequestMethod.$(OBJEXT) mem.$(OBJEXT) \
@@ -864,70 +869,45 @@ am_tests_testEventLoop_OBJECTS = debug.$(OBJEXT) EventLoop.$(OBJEXT) \
 	client_side.$(OBJEXT) client_side_reply.$(OBJEXT) \
 	client_side_request.$(OBJEXT) clientStream.$(OBJEXT) \
 	$(am__objects_7) ConfigOption.$(OBJEXT) ConfigParser.$(OBJEXT) \
-	$(am__objects_9) disk.$(OBJEXT) $(am__objects_11) \
-	errorpage.$(OBJEXT) $(am__objects_13) ETag.$(OBJEXT) \
-	external_acl.$(OBJEXT) ExternalACLEntry.$(OBJEXT) fd.$(OBJEXT) \
-	fde.$(OBJEXT) forward.$(OBJEXT) fqdncache.$(OBJEXT) \
-	ftp.$(OBJEXT) gopher.$(OBJEXT) helper.$(OBJEXT) \
-	$(am__objects_14) http.$(OBJEXT) HttpBody.$(OBJEXT) \
-	HttpHeader.$(OBJEXT) HttpHeaderTools.$(OBJEXT) \
-	HttpHdrCc.$(OBJEXT) HttpHdrContRange.$(OBJEXT) \
-	HttpHdrRange.$(OBJEXT) HttpHdrSc.$(OBJEXT) \
-	HttpHdrScTarget.$(OBJEXT) HttpMsg.$(OBJEXT) \
-	HttpReply.$(OBJEXT) HttpStatusLine.$(OBJEXT) $(am__objects_15) \
-	icp_v2.$(OBJEXT) icp_v3.$(OBJEXT) $(am__objects_17) \
-	$(am__objects_18) ipcache.$(OBJEXT) int.$(OBJEXT) \
-	internal.$(OBJEXT) list.$(OBJEXT) logfile.$(OBJEXT) \
-	multicast.$(OBJEXT) mem_node.$(OBJEXT) MemBuf.$(OBJEXT) \
-	MemObject.$(OBJEXT) mime.$(OBJEXT) neighbors.$(OBJEXT) \
-	net_db.$(OBJEXT) Packer.$(OBJEXT) Parsing.$(OBJEXT) \
-	pconn.$(OBJEXT) peer_digest.$(OBJEXT) peer_select.$(OBJEXT) \
-	redirect.$(OBJEXT) referer.$(OBJEXT) refresh.$(OBJEXT) \
-	Server.$(OBJEXT) $(am__objects_22) $(am__objects_24) \
-	stat.$(OBJEXT) StatHist.$(OBJEXT) stmem.$(OBJEXT) \
-	store.$(OBJEXT) store_client.$(OBJEXT) store_digest.$(OBJEXT) \
-	store_dir.$(OBJEXT) store_io.$(OBJEXT) store_key_md5.$(OBJEXT) \
-	store_log.$(OBJEXT) store_rebuild.$(OBJEXT) \
-	store_swapin.$(OBJEXT) store_swapmeta.$(OBJEXT) \
-	store_swapout.$(OBJEXT) StoreFileSystem.$(OBJEXT) \
-	StoreIOState.$(OBJEXT) StoreMeta.$(OBJEXT) \
-	StoreMetaMD5.$(OBJEXT) StoreMetaSTD.$(OBJEXT) \
-	StoreMetaSTDLFS.$(OBJEXT) StoreMetaUnpacker.$(OBJEXT) \
-	StoreMetaURL.$(OBJEXT) StoreMetaVary.$(OBJEXT) \
-	StoreSwapLogData.$(OBJEXT) $(am__objects_32) tools.$(OBJEXT) \
-	tunnel.$(OBJEXT) SwapDir.$(OBJEXT) url.$(OBJEXT) \
-	URLScheme.$(OBJEXT) urn.$(OBJEXT) useragent.$(OBJEXT) \
-	wccp2.$(OBJEXT) whois.$(OBJEXT) $(am__objects_26) \
-	wordlist.$(OBJEXT)
+	$(am__objects_9) disk.$(OBJEXT) dlink.$(OBJEXT) \
+	$(am__objects_11) errorpage.$(OBJEXT) $(am__objects_13) \
+	ETag.$(OBJEXT) external_acl.$(OBJEXT) \
+	ExternalACLEntry.$(OBJEXT) fd.$(OBJEXT) fde.$(OBJEXT) \
+	forward.$(OBJEXT) fqdncache.$(OBJEXT) ftp.$(OBJEXT) \
+	gopher.$(OBJEXT) helper.$(OBJEXT) $(am__objects_14) \
+	http.$(OBJEXT) HttpBody.$(OBJEXT) HttpHeader.$(OBJEXT) \
+	HttpHeaderTools.$(OBJEXT) HttpHdrCc.$(OBJEXT) \
+	HttpHdrContRange.$(OBJEXT) HttpHdrRange.$(OBJEXT) \
+	HttpHdrSc.$(OBJEXT) HttpHdrScTarget.$(OBJEXT) \
+	HttpMsg.$(OBJEXT) HttpReply.$(OBJEXT) HttpStatusLine.$(OBJEXT) \
+	$(am__objects_15) icp_v2.$(OBJEXT) icp_v3.$(OBJEXT) \
+	$(am__objects_17) $(am__objects_18) ipcache.$(OBJEXT) \
+	int.$(OBJEXT) internal.$(OBJEXT) list.$(OBJEXT) \
+	logfile.$(OBJEXT) multicast.$(OBJEXT) mem_node.$(OBJEXT) \
+	MemBuf.$(OBJEXT) MemObject.$(OBJEXT) mime.$(OBJEXT) \
+	neighbors.$(OBJEXT) net_db.$(OBJEXT) Packer.$(OBJEXT) \
+	Parsing.$(OBJEXT) pconn.$(OBJEXT) peer_digest.$(OBJEXT) \
+	peer_select.$(OBJEXT) redirect.$(OBJEXT) referer.$(OBJEXT) \
+	refresh.$(OBJEXT) Server.$(OBJEXT) $(am__objects_22) \
+	$(am__objects_24) stat.$(OBJEXT) StatHist.$(OBJEXT) \
+	stmem.$(OBJEXT) store.$(OBJEXT) store_client.$(OBJEXT) \
+	store_digest.$(OBJEXT) store_dir.$(OBJEXT) store_io.$(OBJEXT) \
+	store_key_md5.$(OBJEXT) store_log.$(OBJEXT) \
+	store_rebuild.$(OBJEXT) store_swapin.$(OBJEXT) \
+	store_swapmeta.$(OBJEXT) store_swapout.$(OBJEXT) \
+	StoreFileSystem.$(OBJEXT) StoreIOState.$(OBJEXT) \
+	StoreMeta.$(OBJEXT) StoreMetaMD5.$(OBJEXT) \
+	StoreMetaSTD.$(OBJEXT) StoreMetaSTDLFS.$(OBJEXT) \
+	StoreMetaUnpacker.$(OBJEXT) StoreMetaURL.$(OBJEXT) \
+	StoreMetaVary.$(OBJEXT) StoreSwapLogData.$(OBJEXT) \
+	$(am__objects_32) tools.$(OBJEXT) tunnel.$(OBJEXT) \
+	SwapDir.$(OBJEXT) url.$(OBJEXT) URLScheme.$(OBJEXT) \
+	urn.$(OBJEXT) useragent.$(OBJEXT) wccp2.$(OBJEXT) \
+	whois.$(OBJEXT) $(am__objects_26) wordlist.$(OBJEXT)
 nodist_tests_testEventLoop_OBJECTS = repl_modules.$(OBJEXT) \
 	string_arrays.$(OBJEXT)
 tests_testEventLoop_OBJECTS = $(am_tests_testEventLoop_OBJECTS) \
 	$(nodist_tests_testEventLoop_OBJECTS)
-am__objects_36 = tests/testHeader_ACL.$(OBJEXT) \
-	tests/testHeader_AsyncEngine.$(OBJEXT) \
-	tests/testHeader_cbdata.$(OBJEXT) \
-	tests/testHeader_CompletionDispatcher.$(OBJEXT) \
-	tests/testHeader_ConfigParser.$(OBJEXT) \
-	tests/testHeader_client_side_request.$(OBJEXT) \
-	tests/testHeader_comm.$(OBJEXT) \
-	tests/testHeader_dlink.$(OBJEXT) \
-	tests/testHeader_errorpage.$(OBJEXT) \
-	tests/testHeader_event.$(OBJEXT) \
-	tests/testHeader_EventLoop.$(OBJEXT) \
-	tests/testHeader_HttpHeader.$(OBJEXT) \
-	tests/testHeader_HttpHeaderRange.$(OBJEXT) \
-	tests/testHeader_HttpReply.$(OBJEXT) \
-	tests/testHeader_HttpRequestMethod.$(OBJEXT) \
-	tests/testHeader_RemovalPolicy.$(OBJEXT) \
-	tests/testHeader_SquidTime.$(OBJEXT) \
-	tests/testHeader_Store.$(OBJEXT) \
-	tests/testHeader_StoreEntryStream.$(OBJEXT) \
-	tests/testHeader_URL.$(OBJEXT) \
-	tests/testHeader_URLScheme.$(OBJEXT) \
-	tests/testHeader_wordlist.$(OBJEXT)
-am_tests_testHeaders_OBJECTS = tests/testMain.$(OBJEXT) \
-	$(am__objects_36)
-tests_testHeaders_OBJECTS = $(am_tests_testHeaders_OBJECTS)
 am__tests_testHttpRequest_SOURCES_DIST = debug.cc globals.cc \
 	HttpRequest.cc HttpRequestMethod.cc mem.cc String.cc \
 	tests/testHttpRequest.h tests/testHttpRequest.cc \
@@ -947,35 +927,36 @@ am__tests_testHttpRequest_SOURCES_DIST = debug.cc globals.cc \
 	DelayConfig.h DelayPool.cc DelayPool.h DelayPools.h \
 	DelaySpec.cc DelaySpec.h DelayTagged.cc DelayTagged.h \
 	DelayUser.cc DelayUser.h DelayVector.cc DelayVector.h \
-	NullDelayId.cc NullDelayId.h disk.cc dns_internal.cc dns.cc \
-	errorpage.cc ElementList.h ESI.cc ESI.h ESIAssign.cc \
-	ESIAssign.h ESIAttempt.h ESIContext.cc ESIContext.h \
-	ESICustomParser.cc ESICustomParser.h ESIElement.h ESIExcept.h \
-	ESIExpatParser.cc ESIExpatParser.h ESIExpression.cc \
-	ESIExpression.h ESIInclude.cc ESIInclude.h ESILiteral.h \
-	ESILibxml2Parser.cc ESILibxml2Parser.h ESIParser.cc \
-	ESIParser.h ESISegment.cc ESISegment.h ESISequence.cc \
-	ESISequence.h ESIVar.h ESIVarState.cc ESIVarState.h ETag.cc \
-	external_acl.cc ExternalACLEntry.cc fd.cc fde.cc forward.cc \
-	fqdncache.cc ftp.cc gopher.cc helper.cc htcp.cc htcp.h http.cc \
-	HttpBody.cc HttpHeader.cc HttpHeaderTools.cc HttpHdrCc.cc \
-	HttpHdrContRange.cc HttpHdrRange.cc HttpHdrSc.cc \
-	HttpHdrScTarget.cc HttpMsg.cc HttpReply.cc HttpStatusLine.cc \
-	ICMP.h icmp.cc ICMPConfig.h ICMPSquid.h ICMPSquid.cc icp_v2.cc \
-	icp_v3.cc ACLIdent.cc ACLIdent.h ident.cc ipc.cc ipc_win32.cc \
-	ipcache.cc int.cc internal.cc list.cc logfile.cc multicast.cc \
-	mem_node.cc MemBuf.cc MemObject.cc mime.cc neighbors.cc \
-	net_db.cc Packer.cc Parsing.cc pconn.cc peer_digest.cc \
-	peer_select.cc redirect.cc referer.cc refresh.cc \
-	RemovalPolicy.cc Server.cc snmp_core.cc snmp_agent.cc \
-	ACLCertificateData.cc ACLCertificateData.h ACLCertificate.cc \
-	ACLCertificate.h ACLSslError.cc ACLSslError.h \
-	ACLSslErrorData.cc ACLSslErrorData.h ssl_support.cc \
-	ssl_support.h stat.cc StatHist.cc stmem.cc store.cc \
-	store_client.cc store_digest.cc store_dir.cc store_io.cc \
-	store_key_md5.cc store_log.cc store_rebuild.cc store_swapin.cc \
-	store_swapmeta.cc store_swapout.cc StoreFileSystem.cc \
-	StoreIOState.cc StoreMeta.cc StoreMetaMD5.cc StoreMetaSTD.cc \
+	NullDelayId.cc NullDelayId.h disk.cc dlink.h dlink.cc \
+	dns_internal.cc dns.cc errorpage.cc ElementList.h ESI.cc ESI.h \
+	ESIAssign.cc ESIAssign.h ESIAttempt.h ESIContext.cc \
+	ESIContext.h ESICustomParser.cc ESICustomParser.h ESIElement.h \
+	ESIExcept.h ESIExpatParser.cc ESIExpatParser.h \
+	ESIExpression.cc ESIExpression.h ESIInclude.cc ESIInclude.h \
+	ESILiteral.h ESILibxml2Parser.cc ESILibxml2Parser.h \
+	ESIParser.cc ESIParser.h ESISegment.cc ESISegment.h \
+	ESISequence.cc ESISequence.h ESIVar.h ESIVarState.cc \
+	ESIVarState.h ETag.cc external_acl.cc ExternalACLEntry.cc \
+	fd.cc fde.cc forward.cc fqdncache.cc ftp.cc gopher.cc \
+	helper.cc htcp.cc htcp.h http.cc HttpBody.cc HttpHeader.cc \
+	HttpHeaderTools.cc HttpHdrCc.cc HttpHdrContRange.cc \
+	HttpHdrRange.cc HttpHdrSc.cc HttpHdrScTarget.cc HttpMsg.cc \
+	HttpReply.cc HttpStatusLine.cc ICMP.h icmp.cc ICMPConfig.h \
+	ICMPSquid.h ICMPSquid.cc icp_v2.cc icp_v3.cc ACLIdent.cc \
+	ACLIdent.h ident.cc ipc.cc ipc_win32.cc ipcache.cc int.cc \
+	internal.cc list.cc logfile.cc multicast.cc mem_node.cc \
+	MemBuf.cc MemObject.cc mime.cc neighbors.cc net_db.cc \
+	Packer.cc Parsing.cc pconn.cc peer_digest.cc peer_select.cc \
+	redirect.cc referer.cc refresh.cc RemovalPolicy.cc Server.cc \
+	snmp_core.cc snmp_agent.cc ACLCertificateData.cc \
+	ACLCertificateData.h ACLCertificate.cc ACLCertificate.h \
+	ACLSslError.cc ACLSslError.h ACLSslErrorData.cc \
+	ACLSslErrorData.h ssl_support.cc ssl_support.h stat.cc \
+	StatHist.cc stmem.cc store.cc store_client.cc store_digest.cc \
+	store_dir.cc store_io.cc store_key_md5.cc store_log.cc \
+	store_rebuild.cc store_swapin.cc store_swapmeta.cc \
+	store_swapout.cc StoreFileSystem.cc StoreIOState.cc \
+	StoreMeta.cc StoreMetaMD5.cc StoreMetaSTD.cc \
 	StoreMetaSTDLFS.cc StoreMetaUnpacker.cc StoreMetaURL.cc \
 	StoreMetaVary.cc StoreSwapLogData.cc event.cc \
 	AsyncCallQueue.cc AsyncCall.cc tools.cc tunnel.cc SwapDir.cc \
@@ -996,41 +977,42 @@ am_tests_testHttpRequest_OBJECTS = debug.$(OBJEXT) globals.$(OBJEXT) \
 	client_side.$(OBJEXT) client_side_reply.$(OBJEXT) \
 	client_side_request.$(OBJEXT) clientStream.$(OBJEXT) \
 	$(am__objects_7) ConfigOption.$(OBJEXT) ConfigParser.$(OBJEXT) \
-	$(am__objects_9) disk.$(OBJEXT) $(am__objects_11) \
-	errorpage.$(OBJEXT) $(am__objects_13) ETag.$(OBJEXT) \
-	external_acl.$(OBJEXT) ExternalACLEntry.$(OBJEXT) fd.$(OBJEXT) \
-	fde.$(OBJEXT) forward.$(OBJEXT) fqdncache.$(OBJEXT) \
-	ftp.$(OBJEXT) gopher.$(OBJEXT) helper.$(OBJEXT) \
-	$(am__objects_14) http.$(OBJEXT) HttpBody.$(OBJEXT) \
-	HttpHeader.$(OBJEXT) HttpHeaderTools.$(OBJEXT) \
-	HttpHdrCc.$(OBJEXT) HttpHdrContRange.$(OBJEXT) \
-	HttpHdrRange.$(OBJEXT) HttpHdrSc.$(OBJEXT) \
-	HttpHdrScTarget.$(OBJEXT) HttpMsg.$(OBJEXT) \
-	HttpReply.$(OBJEXT) HttpStatusLine.$(OBJEXT) $(am__objects_15) \
-	icp_v2.$(OBJEXT) icp_v3.$(OBJEXT) $(am__objects_17) \
-	$(am__objects_18) ipcache.$(OBJEXT) int.$(OBJEXT) \
-	internal.$(OBJEXT) list.$(OBJEXT) logfile.$(OBJEXT) \
-	multicast.$(OBJEXT) mem_node.$(OBJEXT) MemBuf.$(OBJEXT) \
-	MemObject.$(OBJEXT) mime.$(OBJEXT) neighbors.$(OBJEXT) \
-	net_db.$(OBJEXT) Packer.$(OBJEXT) Parsing.$(OBJEXT) \
-	pconn.$(OBJEXT) peer_digest.$(OBJEXT) peer_select.$(OBJEXT) \
-	redirect.$(OBJEXT) referer.$(OBJEXT) refresh.$(OBJEXT) \
-	RemovalPolicy.$(OBJEXT) Server.$(OBJEXT) $(am__objects_22) \
-	$(am__objects_24) stat.$(OBJEXT) StatHist.$(OBJEXT) \
-	stmem.$(OBJEXT) store.$(OBJEXT) store_client.$(OBJEXT) \
-	store_digest.$(OBJEXT) store_dir.$(OBJEXT) store_io.$(OBJEXT) \
-	store_key_md5.$(OBJEXT) store_log.$(OBJEXT) \
-	store_rebuild.$(OBJEXT) store_swapin.$(OBJEXT) \
-	store_swapmeta.$(OBJEXT) store_swapout.$(OBJEXT) \
-	StoreFileSystem.$(OBJEXT) StoreIOState.$(OBJEXT) \
-	StoreMeta.$(OBJEXT) StoreMetaMD5.$(OBJEXT) \
-	StoreMetaSTD.$(OBJEXT) StoreMetaSTDLFS.$(OBJEXT) \
-	StoreMetaUnpacker.$(OBJEXT) StoreMetaURL.$(OBJEXT) \
-	StoreMetaVary.$(OBJEXT) StoreSwapLogData.$(OBJEXT) \
-	$(am__objects_32) tools.$(OBJEXT) tunnel.$(OBJEXT) \
-	SwapDir.$(OBJEXT) url.$(OBJEXT) URLScheme.$(OBJEXT) \
-	urn.$(OBJEXT) useragent.$(OBJEXT) wccp2.$(OBJEXT) \
-	whois.$(OBJEXT) $(am__objects_26) wordlist.$(OBJEXT)
+	$(am__objects_9) disk.$(OBJEXT) dlink.$(OBJEXT) \
+	$(am__objects_11) errorpage.$(OBJEXT) $(am__objects_13) \
+	ETag.$(OBJEXT) external_acl.$(OBJEXT) \
+	ExternalACLEntry.$(OBJEXT) fd.$(OBJEXT) fde.$(OBJEXT) \
+	forward.$(OBJEXT) fqdncache.$(OBJEXT) ftp.$(OBJEXT) \
+	gopher.$(OBJEXT) helper.$(OBJEXT) $(am__objects_14) \
+	http.$(OBJEXT) HttpBody.$(OBJEXT) HttpHeader.$(OBJEXT) \
+	HttpHeaderTools.$(OBJEXT) HttpHdrCc.$(OBJEXT) \
+	HttpHdrContRange.$(OBJEXT) HttpHdrRange.$(OBJEXT) \
+	HttpHdrSc.$(OBJEXT) HttpHdrScTarget.$(OBJEXT) \
+	HttpMsg.$(OBJEXT) HttpReply.$(OBJEXT) HttpStatusLine.$(OBJEXT) \
+	$(am__objects_15) icp_v2.$(OBJEXT) icp_v3.$(OBJEXT) \
+	$(am__objects_17) $(am__objects_18) ipcache.$(OBJEXT) \
+	int.$(OBJEXT) internal.$(OBJEXT) list.$(OBJEXT) \
+	logfile.$(OBJEXT) multicast.$(OBJEXT) mem_node.$(OBJEXT) \
+	MemBuf.$(OBJEXT) MemObject.$(OBJEXT) mime.$(OBJEXT) \
+	neighbors.$(OBJEXT) net_db.$(OBJEXT) Packer.$(OBJEXT) \
+	Parsing.$(OBJEXT) pconn.$(OBJEXT) peer_digest.$(OBJEXT) \
+	peer_select.$(OBJEXT) redirect.$(OBJEXT) referer.$(OBJEXT) \
+	refresh.$(OBJEXT) RemovalPolicy.$(OBJEXT) Server.$(OBJEXT) \
+	$(am__objects_22) $(am__objects_24) stat.$(OBJEXT) \
+	StatHist.$(OBJEXT) stmem.$(OBJEXT) store.$(OBJEXT) \
+	store_client.$(OBJEXT) store_digest.$(OBJEXT) \
+	store_dir.$(OBJEXT) store_io.$(OBJEXT) store_key_md5.$(OBJEXT) \
+	store_log.$(OBJEXT) store_rebuild.$(OBJEXT) \
+	store_swapin.$(OBJEXT) store_swapmeta.$(OBJEXT) \
+	store_swapout.$(OBJEXT) StoreFileSystem.$(OBJEXT) \
+	StoreIOState.$(OBJEXT) StoreMeta.$(OBJEXT) \
+	StoreMetaMD5.$(OBJEXT) StoreMetaSTD.$(OBJEXT) \
+	StoreMetaSTDLFS.$(OBJEXT) StoreMetaUnpacker.$(OBJEXT) \
+	StoreMetaURL.$(OBJEXT) StoreMetaVary.$(OBJEXT) \
+	StoreSwapLogData.$(OBJEXT) $(am__objects_32) tools.$(OBJEXT) \
+	tunnel.$(OBJEXT) SwapDir.$(OBJEXT) url.$(OBJEXT) \
+	URLScheme.$(OBJEXT) urn.$(OBJEXT) useragent.$(OBJEXT) \
+	wccp2.$(OBJEXT) whois.$(OBJEXT) $(am__objects_26) \
+	wordlist.$(OBJEXT)
 nodist_tests_testHttpRequest_OBJECTS = repl_modules.$(OBJEXT) \
 	string_arrays.$(OBJEXT)
 tests_testHttpRequest_OBJECTS = $(am_tests_testHttpRequest_OBJECTS) \
@@ -1138,39 +1120,40 @@ am__tests_testURL_SOURCES_DIST = debug.cc url.cc URLScheme.cc \
 	DelayConfig.h DelayPool.cc DelayPool.h DelayPools.h \
 	DelaySpec.cc DelaySpec.h DelayTagged.cc DelayTagged.h \
 	DelayUser.cc DelayUser.h DelayVector.cc DelayVector.h \
-	NullDelayId.cc NullDelayId.h disk.cc dns_internal.cc dns.cc \
-	errorpage.cc ElementList.h ESI.cc ESI.h ESIAssign.cc \
-	ESIAssign.h ESIAttempt.h ESIContext.cc ESIContext.h \
-	ESICustomParser.cc ESICustomParser.h ESIElement.h ESIExcept.h \
-	ESIExpatParser.cc ESIExpatParser.h ESIExpression.cc \
-	ESIExpression.h ESIInclude.cc ESIInclude.h ESILiteral.h \
-	ESILibxml2Parser.cc ESILibxml2Parser.h ESIParser.cc \
-	ESIParser.h ESISegment.cc ESISegment.h ESISequence.cc \
-	ESISequence.h ESIVar.h ESIVarState.cc ESIVarState.h ETag.cc \
-	external_acl.cc ExternalACLEntry.cc fd.cc fde.cc forward.cc \
-	fqdncache.cc ftp.cc gopher.cc helper.cc htcp.cc htcp.h http.cc \
-	HttpBody.cc HttpHeader.cc HttpHeaderTools.cc HttpHdrCc.cc \
-	HttpHdrContRange.cc HttpHdrRange.cc HttpHdrSc.cc \
-	HttpHdrScTarget.cc HttpMsg.cc HttpReply.cc HttpStatusLine.cc \
-	ICMP.h icmp.cc ICMPConfig.h ICMPSquid.h ICMPSquid.cc icp_v2.cc \
-	icp_v3.cc ACLIdent.cc ACLIdent.h ident.cc ipc.cc ipc_win32.cc \
-	ipcache.cc int.cc internal.cc list.cc logfile.cc multicast.cc \
-	mem_node.cc MemBuf.cc MemObject.cc mime.cc neighbors.cc \
-	net_db.cc Packer.cc Parsing.cc pconn.cc peer_digest.cc \
-	peer_select.cc redirect.cc referer.cc refresh.cc Server.cc \
-	snmp_core.cc snmp_agent.cc ACLCertificateData.cc \
-	ACLCertificateData.h ACLCertificate.cc ACLCertificate.h \
-	ACLSslError.cc ACLSslError.h ACLSslErrorData.cc \
-	ACLSslErrorData.h ssl_support.cc ssl_support.h stat.cc \
-	StatHist.cc stmem.cc store.cc store_client.cc store_digest.cc \
-	store_dir.cc store_io.cc store_key_md5.cc store_log.cc \
-	store_rebuild.cc store_swapin.cc store_swapmeta.cc \
-	store_swapout.cc StoreFileSystem.cc StoreIOState.cc \
-	StoreMeta.cc StoreMetaMD5.cc StoreMetaSTD.cc \
-	StoreMetaSTDLFS.cc StoreMetaUnpacker.cc StoreMetaURL.cc \
-	StoreMetaVary.cc StoreSwapLogData.cc event.cc \
-	AsyncCallQueue.cc AsyncCall.cc tools.cc tunnel.cc SwapDir.cc \
-	urn.cc useragent.cc wccp2.cc whois.cc win32.cc wordlist.cc
+	NullDelayId.cc NullDelayId.h disk.cc dlink.h dlink.cc \
+	dns_internal.cc dns.cc errorpage.cc ElementList.h ESI.cc ESI.h \
+	ESIAssign.cc ESIAssign.h ESIAttempt.h ESIContext.cc \
+	ESIContext.h ESICustomParser.cc ESICustomParser.h ESIElement.h \
+	ESIExcept.h ESIExpatParser.cc ESIExpatParser.h \
+	ESIExpression.cc ESIExpression.h ESIInclude.cc ESIInclude.h \
+	ESILiteral.h ESILibxml2Parser.cc ESILibxml2Parser.h \
+	ESIParser.cc ESIParser.h ESISegment.cc ESISegment.h \
+	ESISequence.cc ESISequence.h ESIVar.h ESIVarState.cc \
+	ESIVarState.h ETag.cc external_acl.cc ExternalACLEntry.cc \
+	fd.cc fde.cc forward.cc fqdncache.cc ftp.cc gopher.cc \
+	helper.cc htcp.cc htcp.h http.cc HttpBody.cc HttpHeader.cc \
+	HttpHeaderTools.cc HttpHdrCc.cc HttpHdrContRange.cc \
+	HttpHdrRange.cc HttpHdrSc.cc HttpHdrScTarget.cc HttpMsg.cc \
+	HttpReply.cc HttpStatusLine.cc ICMP.h icmp.cc ICMPConfig.h \
+	ICMPSquid.h ICMPSquid.cc icp_v2.cc icp_v3.cc ACLIdent.cc \
+	ACLIdent.h ident.cc ipc.cc ipc_win32.cc ipcache.cc int.cc \
+	internal.cc list.cc logfile.cc multicast.cc mem_node.cc \
+	MemBuf.cc MemObject.cc mime.cc neighbors.cc net_db.cc \
+	Packer.cc Parsing.cc pconn.cc peer_digest.cc peer_select.cc \
+	redirect.cc referer.cc refresh.cc Server.cc snmp_core.cc \
+	snmp_agent.cc ACLCertificateData.cc ACLCertificateData.h \
+	ACLCertificate.cc ACLCertificate.h ACLSslError.cc \
+	ACLSslError.h ACLSslErrorData.cc ACLSslErrorData.h \
+	ssl_support.cc ssl_support.h stat.cc StatHist.cc stmem.cc \
+	store.cc store_client.cc store_digest.cc store_dir.cc \
+	store_io.cc store_key_md5.cc store_log.cc store_rebuild.cc \
+	store_swapin.cc store_swapmeta.cc store_swapout.cc \
+	StoreFileSystem.cc StoreIOState.cc StoreMeta.cc \
+	StoreMetaMD5.cc StoreMetaSTD.cc StoreMetaSTDLFS.cc \
+	StoreMetaUnpacker.cc StoreMetaURL.cc StoreMetaVary.cc \
+	StoreSwapLogData.cc event.cc AsyncCallQueue.cc AsyncCall.cc \
+	tools.cc tunnel.cc SwapDir.cc urn.cc useragent.cc wccp2.cc \
+	whois.cc win32.cc wordlist.cc
 am_tests_testURL_OBJECTS = debug.$(OBJEXT) url.$(OBJEXT) \
 	URLScheme.$(OBJEXT) globals.$(OBJEXT) HttpRequest.$(OBJEXT) \
 	HttpRequestMethod.$(OBJEXT) mem.$(OBJEXT) \
@@ -1187,40 +1170,41 @@ am_tests_testURL_OBJECTS = debug.$(OBJEXT) url.$(OBJEXT) \
 	client_side.$(OBJEXT) client_side_reply.$(OBJEXT) \
 	client_side_request.$(OBJEXT) clientStream.$(OBJEXT) \
 	$(am__objects_7) ConfigOption.$(OBJEXT) ConfigParser.$(OBJEXT) \
-	$(am__objects_9) disk.$(OBJEXT) $(am__objects_11) \
-	errorpage.$(OBJEXT) $(am__objects_13) ETag.$(OBJEXT) \
-	external_acl.$(OBJEXT) ExternalACLEntry.$(OBJEXT) fd.$(OBJEXT) \
-	fde.$(OBJEXT) forward.$(OBJEXT) fqdncache.$(OBJEXT) \
-	ftp.$(OBJEXT) gopher.$(OBJEXT) helper.$(OBJEXT) \
-	$(am__objects_14) http.$(OBJEXT) HttpBody.$(OBJEXT) \
-	HttpHeader.$(OBJEXT) HttpHeaderTools.$(OBJEXT) \
-	HttpHdrCc.$(OBJEXT) HttpHdrContRange.$(OBJEXT) \
-	HttpHdrRange.$(OBJEXT) HttpHdrSc.$(OBJEXT) \
-	HttpHdrScTarget.$(OBJEXT) HttpMsg.$(OBJEXT) \
-	HttpReply.$(OBJEXT) HttpStatusLine.$(OBJEXT) $(am__objects_15) \
-	icp_v2.$(OBJEXT) icp_v3.$(OBJEXT) $(am__objects_17) \
-	$(am__objects_18) ipcache.$(OBJEXT) int.$(OBJEXT) \
-	internal.$(OBJEXT) list.$(OBJEXT) logfile.$(OBJEXT) \
-	multicast.$(OBJEXT) mem_node.$(OBJEXT) MemBuf.$(OBJEXT) \
-	MemObject.$(OBJEXT) mime.$(OBJEXT) neighbors.$(OBJEXT) \
-	net_db.$(OBJEXT) Packer.$(OBJEXT) Parsing.$(OBJEXT) \
-	pconn.$(OBJEXT) peer_digest.$(OBJEXT) peer_select.$(OBJEXT) \
-	redirect.$(OBJEXT) referer.$(OBJEXT) refresh.$(OBJEXT) \
-	Server.$(OBJEXT) $(am__objects_22) $(am__objects_24) \
-	stat.$(OBJEXT) StatHist.$(OBJEXT) stmem.$(OBJEXT) \
-	store.$(OBJEXT) store_client.$(OBJEXT) store_digest.$(OBJEXT) \
-	store_dir.$(OBJEXT) store_io.$(OBJEXT) store_key_md5.$(OBJEXT) \
-	store_log.$(OBJEXT) store_rebuild.$(OBJEXT) \
-	store_swapin.$(OBJEXT) store_swapmeta.$(OBJEXT) \
-	store_swapout.$(OBJEXT) StoreFileSystem.$(OBJEXT) \
-	StoreIOState.$(OBJEXT) StoreMeta.$(OBJEXT) \
-	StoreMetaMD5.$(OBJEXT) StoreMetaSTD.$(OBJEXT) \
-	StoreMetaSTDLFS.$(OBJEXT) StoreMetaUnpacker.$(OBJEXT) \
-	StoreMetaURL.$(OBJEXT) StoreMetaVary.$(OBJEXT) \
-	StoreSwapLogData.$(OBJEXT) $(am__objects_32) tools.$(OBJEXT) \
-	tunnel.$(OBJEXT) SwapDir.$(OBJEXT) urn.$(OBJEXT) \
-	useragent.$(OBJEXT) wccp2.$(OBJEXT) whois.$(OBJEXT) \
-	$(am__objects_26) wordlist.$(OBJEXT)
+	$(am__objects_9) disk.$(OBJEXT) dlink.$(OBJEXT) \
+	$(am__objects_11) errorpage.$(OBJEXT) $(am__objects_13) \
+	ETag.$(OBJEXT) external_acl.$(OBJEXT) \
+	ExternalACLEntry.$(OBJEXT) fd.$(OBJEXT) fde.$(OBJEXT) \
+	forward.$(OBJEXT) fqdncache.$(OBJEXT) ftp.$(OBJEXT) \
+	gopher.$(OBJEXT) helper.$(OBJEXT) $(am__objects_14) \
+	http.$(OBJEXT) HttpBody.$(OBJEXT) HttpHeader.$(OBJEXT) \
+	HttpHeaderTools.$(OBJEXT) HttpHdrCc.$(OBJEXT) \
+	HttpHdrContRange.$(OBJEXT) HttpHdrRange.$(OBJEXT) \
+	HttpHdrSc.$(OBJEXT) HttpHdrScTarget.$(OBJEXT) \
+	HttpMsg.$(OBJEXT) HttpReply.$(OBJEXT) HttpStatusLine.$(OBJEXT) \
+	$(am__objects_15) icp_v2.$(OBJEXT) icp_v3.$(OBJEXT) \
+	$(am__objects_17) $(am__objects_18) ipcache.$(OBJEXT) \
+	int.$(OBJEXT) internal.$(OBJEXT) list.$(OBJEXT) \
+	logfile.$(OBJEXT) multicast.$(OBJEXT) mem_node.$(OBJEXT) \
+	MemBuf.$(OBJEXT) MemObject.$(OBJEXT) mime.$(OBJEXT) \
+	neighbors.$(OBJEXT) net_db.$(OBJEXT) Packer.$(OBJEXT) \
+	Parsing.$(OBJEXT) pconn.$(OBJEXT) peer_digest.$(OBJEXT) \
+	peer_select.$(OBJEXT) redirect.$(OBJEXT) referer.$(OBJEXT) \
+	refresh.$(OBJEXT) Server.$(OBJEXT) $(am__objects_22) \
+	$(am__objects_24) stat.$(OBJEXT) StatHist.$(OBJEXT) \
+	stmem.$(OBJEXT) store.$(OBJEXT) store_client.$(OBJEXT) \
+	store_digest.$(OBJEXT) store_dir.$(OBJEXT) store_io.$(OBJEXT) \
+	store_key_md5.$(OBJEXT) store_log.$(OBJEXT) \
+	store_rebuild.$(OBJEXT) store_swapin.$(OBJEXT) \
+	store_swapmeta.$(OBJEXT) store_swapout.$(OBJEXT) \
+	StoreFileSystem.$(OBJEXT) StoreIOState.$(OBJEXT) \
+	StoreMeta.$(OBJEXT) StoreMetaMD5.$(OBJEXT) \
+	StoreMetaSTD.$(OBJEXT) StoreMetaSTDLFS.$(OBJEXT) \
+	StoreMetaUnpacker.$(OBJEXT) StoreMetaURL.$(OBJEXT) \
+	StoreMetaVary.$(OBJEXT) StoreSwapLogData.$(OBJEXT) \
+	$(am__objects_32) tools.$(OBJEXT) tunnel.$(OBJEXT) \
+	SwapDir.$(OBJEXT) urn.$(OBJEXT) useragent.$(OBJEXT) \
+	wccp2.$(OBJEXT) whois.$(OBJEXT) $(am__objects_26) \
+	wordlist.$(OBJEXT)
 nodist_tests_testURL_OBJECTS = repl_modules.$(OBJEXT) \
 	string_arrays.$(OBJEXT)
 tests_testURL_OBJECTS = $(am_tests_testURL_OBJECTS) \
@@ -1281,9 +1265,9 @@ am__tests_test_http_range_SOURCES_DIST = tests/test_http_range.cc \
 	DelayPool.cc DelayPool.h DelayPools.h DelaySpec.cc DelaySpec.h \
 	DelayTagged.cc DelayTagged.h DelayUser.cc DelayUser.h \
 	DelayVector.cc DelayVector.h NullDelayId.cc NullDelayId.h \
-	disk.cc dns_internal.cc dns.cc errorpage.cc ElementList.h \
-	ESI.cc ESI.h ESIAssign.cc ESIAssign.h ESIAttempt.h \
-	ESIContext.cc ESIContext.h ESICustomParser.cc \
+	disk.cc dlink.h dlink.cc dns_internal.cc dns.cc errorpage.cc \
+	ElementList.h ESI.cc ESI.h ESIAssign.cc ESIAssign.h \
+	ESIAttempt.h ESIContext.cc ESIContext.h ESICustomParser.cc \
 	ESICustomParser.h ESIElement.h ESIExcept.h ESIExpatParser.cc \
 	ESIExpatParser.h ESIExpression.cc ESIExpression.h \
 	ESIInclude.cc ESIInclude.h ESILiteral.h ESILibxml2Parser.cc \
@@ -1328,17 +1312,17 @@ am_tests_test_http_range_OBJECTS = tests/test_http_range.$(OBJEXT) \
 	client_side_reply.$(OBJEXT) client_side_request.$(OBJEXT) \
 	clientStream.$(OBJEXT) $(am__objects_7) ConfigOption.$(OBJEXT) \
 	ConfigParser.$(OBJEXT) debug.$(OBJEXT) $(am__objects_9) \
-	disk.$(OBJEXT) $(am__objects_11) errorpage.$(OBJEXT) \
-	$(am__objects_13) ETag.$(OBJEXT) external_acl.$(OBJEXT) \
-	ExternalACLEntry.$(OBJEXT) fd.$(OBJEXT) fde.$(OBJEXT) \
-	forward.$(OBJEXT) fqdncache.$(OBJEXT) ftp.$(OBJEXT) \
-	globals.$(OBJEXT) gopher.$(OBJEXT) helper.$(OBJEXT) \
-	$(am__objects_14) http.$(OBJEXT) HttpBody.$(OBJEXT) \
-	HttpHdrCc.$(OBJEXT) HttpHdrContRange.$(OBJEXT) \
-	HttpHdrRange.$(OBJEXT) HttpHdrSc.$(OBJEXT) \
-	HttpHdrScTarget.$(OBJEXT) HttpHeader.$(OBJEXT) \
-	HttpHeaderTools.$(OBJEXT) HttpMsg.$(OBJEXT) \
-	HttpReply.$(OBJEXT) HttpRequest.$(OBJEXT) \
+	disk.$(OBJEXT) dlink.$(OBJEXT) $(am__objects_11) \
+	errorpage.$(OBJEXT) $(am__objects_13) ETag.$(OBJEXT) \
+	external_acl.$(OBJEXT) ExternalACLEntry.$(OBJEXT) fd.$(OBJEXT) \
+	fde.$(OBJEXT) forward.$(OBJEXT) fqdncache.$(OBJEXT) \
+	ftp.$(OBJEXT) globals.$(OBJEXT) gopher.$(OBJEXT) \
+	helper.$(OBJEXT) $(am__objects_14) http.$(OBJEXT) \
+	HttpBody.$(OBJEXT) HttpHdrCc.$(OBJEXT) \
+	HttpHdrContRange.$(OBJEXT) HttpHdrRange.$(OBJEXT) \
+	HttpHdrSc.$(OBJEXT) HttpHdrScTarget.$(OBJEXT) \
+	HttpHeader.$(OBJEXT) HttpHeaderTools.$(OBJEXT) \
+	HttpMsg.$(OBJEXT) HttpReply.$(OBJEXT) HttpRequest.$(OBJEXT) \
 	HttpRequestMethod.$(OBJEXT) HttpStatusLine.$(OBJEXT) \
 	$(am__objects_15) icp_v2.$(OBJEXT) icp_v3.$(OBJEXT) \
 	$(am__objects_17) int.$(OBJEXT) internal.$(OBJEXT) \
@@ -1391,16 +1375,16 @@ am__ufsdump_SOURCES_DIST = debug.cc int.cc mem.cc store_key_md5.cc \
 	DelayConfig.h DelayPool.cc DelayPool.h DelayPools.h \
 	DelaySpec.cc DelaySpec.h DelayTagged.cc DelayTagged.h \
 	DelayUser.cc DelayUser.h DelayVector.cc DelayVector.h \
-	NullDelayId.cc NullDelayId.h disk.cc dns_internal.cc dns.cc \
-	enums.h errorpage.cc errorpage.h ElementList.h ESI.cc ESI.h \
-	ESIAssign.cc ESIAssign.h ESIAttempt.h ESIContext.cc \
-	ESIContext.h ESICustomParser.cc ESICustomParser.h ESIElement.h \
-	ESIExcept.h ESIExpatParser.cc ESIExpatParser.h \
-	ESIExpression.cc ESIExpression.h ESIInclude.cc ESIInclude.h \
-	ESILiteral.h ESILibxml2Parser.cc ESILibxml2Parser.h \
-	ESIParser.cc ESIParser.h ESISegment.cc ESISegment.h \
-	ESISequence.cc ESISequence.h ESIVar.h ESIVarState.cc \
-	ESIVarState.h ETag.cc event.cc external_acl.cc \
+	NullDelayId.cc NullDelayId.h disk.cc dlink.h dlink.cc \
+	dns_internal.cc dns.cc enums.h errorpage.cc errorpage.h \
+	ElementList.h ESI.cc ESI.h ESIAssign.cc ESIAssign.h \
+	ESIAttempt.h ESIContext.cc ESIContext.h ESICustomParser.cc \
+	ESICustomParser.h ESIElement.h ESIExcept.h ESIExpatParser.cc \
+	ESIExpatParser.h ESIExpression.cc ESIExpression.h \
+	ESIInclude.cc ESIInclude.h ESILiteral.h ESILibxml2Parser.cc \
+	ESILibxml2Parser.h ESIParser.cc ESIParser.h ESISegment.cc \
+	ESISegment.h ESISequence.cc ESISequence.h ESIVar.h \
+	ESIVarState.cc ESIVarState.h ETag.cc event.cc external_acl.cc \
 	ExternalACLEntry.cc fd.cc fde.cc fde.h filemap.cc forward.cc \
 	forward.h fqdncache.cc ftp.cc gopher.cc helper.cc htcp.cc \
 	htcp.h http.cc HttpStatusLine.cc HttpHdrCc.cc HttpHdrRange.cc \
@@ -1444,14 +1428,14 @@ am_ufsdump_OBJECTS = debug.$(OBJEXT) int.$(OBJEXT) mem.$(OBJEXT) \
 	client_side.$(OBJEXT) client_side_reply.$(OBJEXT) \
 	client_side_request.$(OBJEXT) clientStream.$(OBJEXT) \
 	$(am__objects_7) ConfigOption.$(OBJEXT) $(am__objects_9) \
-	disk.$(OBJEXT) $(am__objects_11) errorpage.$(OBJEXT) \
-	$(am__objects_13) ETag.$(OBJEXT) event.$(OBJEXT) \
-	external_acl.$(OBJEXT) ExternalACLEntry.$(OBJEXT) fd.$(OBJEXT) \
-	fde.$(OBJEXT) filemap.$(OBJEXT) forward.$(OBJEXT) \
-	fqdncache.$(OBJEXT) ftp.$(OBJEXT) gopher.$(OBJEXT) \
-	helper.$(OBJEXT) $(am__objects_14) http.$(OBJEXT) \
-	HttpStatusLine.$(OBJEXT) HttpHdrCc.$(OBJEXT) \
-	HttpHdrRange.$(OBJEXT) HttpHdrSc.$(OBJEXT) \
+	disk.$(OBJEXT) dlink.$(OBJEXT) $(am__objects_11) \
+	errorpage.$(OBJEXT) $(am__objects_13) ETag.$(OBJEXT) \
+	event.$(OBJEXT) external_acl.$(OBJEXT) \
+	ExternalACLEntry.$(OBJEXT) fd.$(OBJEXT) fde.$(OBJEXT) \
+	filemap.$(OBJEXT) forward.$(OBJEXT) fqdncache.$(OBJEXT) \
+	ftp.$(OBJEXT) gopher.$(OBJEXT) helper.$(OBJEXT) \
+	$(am__objects_14) http.$(OBJEXT) HttpStatusLine.$(OBJEXT) \
+	HttpHdrCc.$(OBJEXT) HttpHdrRange.$(OBJEXT) HttpHdrSc.$(OBJEXT) \
 	HttpHdrScTarget.$(OBJEXT) HttpHdrContRange.$(OBJEXT) \
 	HttpHeader.$(OBJEXT) HttpHeaderTools.$(OBJEXT) \
 	HttpBody.$(OBJEXT) HttpMsg.$(OBJEXT) HttpReply.$(OBJEXT) \
@@ -1511,15 +1495,16 @@ SOURCES = $(ICAP_libicap_a_SOURCES) $(libAIO_a_SOURCES) \
 	$(dnsserver_SOURCES) $(pinger_SOURCES) \
 	$(nodist_pinger_SOURCES) $(recv_announce_SOURCES) \
 	$(squid_SOURCES) $(EXTRA_squid_SOURCES) \
-	$(nodist_squid_SOURCES) $(tests_testACLMaxUserIP_SOURCES) \
-	$(tests_testAuth_SOURCES) $(tests_testBoilerplate_SOURCES) \
+	$(nodist_squid_SOURCES) testHeaders.c \
+	$(tests_testACLMaxUserIP_SOURCES) $(tests_testAuth_SOURCES) \
+	$(tests_testBoilerplate_SOURCES) \
 	$(tests_testCacheManager_SOURCES) \
 	$(nodist_tests_testCacheManager_SOURCES) \
 	$(tests_testCoss_SOURCES) $(tests_testDiskIO_SOURCES) \
 	$(tests_testEvent_SOURCES) $(nodist_tests_testEvent_SOURCES) \
 	$(tests_testEventLoop_SOURCES) \
 	$(nodist_tests_testEventLoop_SOURCES) \
-	$(tests_testHeaders_SOURCES) $(tests_testHttpRequest_SOURCES) \
+	$(tests_testHttpRequest_SOURCES) \
 	$(nodist_tests_testHttpRequest_SOURCES) \
 	$(tests_testICMP_SOURCES) $(tests_testNull_SOURCES) \
 	$(tests_testStore_SOURCES) $(tests_testString_SOURCES) \
@@ -1533,15 +1518,14 @@ DIST_SOURCES = $(ICAP_libicap_a_SOURCES) $(am__libAIO_a_SOURCES_DIST) \
 	$(libsquid_la_SOURCES) $(DiskIO_DiskDaemon_diskd_SOURCES) \
 	$(cf_gen_SOURCES) $(dnsserver_SOURCES) $(pinger_SOURCES) \
 	$(recv_announce_SOURCES) $(am__squid_SOURCES_DIST) \
-	$(am__EXTRA_squid_SOURCES_DIST) \
+	$(am__EXTRA_squid_SOURCES_DIST) testHeaders.c \
 	$(tests_testACLMaxUserIP_SOURCES) $(tests_testAuth_SOURCES) \
 	$(tests_testBoilerplate_SOURCES) \
 	$(am__tests_testCacheManager_SOURCES_DIST) \
 	$(am__tests_testCoss_SOURCES_DIST) \
 	$(am__tests_testDiskIO_SOURCES_DIST) \
 	$(am__tests_testEvent_SOURCES_DIST) \
 	$(am__tests_testEventLoop_SOURCES_DIST) \
-	$(tests_testHeaders_SOURCES) \
 	$(am__tests_testHttpRequest_SOURCES_DIST) \
 	$(tests_testICMP_SOURCES) $(am__tests_testNull_SOURCES_DIST) \
 	$(am__tests_testStore_SOURCES_DIST) \
@@ -2095,6 +2079,7 @@ libsquid_la_SOURCES = \
 	IPInterception.h \
         ICAP/AsyncJob.cc \
         ICAP/AsyncJob.h \
+	SquidConfig.cc \
         TextException.cc \
         TextException.h
 
@@ -2166,6 +2151,7 @@ squid_SOURCES = \
 	disk.cc \
 	$(DISKIO_SOURCE) \
 	dlink.h \
+	dlink.cc \
 	$(DNSSOURCE) \
 	enums.h \
 	errorpage.cc \
@@ -2485,6 +2471,8 @@ ufsdump_SOURCES = \
 	defines.h \
 	$(DELAY_POOL_SOURCE) \
 	disk.cc \
+	dlink.h \
+	dlink.cc \
 	$(DNSSOURCE) \
 	enums.h \
 	errorpage.cc \
@@ -2890,6 +2878,8 @@ tests_testCacheManager_SOURCES = \
 	ConfigParser.cc \
 	$(DELAY_POOL_SOURCE) \
 	disk.cc \
+	dlink.h \
+	dlink.cc \
 	$(DNSSOURCE) \
 	errorpage.cc \
 	$(ESI_SOURCE) \
@@ -3013,6 +3003,7 @@ tests_testDiskIO_SOURCES = \
 
 tests_testDiskIO_LDADD = \
 	$(SWAP_TEST_LDADD) \
+	libsquid.la \
 	@SSLLIB@
 
 tests_testDiskIO_LDFLAGS = $(LIBADD_DL)
@@ -3062,6 +3053,8 @@ tests_testEvent_SOURCES = \
 	ConfigParser.cc \
 	$(DELAY_POOL_SOURCE) \
 	disk.cc \
+	dlink.h \
+	dlink.cc \
 	$(DNSSOURCE) \
 	errorpage.cc \
 	$(ESI_SOURCE) \
@@ -3218,6 +3211,8 @@ tests_testEventLoop_SOURCES = \
 	ConfigParser.cc \
 	$(DELAY_POOL_SOURCE) \
 	disk.cc \
+	dlink.h \
+	dlink.cc \
 	$(DNSSOURCE) \
 	errorpage.cc \
 	$(ESI_SOURCE) \
@@ -3332,39 +3327,6 @@ tests_testEventLoop_DEPENDENCIES = $(top_builddir)/lib/libmiscutil.a \
 	@SQUID_CPPUNIT_LA@ \
 	@ICAP_LIBS@
 
-HEADERS_TO_TEST = \
-	tests/testHeader_ACL.cc \
-	tests/testHeader_AsyncEngine.cc \
-	tests/testHeader_cbdata.cc \
-	tests/testHeader_CompletionDispatcher.cc \
-	tests/testHeader_ConfigParser.cc \
-	tests/testHeader_client_side_request.cc \
-	tests/testHeader_comm.cc \
-	tests/testHeader_dlink.cc \
-	tests/testHeader_errorpage.cc \
-	tests/testHeader_event.cc \
-	tests/testHeader_EventLoop.cc \
-	tests/testHeader_HttpHeader.cc \
-	tests/testHeader_HttpHeaderRange.cc \
-	tests/testHeader_HttpReply.cc \
-	tests/testHeader_HttpRequestMethod.cc \
-	tests/testHeader_RemovalPolicy.cc \
-	tests/testHeader_SquidTime.cc \
-	tests/testHeader_Store.cc \
-	tests/testHeader_StoreEntryStream.cc \
-	tests/testHeader_URL.cc \
-	tests/testHeader_URLScheme.cc \
-	tests/testHeader_wordlist.cc
-
-tests_testHeaders_SOURCES = tests/testMain.cc $(HEADERS_TO_TEST)
-tests_testHeaders_LDADD = \
-	@SQUID_CPPUNIT_LIBS@ \
-	@SSLLIB@
-
-tests_testHeaders_LDFLAGS = $(LIBADD_DL)
-tests_testHeaders_DEPENDENCIES = \
-	@SQUID_CPPUNIT_LA@
-
 tests_test_http_range_SOURCES = \
 	tests/test_http_range.cc \
 	access_log.cc \
@@ -3396,6 +3358,8 @@ tests_test_http_range_SOURCES = \
 	debug.cc \
 	$(DELAY_POOL_SOURCE) \
 	disk.cc \
+	dlink.h \
+	dlink.cc \
 	$(DNSSOURCE) \
 	errorpage.cc \
 	$(ESI_SOURCE) \
@@ -3557,6 +3521,8 @@ tests_testHttpRequest_SOURCES = \
 	ConfigParser.cc \
 	$(DELAY_POOL_SOURCE) \
 	disk.cc \
+	dlink.h \
+	dlink.cc \
 	$(DNSSOURCE) \
 	errorpage.cc \
 	$(ESI_SOURCE) \
@@ -3781,6 +3747,7 @@ tests_testString_SOURCES = \
 	time.cc 
 
 tests_testString_LDADD = \
+	libsquid.la \
 	-L../lib -lmiscutil \
 	@REGEXLIB@ \
 	@SQUID_CPPUNIT_LIBS@ \
@@ -3849,6 +3816,7 @@ tests_testUfs_SOURCES = tests/testUfs.cc \
 	$(SWAP_TEST_SOURCES)
 
 tests_testUfs_LDADD = \
+	libsquid.la \
 	$(SWAP_TEST_LDADD) \
 	@SSLLIB@
 
@@ -3926,6 +3894,8 @@ tests_testURL_SOURCES = \
 	ConfigParser.cc \
 	$(DELAY_POOL_SOURCE) \
 	disk.cc \
+	dlink.h \
+	dlink.cc \
 	$(DNSSOURCE) \
 	errorpage.cc \
 	$(ESI_SOURCE) \
@@ -4492,53 +4462,6 @@ tests/testEventLoop.$(OBJEXT): tests/$(am__dirstamp) \
 tests/testEventLoop$(EXEEXT): $(tests_testEventLoop_OBJECTS) $(tests_testEventLoop_DEPENDENCIES) tests/$(am__dirstamp)
 	@rm -f tests/testEventLoop$(EXEEXT)
 	$(CXXLINK) $(tests_testEventLoop_LDFLAGS) $(tests_testEventLoop_OBJECTS) $(tests_testEventLoop_LDADD) $(LIBS)
-tests/testHeader_ACL.$(OBJEXT): tests/$(am__dirstamp) \
-	tests/$(DEPDIR)/$(am__dirstamp)
-tests/testHeader_AsyncEngine.$(OBJEXT): tests/$(am__dirstamp) \
-	tests/$(DEPDIR)/$(am__dirstamp)
-tests/testHeader_cbdata.$(OBJEXT): tests/$(am__dirstamp) \
-	tests/$(DEPDIR)/$(am__dirstamp)
-tests/testHeader_CompletionDispatcher.$(OBJEXT):  \
-	tests/$(am__dirstamp) tests/$(DEPDIR)/$(am__dirstamp)
-tests/testHeader_ConfigParser.$(OBJEXT): tests/$(am__dirstamp) \
-	tests/$(DEPDIR)/$(am__dirstamp)
-tests/testHeader_client_side_request.$(OBJEXT): tests/$(am__dirstamp) \
-	tests/$(DEPDIR)/$(am__dirstamp)
-tests/testHeader_comm.$(OBJEXT): tests/$(am__dirstamp) \
-	tests/$(DEPDIR)/$(am__dirstamp)
-tests/testHeader_dlink.$(OBJEXT): tests/$(am__dirstamp) \
-	tests/$(DEPDIR)/$(am__dirstamp)
-tests/testHeader_errorpage.$(OBJEXT): tests/$(am__dirstamp) \
-	tests/$(DEPDIR)/$(am__dirstamp)
-tests/testHeader_event.$(OBJEXT): tests/$(am__dirstamp) \
-	tests/$(DEPDIR)/$(am__dirstamp)
-tests/testHeader_EventLoop.$(OBJEXT): tests/$(am__dirstamp) \
-	tests/$(DEPDIR)/$(am__dirstamp)
-tests/testHeader_HttpHeader.$(OBJEXT): tests/$(am__dirstamp) \
-	tests/$(DEPDIR)/$(am__dirstamp)
-tests/testHeader_HttpHeaderRange.$(OBJEXT): tests/$(am__dirstamp) \
-	tests/$(DEPDIR)/$(am__dirstamp)
-tests/testHeader_HttpReply.$(OBJEXT): tests/$(am__dirstamp) \
-	tests/$(DEPDIR)/$(am__dirstamp)
-tests/testHeader_HttpRequestMethod.$(OBJEXT): tests/$(am__dirstamp) \
-	tests/$(DEPDIR)/$(am__dirstamp)
-tests/testHeader_RemovalPolicy.$(OBJEXT): tests/$(am__dirstamp) \
-	tests/$(DEPDIR)/$(am__dirstamp)
-tests/testHeader_SquidTime.$(OBJEXT): tests/$(am__dirstamp) \
-	tests/$(DEPDIR)/$(am__dirstamp)
-tests/testHeader_Store.$(OBJEXT): tests/$(am__dirstamp) \
-	tests/$(DEPDIR)/$(am__dirstamp)
-tests/testHeader_StoreEntryStream.$(OBJEXT): tests/$(am__dirstamp) \
-	tests/$(DEPDIR)/$(am__dirstamp)
-tests/testHeader_URL.$(OBJEXT): tests/$(am__dirstamp) \
-	tests/$(DEPDIR)/$(am__dirstamp)
-tests/testHeader_URLScheme.$(OBJEXT): tests/$(am__dirstamp) \
-	tests/$(DEPDIR)/$(am__dirstamp)
-tests/testHeader_wordlist.$(OBJEXT): tests/$(am__dirstamp) \
-	tests/$(DEPDIR)/$(am__dirstamp)
-tests/testHeaders$(EXEEXT): $(tests_testHeaders_OBJECTS) $(tests_testHeaders_DEPENDENCIES) tests/$(am__dirstamp)
-	@rm -f tests/testHeaders$(EXEEXT)
-	$(CXXLINK) $(tests_testHeaders_LDFLAGS) $(tests_testHeaders_OBJECTS) $(tests_testHeaders_LDADD) $(LIBS)
 tests/testHttpRequest.$(OBJEXT): tests/$(am__dirstamp) \
 	tests/$(DEPDIR)/$(am__dirstamp)
 tests/testHttpRequestMethod.$(OBJEXT): tests/$(am__dirstamp) \
@@ -4677,28 +4600,6 @@ mostlyclean-compile:
 	-rm -f tests/testDiskIO.$(OBJEXT)
 	-rm -f tests/testEvent.$(OBJEXT)
 	-rm -f tests/testEventLoop.$(OBJEXT)
-	-rm -f tests/testHeader_ACL.$(OBJEXT)
-	-rm -f tests/testHeader_AsyncEngine.$(OBJEXT)
-	-rm -f tests/testHeader_CompletionDispatcher.$(OBJEXT)
-	-rm -f tests/testHeader_ConfigParser.$(OBJEXT)
-	-rm -f tests/testHeader_EventLoop.$(OBJEXT)
-	-rm -f tests/testHeader_HttpHeader.$(OBJEXT)
-	-rm -f tests/testHeader_HttpHeaderRange.$(OBJEXT)
-	-rm -f tests/testHeader_HttpReply.$(OBJEXT)
-	-rm -f tests/testHeader_HttpRequestMethod.$(OBJEXT)
-	-rm -f tests/testHeader_RemovalPolicy.$(OBJEXT)
-	-rm -f tests/testHeader_SquidTime.$(OBJEXT)
-	-rm -f tests/testHeader_Store.$(OBJEXT)
-	-rm -f tests/testHeader_StoreEntryStream.$(OBJEXT)
-	-rm -f tests/testHeader_URL.$(OBJEXT)
-	-rm -f tests/testHeader_URLScheme.$(OBJEXT)
-	-rm -f tests/testHeader_cbdata.$(OBJEXT)
-	-rm -f tests/testHeader_client_side_request.$(OBJEXT)
-	-rm -f tests/testHeader_comm.$(OBJEXT)
-	-rm -f tests/testHeader_dlink.$(OBJEXT)
-	-rm -f tests/testHeader_errorpage.$(OBJEXT)
-	-rm -f tests/testHeader_event.$(OBJEXT)
-	-rm -f tests/testHeader_wordlist.$(OBJEXT)
 	-rm -f tests/testHttpRequest.$(OBJEXT)
 	-rm -f tests/testHttpRequestMethod.$(OBJEXT)
 	-rm -f tests/testICMP.$(OBJEXT)
@@ -4827,6 +4728,7 @@ distclean-compile:
 @AMDEP_TRUE@@am__include@ @am__quote@./$(DEPDIR)/ProtoPort.Po@am__quote@
 @AMDEP_TRUE@@am__include@ @am__quote@./$(DEPDIR)/RemovalPolicy.Po@am__quote@
 @AMDEP_TRUE@@am__include@ @am__quote@./$(DEPDIR)/Server.Po@am__quote@
+@AMDEP_TRUE@@am__include@ @am__quote@./$(DEPDIR)/SquidConfig.Plo@am__quote@
 @AMDEP_TRUE@@am__include@ @am__quote@./$(DEPDIR)/SquidNew.Po@am__quote@
 @AMDEP_TRUE@@am__include@ @am__quote@./$(DEPDIR)/StatHist.Po@am__quote@
 @AMDEP_TRUE@@am__include@ @am__quote@./$(DEPDIR)/StoreFileSystem.Po@am__quote@
@@ -4868,6 +4770,7 @@ distclean-compile:
 @AMDEP_TRUE@@am__include@ @am__quote@./$(DEPDIR)/debug.Po@am__quote@
 @AMDEP_TRUE@@am__include@ @am__quote@./$(DEPDIR)/delay_pools.Po@am__quote@
 @AMDEP_TRUE@@am__include@ @am__quote@./$(DEPDIR)/disk.Po@am__quote@
+@AMDEP_TRUE@@am__include@ @am__quote@./$(DEPDIR)/dlink.Po@am__quote@
 @AMDEP_TRUE@@am__include@ @am__quote@./$(DEPDIR)/dns.Po@am__quote@
 @AMDEP_TRUE@@am__include@ @am__quote@./$(DEPDIR)/dns_internal.Po@am__quote@
 @AMDEP_TRUE@@am__include@ @am__quote@./$(DEPDIR)/dnsserver.Po@am__quote@
@@ -4930,6 +4833,7 @@ distclean-compile:
 @AMDEP_TRUE@@am__include@ @am__quote@./$(DEPDIR)/store_swapmeta.Po@am__quote@
 @AMDEP_TRUE@@am__include@ @am__quote@./$(DEPDIR)/store_swapout.Po@am__quote@
 @AMDEP_TRUE@@am__include@ @am__quote@./$(DEPDIR)/string_arrays.Po@am__quote@
+@AMDEP_TRUE@@am__include@ @am__quote@./$(DEPDIR)/testHeaders.Po@am__quote@
 @AMDEP_TRUE@@am__include@ @am__quote@./$(DEPDIR)/time.Po@am__quote@
 @AMDEP_TRUE@@am__include@ @am__quote@./$(DEPDIR)/tools.Po@am__quote@
 @AMDEP_TRUE@@am__include@ @am__quote@./$(DEPDIR)/tunnel.Po@am__quote@
@@ -5013,28 +4917,6 @@ distclean-compile:
 @AMDEP_TRUE@@am__include@ @am__quote@tests/$(DEPDIR)/testDiskIO.Po@am__quote@
 @AMDEP_TRUE@@am__include@ @am__quote@tests/$(DEPDIR)/testEvent.Po@am__quote@
 @AMDEP_TRUE@@am__include@ @am__quote@tests/$(DEPDIR)/testEventLoop.Po@am__quote@
-@AMDEP_TRUE@@am__include@ @am__quote@tests/$(DEPDIR)/testHeader_ACL.Po@am__quote@
-@AMDEP_TRUE@@am__include@ @am__quote@tests/$(DEPDIR)/testHeader_AsyncEngine.Po@am__quote@
-@AMDEP_TRUE@@am__include@ @am__quote@tests/$(DEPDIR)/testHeader_CompletionDispatcher.Po@am__quote@
-@AMDEP_TRUE@@am__include@ @am__quote@tests/$(DEPDIR)/testHeader_ConfigParser.Po@am__quote@
-@AMDEP_TRUE@@am__include@ @am__quote@tests/$(DEPDIR)/testHeader_EventLoop.Po@am__quote@
-@AMDEP_TRUE@@am__include@ @am__quote@tests/$(DEPDIR)/testHeader_HttpHeader.Po@am__quote@
-@AMDEP_TRUE@@am__include@ @am__quote@tests/$(DEPDIR)/testHeader_HttpHeaderRange.Po@am__quote@
-@AMDEP_TRUE@@am__include@ @am__quote@tests/$(DEPDIR)/testHeader_HttpReply.Po@am__quote@
-@AMDEP_TRUE@@am__include@ @am__quote@tests/$(DEPDIR)/testHeader_HttpRequestMethod.Po@am__quote@
-@AMDEP_TRUE@@am__include@ @am__quote@tests/$(DEPDIR)/testHeader_RemovalPolicy.Po@am__quote@
-@AMDEP_TRUE@@am__include@ @am__quote@tests/$(DEPDIR)/testHeader_SquidTime.Po@am__quote@
-@AMDEP_TRUE@@am__include@ @am__quote@tests/$(DEPDIR)/testHeader_Store.Po@am__quote@
-@AMDEP_TRUE@@am__include@ @am__quote@tests/$(DEPDIR)/testHeader_StoreEntryStream.Po@am__quote@
-@AMDEP_TRUE@@am__include@ @am__quote@tests/$(DEPDIR)/testHeader_URL.Po@am__quote@
-@AMDEP_TRUE@@am__include@ @am__quote@tests/$(DEPDIR)/testHeader_URLScheme.Po@am__quote@
-@AMDEP_TRUE@@am__include@ @am__quote@tests/$(DEPDIR)/testHeader_cbdata.Po@am__quote@
-@AMDEP_TRUE@@am__include@ @am__quote@tests/$(DEPDIR)/testHeader_client_side_request.Po@am__quote@
-@AMDEP_TRUE@@am__include@ @am__quote@tests/$(DEPDIR)/testHeader_comm.Po@am__quote@
-@AMDEP_TRUE@@am__include@ @am__quote@tests/$(DEPDIR)/testHeader_dlink.Po@am__quote@
-@AMDEP_TRUE@@am__include@ @am__quote@tests/$(DEPDIR)/testHeader_errorpage.Po@am__quote@
-@AMDEP_TRUE@@am__include@ @am__quote@tests/$(DEPDIR)/testHeader_event.Po@am__quote@
-@AMDEP_TRUE@@am__include@ @am__quote@tests/$(DEPDIR)/testHeader_wordlist.Po@am__quote@
 @AMDEP_TRUE@@am__include@ @am__quote@tests/$(DEPDIR)/testHttpRequest.Po@am__quote@
 @AMDEP_TRUE@@am__include@ @am__quote@tests/$(DEPDIR)/testHttpRequestMethod.Po@am__quote@
 @AMDEP_TRUE@@am__include@ @am__quote@tests/$(DEPDIR)/testICMP.Po@am__quote@
@@ -5619,6 +5501,11 @@ uninstall-local:
 		echo "rm -f $(DESTDIR)$(DEFAULT_MIME_TABLE)"; \
 		$(RM) -f $(DESTDIR)$(DEFAULT_MIME_TABLE); \
 	fi
+
+testHeaders: *.h DiskIO/*.h ICAP/*.h
+	../test-suite/testheaders.sh "$(CXXCOMPILE)" "." || exit 1
+	../test-suite/testheaders.sh "$(CXXCOMPILE)" "DiskIO" || exit 1
+	../test-suite/testheaders.sh "$(CXXCOMPILE)" "ICAP" || exit 1
 # Tell versions [3.59,3.63) of GNU make to not export all variables.
 # Otherwise a system limit (for SysV at least) may be exceeded.
 .NOEXPORT:
@@ -36,6 +36,7 @@ PRE_UNINSTALL = :
 POST_UNINSTALL = :
 build_triplet = @build@
 host_triplet = @host@
+check_PROGRAMS = testHeaders$(EXEEXT)
 subdir = src/auth
 DIST_COMMON = $(srcdir)/Makefile.am $(srcdir)/Makefile.in
 ACLOCAL_M4 = $(top_srcdir)/aclocal.m4
@@ -66,17 +67,12 @@ libntlm_a_AR = $(AR) $(ARFLAGS)
 libntlm_a_LIBADD =
 am_libntlm_a_OBJECTS = ntlm/auth_ntlm.$(OBJEXT)
 libntlm_a_OBJECTS = $(am_libntlm_a_OBJECTS)
+testHeaders_SOURCES = testHeaders.c
+testHeaders_OBJECTS = testHeaders.$(OBJEXT)
+testHeaders_LDADD = $(LDADD)
 DEFAULT_INCLUDES = -I. -I$(srcdir) -I$(top_builddir)/include
 depcomp = $(SHELL) $(top_srcdir)/cfgaux/depcomp
 am__depfiles_maybe = depfiles
-CXXCOMPILE = $(CXX) $(DEFS) $(DEFAULT_INCLUDES) $(INCLUDES) \
-	$(AM_CPPFLAGS) $(CPPFLAGS) $(AM_CXXFLAGS) $(CXXFLAGS)
-LTCXXCOMPILE = $(LIBTOOL) --tag=CXX --mode=compile $(CXX) $(DEFS) \
-	$(DEFAULT_INCLUDES) $(INCLUDES) $(AM_CPPFLAGS) $(CPPFLAGS) \
-	$(AM_CXXFLAGS) $(CXXFLAGS)
-CXXLD = $(CXX)
-CXXLINK = $(LIBTOOL) --tag=CXX --mode=link $(CXXLD) $(AM_CXXFLAGS) \
-	$(CXXFLAGS) $(AM_LDFLAGS) $(LDFLAGS) -o $@
 COMPILE = $(CC) $(DEFS) $(DEFAULT_INCLUDES) $(INCLUDES) $(AM_CPPFLAGS) \
 	$(CPPFLAGS) $(AM_CFLAGS) $(CFLAGS)
 LTCOMPILE = $(LIBTOOL) --tag=CC --mode=compile $(CC) $(DEFS) \
@@ -85,10 +81,18 @@ LTCOMPILE = $(LIBTOOL) --tag=CC --mode=compile $(CC) $(DEFS) \
 CCLD = $(CC)
 LINK = $(LIBTOOL) --tag=CC --mode=link $(CCLD) $(AM_CFLAGS) $(CFLAGS) \
 	$(AM_LDFLAGS) $(LDFLAGS) -o $@
+CXXCOMPILE = $(CXX) $(DEFS) $(DEFAULT_INCLUDES) $(INCLUDES) \
+	$(AM_CPPFLAGS) $(CPPFLAGS) $(AM_CXXFLAGS) $(CXXFLAGS)
+LTCXXCOMPILE = $(LIBTOOL) --tag=CXX --mode=compile $(CXX) $(DEFS) \
+	$(DEFAULT_INCLUDES) $(INCLUDES) $(AM_CPPFLAGS) $(CPPFLAGS) \
+	$(AM_CXXFLAGS) $(CXXFLAGS)
+CXXLD = $(CXX)
+CXXLINK = $(LIBTOOL) --tag=CXX --mode=link $(CXXLD) $(AM_CXXFLAGS) \
+	$(CXXFLAGS) $(AM_LDFLAGS) $(LDFLAGS) -o $@
 SOURCES = $(libbasic_a_SOURCES) $(libdigest_a_SOURCES) \
-	$(libnegotiate_a_SOURCES) $(libntlm_a_SOURCES)
+	$(libnegotiate_a_SOURCES) $(libntlm_a_SOURCES) testHeaders.c
 DIST_SOURCES = $(libbasic_a_SOURCES) $(libdigest_a_SOURCES) \
-	$(libnegotiate_a_SOURCES) $(libntlm_a_SOURCES)
+	$(libnegotiate_a_SOURCES) $(libntlm_a_SOURCES) testHeaders.c
 ETAGS = etags
 CTAGS = ctags
 DISTFILES = $(DIST_COMMON) $(DIST_SOURCES) $(TEXINFOS) $(EXTRA_DIST)
@@ -329,7 +333,7 @@ INCLUDES = -I. -I$(top_builddir)/include -I$(top_srcdir)/include \
 all: all-am
 
 .SUFFIXES:
-.SUFFIXES: .cc .lo .o .obj
+.SUFFIXES: .c .cc .lo .o .obj
 $(srcdir)/Makefile.in: @MAINTAINER_MODE_TRUE@ $(srcdir)/Makefile.am  $(am__configure_deps)
 	@for dep in $?; do \
 	  case '$(am__configure_deps)' in \
@@ -413,6 +417,13 @@ libntlm.a: $(libntlm_a_OBJECTS) $(libntlm_a_DEPENDENCIES)
 	$(libntlm_a_AR) libntlm.a $(libntlm_a_OBJECTS) $(libntlm_a_LIBADD)
 	$(RANLIB) libntlm.a
 
+clean-checkPROGRAMS:
+	@list='$(check_PROGRAMS)'; for p in $$list; do \
+	  f=`echo $$p|sed 's/$(EXEEXT)$$//'`; \
+	  echo " rm -f $$p $$f"; \
+	  rm -f $$p $$f ; \
+	done
+
 mostlyclean-compile:
 	-rm -f *.$(OBJEXT)
 	-rm -f basic/auth_basic.$(OBJEXT)
@@ -424,12 +435,37 @@ mostlyclean-compile:
 distclean-compile:
 	-rm -f *.tab.c
 
+@AMDEP_TRUE@@am__include@ @am__quote@./$(DEPDIR)/testHeaders.Po@am__quote@
 @AMDEP_TRUE@@am__include@ @am__quote@basic/$(DEPDIR)/auth_basic.Po@am__quote@
 @AMDEP_TRUE@@am__include@ @am__quote@digest/$(DEPDIR)/auth_digest.Po@am__quote@
 @AMDEP_TRUE@@am__include@ @am__quote@negotiate/$(DEPDIR)/auth_negotiate.Po@am__quote@
 @AMDEP_TRUE@@am__include@ @am__quote@negotiate/$(DEPDIR)/negotiateScheme.Po@am__quote@
 @AMDEP_TRUE@@am__include@ @am__quote@ntlm/$(DEPDIR)/auth_ntlm.Po@am__quote@
 
+.c.o:
+@am__fastdepCC_TRUE@	depbase=`echo $@ | sed 's|[^/]*$$|$(DEPDIR)/&|;s|\.o$$||'`; \
+@am__fastdepCC_TRUE@	if $(COMPILE) -MT $@ -MD -MP -MF "$$depbase.Tpo" -c -o $@ $<; \
+@am__fastdepCC_TRUE@	then mv -f "$$depbase.Tpo" "$$depbase.Po"; else rm -f "$$depbase.Tpo"; exit 1; fi
+@AMDEP_TRUE@@am__fastdepCC_FALSE@	source='$<' object='$@' libtool=no @AMDEPBACKSLASH@
+@AMDEP_TRUE@@am__fastdepCC_FALSE@	DEPDIR=$(DEPDIR) $(CCDEPMODE) $(depcomp) @AMDEPBACKSLASH@
+@am__fastdepCC_FALSE@	$(COMPILE) -c -o $@ $<
+
+.c.obj:
+@am__fastdepCC_TRUE@	depbase=`echo $@ | sed 's|[^/]*$$|$(DEPDIR)/&|;s|\.obj$$||'`; \
+@am__fastdepCC_TRUE@	if $(COMPILE) -MT $@ -MD -MP -MF "$$depbase.Tpo" -c -o $@ `$(CYGPATH_W) '$<'`; \
+@am__fastdepCC_TRUE@	then mv -f "$$depbase.Tpo" "$$depbase.Po"; else rm -f "$$depbase.Tpo"; exit 1; fi
+@AMDEP_TRUE@@am__fastdepCC_FALSE@	source='$<' object='$@' libtool=no @AMDEPBACKSLASH@
+@AMDEP_TRUE@@am__fastdepCC_FALSE@	DEPDIR=$(DEPDIR) $(CCDEPMODE) $(depcomp) @AMDEPBACKSLASH@
+@am__fastdepCC_FALSE@	$(COMPILE) -c -o $@ `$(CYGPATH_W) '$<'`
+
+.c.lo:
+@am__fastdepCC_TRUE@	depbase=`echo $@ | sed 's|[^/]*$$|$(DEPDIR)/&|;s|\.lo$$||'`; \
+@am__fastdepCC_TRUE@	if $(LTCOMPILE) -MT $@ -MD -MP -MF "$$depbase.Tpo" -c -o $@ $<; \
+@am__fastdepCC_TRUE@	then mv -f "$$depbase.Tpo" "$$depbase.Plo"; else rm -f "$$depbase.Tpo"; exit 1; fi
+@AMDEP_TRUE@@am__fastdepCC_FALSE@	source='$<' object='$@' libtool=yes @AMDEPBACKSLASH@
+@AMDEP_TRUE@@am__fastdepCC_FALSE@	DEPDIR=$(DEPDIR) $(CCDEPMODE) $(depcomp) @AMDEPBACKSLASH@
+@am__fastdepCC_FALSE@	$(LTCOMPILE) -c -o $@ $<
+
 .cc.o:
 @am__fastdepCXX_TRUE@	depbase=`echo $@ | sed 's|[^/]*$$|$(DEPDIR)/&|;s|\.o$$||'`; \
 @am__fastdepCXX_TRUE@	if $(CXXCOMPILE) -MT $@ -MD -MP -MF "$$depbase.Tpo" -c -o $@ $<; \
@@ -540,6 +576,7 @@ distdir: $(DISTFILES)
 	  fi; \
 	done
 check-am: all-am
+	$(MAKE) $(AM_MAKEFLAGS) $(check_PROGRAMS)
 check: check-am
 all-am: Makefile $(LIBRARIES)
 installdirs:
@@ -577,11 +614,11 @@ maintainer-clean-generic:
 	@echo "it deletes files that may require special tools to rebuild."
 clean: clean-am
 
-clean-am: clean-generic clean-libtool clean-noinstLIBRARIES \
-	mostlyclean-am
+clean-am: clean-checkPROGRAMS clean-generic clean-libtool \
+	clean-noinstLIBRARIES mostlyclean-am
 
 distclean: distclean-am
-	-rm -rf basic/$(DEPDIR) digest/$(DEPDIR) negotiate/$(DEPDIR) ntlm/$(DEPDIR)
+	-rm -rf ./$(DEPDIR) basic/$(DEPDIR) digest/$(DEPDIR) negotiate/$(DEPDIR) ntlm/$(DEPDIR)
 	-rm -f Makefile
 distclean-am: clean-am distclean-compile distclean-generic \
 	distclean-libtool distclean-tags
@@ -607,7 +644,7 @@ install-man:
 installcheck-am:
 
 maintainer-clean: maintainer-clean-am
-	-rm -rf basic/$(DEPDIR) digest/$(DEPDIR) negotiate/$(DEPDIR) ntlm/$(DEPDIR)
+	-rm -rf ./$(DEPDIR) basic/$(DEPDIR) digest/$(DEPDIR) negotiate/$(DEPDIR) ntlm/$(DEPDIR)
 	-rm -f Makefile
 maintainer-clean-am: distclean-am maintainer-clean-generic
 
@@ -626,18 +663,24 @@ ps-am:
 
 uninstall-am: uninstall-info-am
 
-.PHONY: CTAGS GTAGS all all-am check check-am clean clean-generic \
-	clean-libtool clean-noinstLIBRARIES ctags distclean \
-	distclean-compile distclean-generic distclean-libtool \
-	distclean-tags distdir dvi dvi-am html html-am info info-am \
-	install install-am install-data install-data-am install-exec \
-	install-exec-am install-info install-info-am install-man \
-	install-strip installcheck installcheck-am installdirs \
-	maintainer-clean maintainer-clean-generic mostlyclean \
-	mostlyclean-compile mostlyclean-generic mostlyclean-libtool \
-	pdf pdf-am ps ps-am tags uninstall uninstall-am \
-	uninstall-info-am
-
+.PHONY: CTAGS GTAGS all all-am check check-am clean \
+	clean-checkPROGRAMS clean-generic clean-libtool \
+	clean-noinstLIBRARIES ctags distclean distclean-compile \
+	distclean-generic distclean-libtool distclean-tags distdir dvi \
+	dvi-am html html-am info info-am install install-am \
+	install-data install-data-am install-exec install-exec-am \
+	install-info install-info-am install-man install-strip \
+	installcheck installcheck-am installdirs maintainer-clean \
+	maintainer-clean-generic mostlyclean mostlyclean-compile \
+	mostlyclean-generic mostlyclean-libtool pdf pdf-am ps ps-am \
+	tags uninstall uninstall-am uninstall-info-am
+
+
+testHeaders: basic/*.h digest/*.h ntlm/*.h negotiate/*.h
+	../../test-suite/testheaders.sh "$(CXXCOMPILE)" "basic" || exit 1
+	../../test-suite/testheaders.sh "$(CXXCOMPILE)" "digest" || exit 1
+	../../test-suite/testheaders.sh "$(CXXCOMPILE)" "ntlm" || exit 1
+	../../test-suite/testheaders.sh "$(CXXCOMPILE)" "negotiate" || exit 1
 # Tell versions [3.59,3.63) of GNU make to not export all variables.
 # Otherwise a system limit (for SysV at least) may be exceeded.
 .NOEXPORT:
@@ -41,6 +41,7 @@ PRE_UNINSTALL = :
 POST_UNINSTALL = :
 build_triplet = @build@
 host_triplet = @host@
+check_PROGRAMS = testHeaders$(EXEEXT)
 subdir = src/fs
 DIST_COMMON = $(srcdir)/Makefile.am $(srcdir)/Makefile.in
 ACLOCAL_M4 = $(top_srcdir)/aclocal.m4
@@ -64,17 +65,12 @@ libufs_a_LIBADD =
 am_libufs_a_OBJECTS = ufs/store_dir_ufs.$(OBJEXT) \
 	ufs/store_io_ufs.$(OBJEXT) ufs/ufscommon.$(OBJEXT)
 libufs_a_OBJECTS = $(am_libufs_a_OBJECTS)
+testHeaders_SOURCES = testHeaders.c
+testHeaders_OBJECTS = testHeaders.$(OBJEXT)
+testHeaders_LDADD = $(LDADD)
 DEFAULT_INCLUDES = -I. -I$(srcdir) -I$(top_builddir)/include
 depcomp = $(SHELL) $(top_srcdir)/cfgaux/depcomp
 am__depfiles_maybe = depfiles
-CXXCOMPILE = $(CXX) $(DEFS) $(DEFAULT_INCLUDES) $(INCLUDES) \
-	$(AM_CPPFLAGS) $(CPPFLAGS) $(AM_CXXFLAGS) $(CXXFLAGS)
-LTCXXCOMPILE = $(LIBTOOL) --tag=CXX --mode=compile $(CXX) $(DEFS) \
-	$(DEFAULT_INCLUDES) $(INCLUDES) $(AM_CPPFLAGS) $(CPPFLAGS) \
-	$(AM_CXXFLAGS) $(CXXFLAGS)
-CXXLD = $(CXX)
-CXXLINK = $(LIBTOOL) --tag=CXX --mode=link $(CXXLD) $(AM_CXXFLAGS) \
-	$(CXXFLAGS) $(AM_LDFLAGS) $(LDFLAGS) -o $@
 COMPILE = $(CC) $(DEFS) $(DEFAULT_INCLUDES) $(INCLUDES) $(AM_CPPFLAGS) \
 	$(CPPFLAGS) $(AM_CFLAGS) $(CFLAGS)
 LTCOMPILE = $(LIBTOOL) --tag=CC --mode=compile $(CC) $(DEFS) \
@@ -83,8 +79,16 @@ LTCOMPILE = $(LIBTOOL) --tag=CC --mode=compile $(CC) $(DEFS) \
 CCLD = $(CC)
 LINK = $(LIBTOOL) --tag=CC --mode=link $(CCLD) $(AM_CFLAGS) $(CFLAGS) \
 	$(AM_LDFLAGS) $(LDFLAGS) -o $@
-SOURCES = $(libcoss_a_SOURCES) $(libufs_a_SOURCES)
-DIST_SOURCES = $(libcoss_a_SOURCES) $(libufs_a_SOURCES)
+CXXCOMPILE = $(CXX) $(DEFS) $(DEFAULT_INCLUDES) $(INCLUDES) \
+	$(AM_CPPFLAGS) $(CPPFLAGS) $(AM_CXXFLAGS) $(CXXFLAGS)
+LTCXXCOMPILE = $(LIBTOOL) --tag=CXX --mode=compile $(CXX) $(DEFS) \
+	$(DEFAULT_INCLUDES) $(INCLUDES) $(AM_CPPFLAGS) $(CPPFLAGS) \
+	$(AM_CXXFLAGS) $(CXXFLAGS)
+CXXLD = $(CXX)
+CXXLINK = $(LIBTOOL) --tag=CXX --mode=link $(CXXLD) $(AM_CXXFLAGS) \
+	$(CXXFLAGS) $(AM_LDFLAGS) $(LDFLAGS) -o $@
+SOURCES = $(libcoss_a_SOURCES) $(libufs_a_SOURCES) testHeaders.c
+DIST_SOURCES = $(libcoss_a_SOURCES) $(libufs_a_SOURCES) testHeaders.c
 ETAGS = etags
 CTAGS = ctags
 DISTFILES = $(DIST_COMMON) $(DIST_SOURCES) $(TEXINFOS) $(EXTRA_DIST)
@@ -332,7 +336,7 @@ INCLUDES = -I. -I$(top_builddir)/include -I$(top_srcdir)/include \
 all: all-am
 
 .SUFFIXES:
-.SUFFIXES: .cc .lo .o .obj
+.SUFFIXES: .c .cc .lo .o .obj
 $(srcdir)/Makefile.in: @MAINTAINER_MODE_TRUE@ $(srcdir)/Makefile.am  $(am__configure_deps)
 	@for dep in $?; do \
 	  case '$(am__configure_deps)' in \
@@ -396,6 +400,13 @@ libufs.a: $(libufs_a_OBJECTS) $(libufs_a_DEPENDENCIES)
 	$(libufs_a_AR) libufs.a $(libufs_a_OBJECTS) $(libufs_a_LIBADD)
 	$(RANLIB) libufs.a
 
+clean-checkPROGRAMS:
+	@list='$(check_PROGRAMS)'; for p in $$list; do \
+	  f=`echo $$p|sed 's/$(EXEEXT)$$//'`; \
+	  echo " rm -f $$p $$f"; \
+	  rm -f $$p $$f ; \
+	done
+
 mostlyclean-compile:
 	-rm -f *.$(OBJEXT)
 	-rm -f coss/store_dir_coss.$(OBJEXT)
@@ -407,12 +418,37 @@ mostlyclean-compile:
 distclean-compile:
 	-rm -f *.tab.c
 
+@AMDEP_TRUE@@am__include@ @am__quote@./$(DEPDIR)/testHeaders.Po@am__quote@
 @AMDEP_TRUE@@am__include@ @am__quote@coss/$(DEPDIR)/store_dir_coss.Po@am__quote@
 @AMDEP_TRUE@@am__include@ @am__quote@coss/$(DEPDIR)/store_io_coss.Po@am__quote@
 @AMDEP_TRUE@@am__include@ @am__quote@ufs/$(DEPDIR)/store_dir_ufs.Po@am__quote@
 @AMDEP_TRUE@@am__include@ @am__quote@ufs/$(DEPDIR)/store_io_ufs.Po@am__quote@
 @AMDEP_TRUE@@am__include@ @am__quote@ufs/$(DEPDIR)/ufscommon.Po@am__quote@
 
+.c.o:
+@am__fastdepCC_TRUE@	depbase=`echo $@ | sed 's|[^/]*$$|$(DEPDIR)/&|;s|\.o$$||'`; \
+@am__fastdepCC_TRUE@	if $(COMPILE) -MT $@ -MD -MP -MF "$$depbase.Tpo" -c -o $@ $<; \
+@am__fastdepCC_TRUE@	then mv -f "$$depbase.Tpo" "$$depbase.Po"; else rm -f "$$depbase.Tpo"; exit 1; fi
+@AMDEP_TRUE@@am__fastdepCC_FALSE@	source='$<' object='$@' libtool=no @AMDEPBACKSLASH@
+@AMDEP_TRUE@@am__fastdepCC_FALSE@	DEPDIR=$(DEPDIR) $(CCDEPMODE) $(depcomp) @AMDEPBACKSLASH@
+@am__fastdepCC_FALSE@	$(COMPILE) -c -o $@ $<
+
+.c.obj:
+@am__fastdepCC_TRUE@	depbase=`echo $@ | sed 's|[^/]*$$|$(DEPDIR)/&|;s|\.obj$$||'`; \
+@am__fastdepCC_TRUE@	if $(COMPILE) -MT $@ -MD -MP -MF "$$depbase.Tpo" -c -o $@ `$(CYGPATH_W) '$<'`; \
+@am__fastdepCC_TRUE@	then mv -f "$$depbase.Tpo" "$$depbase.Po"; else rm -f "$$depbase.Tpo"; exit 1; fi
+@AMDEP_TRUE@@am__fastdepCC_FALSE@	source='$<' object='$@' libtool=no @AMDEPBACKSLASH@
+@AMDEP_TRUE@@am__fastdepCC_FALSE@	DEPDIR=$(DEPDIR) $(CCDEPMODE) $(depcomp) @AMDEPBACKSLASH@
+@am__fastdepCC_FALSE@	$(COMPILE) -c -o $@ `$(CYGPATH_W) '$<'`
+
+.c.lo:
+@am__fastdepCC_TRUE@	depbase=`echo $@ | sed 's|[^/]*$$|$(DEPDIR)/&|;s|\.lo$$||'`; \
+@am__fastdepCC_TRUE@	if $(LTCOMPILE) -MT $@ -MD -MP -MF "$$depbase.Tpo" -c -o $@ $<; \
+@am__fastdepCC_TRUE@	then mv -f "$$depbase.Tpo" "$$depbase.Plo"; else rm -f "$$depbase.Tpo"; exit 1; fi
+@AMDEP_TRUE@@am__fastdepCC_FALSE@	source='$<' object='$@' libtool=yes @AMDEPBACKSLASH@
+@AMDEP_TRUE@@am__fastdepCC_FALSE@	DEPDIR=$(DEPDIR) $(CCDEPMODE) $(depcomp) @AMDEPBACKSLASH@
+@am__fastdepCC_FALSE@	$(LTCOMPILE) -c -o $@ $<
+
 .cc.o:
 @am__fastdepCXX_TRUE@	depbase=`echo $@ | sed 's|[^/]*$$|$(DEPDIR)/&|;s|\.o$$||'`; \
 @am__fastdepCXX_TRUE@	if $(CXXCOMPILE) -MT $@ -MD -MP -MF "$$depbase.Tpo" -c -o $@ $<; \
@@ -524,6 +560,7 @@ distdir: $(DISTFILES)
 	  fi; \
 	done
 check-am: all-am
+	$(MAKE) $(AM_MAKEFLAGS) $(check_PROGRAMS)
 check: check-am
 all-am: Makefile $(LIBRARIES)
 installdirs:
@@ -557,11 +594,11 @@ maintainer-clean-generic:
 	@echo "it deletes files that may require special tools to rebuild."
 clean: clean-am
 
-clean-am: clean-generic clean-libtool clean-noinstLIBRARIES \
-	mostlyclean-am
+clean-am: clean-checkPROGRAMS clean-generic clean-libtool \
+	clean-noinstLIBRARIES mostlyclean-am
 
 distclean: distclean-am
-	-rm -rf coss/$(DEPDIR) ufs/$(DEPDIR)
+	-rm -rf ./$(DEPDIR) coss/$(DEPDIR) ufs/$(DEPDIR)
 	-rm -f Makefile
 distclean-am: clean-am distclean-compile distclean-generic \
 	distclean-libtool distclean-tags
@@ -587,7 +624,7 @@ install-man:
 installcheck-am:
 
 maintainer-clean: maintainer-clean-am
-	-rm -rf coss/$(DEPDIR) ufs/$(DEPDIR)
+	-rm -rf ./$(DEPDIR) coss/$(DEPDIR) ufs/$(DEPDIR)
 	-rm -f Makefile
 maintainer-clean-am: distclean-am maintainer-clean-generic
 
@@ -606,18 +643,22 @@ ps-am:
 
 uninstall-am: uninstall-info-am
 
-.PHONY: CTAGS GTAGS all all-am check check-am clean clean-generic \
-	clean-libtool clean-noinstLIBRARIES ctags distclean \
-	distclean-compile distclean-generic distclean-libtool \
-	distclean-tags distdir dvi dvi-am html html-am info info-am \
-	install install-am install-data install-data-am install-exec \
-	install-exec-am install-info install-info-am install-man \
-	install-strip installcheck installcheck-am installdirs \
-	maintainer-clean maintainer-clean-generic mostlyclean \
-	mostlyclean-compile mostlyclean-generic mostlyclean-libtool \
-	pdf pdf-am ps ps-am tags uninstall uninstall-am \
-	uninstall-info-am
-
+.PHONY: CTAGS GTAGS all all-am check check-am clean \
+	clean-checkPROGRAMS clean-generic clean-libtool \
+	clean-noinstLIBRARIES ctags distclean distclean-compile \
+	distclean-generic distclean-libtool distclean-tags distdir dvi \
+	dvi-am html html-am info info-am install install-am \
+	install-data install-data-am install-exec install-exec-am \
+	install-info install-info-am install-man install-strip \
+	installcheck installcheck-am installdirs maintainer-clean \
+	maintainer-clean-generic mostlyclean mostlyclean-compile \
+	mostlyclean-generic mostlyclean-libtool pdf pdf-am ps ps-am \
+	tags uninstall uninstall-am uninstall-info-am
+
+
+testHeaders: ufs/*.h coss/*.h
+	../../test-suite/testheaders.sh "$(CXXCOMPILE)" "ufs" || exit 1
+	../../test-suite/testheaders.sh "$(CXXCOMPILE)" "coss" || exit 1
 
 coss/all: libcoss.a
 coss/clean: clean
@@ -41,6 +41,7 @@ PRE_UNINSTALL = :
 POST_UNINSTALL = :
 build_triplet = @build@
 host_triplet = @host@
+check_PROGRAMS = testHeaders$(EXEEXT)
 subdir = src/repl
 DIST_COMMON = $(srcdir)/Makefile.am $(srcdir)/Makefile.in
 ACLOCAL_M4 = $(top_srcdir)/aclocal.m4
@@ -63,17 +64,12 @@ liblru_a_AR = $(AR) $(ARFLAGS)
 liblru_a_LIBADD =
 am_liblru_a_OBJECTS = lru/store_repl_lru.$(OBJEXT)
 liblru_a_OBJECTS = $(am_liblru_a_OBJECTS)
+testHeaders_SOURCES = testHeaders.c
+testHeaders_OBJECTS = testHeaders.$(OBJEXT)
+testHeaders_LDADD = $(LDADD)
 DEFAULT_INCLUDES = -I. -I$(srcdir) -I$(top_builddir)/include
 depcomp = $(SHELL) $(top_srcdir)/cfgaux/depcomp
 am__depfiles_maybe = depfiles
-CXXCOMPILE = $(CXX) $(DEFS) $(DEFAULT_INCLUDES) $(INCLUDES) \
-	$(AM_CPPFLAGS) $(CPPFLAGS) $(AM_CXXFLAGS) $(CXXFLAGS)
-LTCXXCOMPILE = $(LIBTOOL) --tag=CXX --mode=compile $(CXX) $(DEFS) \
-	$(DEFAULT_INCLUDES) $(INCLUDES) $(AM_CPPFLAGS) $(CPPFLAGS) \
-	$(AM_CXXFLAGS) $(CXXFLAGS)
-CXXLD = $(CXX)
-CXXLINK = $(LIBTOOL) --tag=CXX --mode=link $(CXXLD) $(AM_CXXFLAGS) \
-	$(CXXFLAGS) $(AM_LDFLAGS) $(LDFLAGS) -o $@
 COMPILE = $(CC) $(DEFS) $(DEFAULT_INCLUDES) $(INCLUDES) $(AM_CPPFLAGS) \
 	$(CPPFLAGS) $(AM_CFLAGS) $(CFLAGS)
 LTCOMPILE = $(LIBTOOL) --tag=CC --mode=compile $(CC) $(DEFS) \
@@ -82,8 +78,16 @@ LTCOMPILE = $(LIBTOOL) --tag=CC --mode=compile $(CC) $(DEFS) \
 CCLD = $(CC)
 LINK = $(LIBTOOL) --tag=CC --mode=link $(CCLD) $(AM_CFLAGS) $(CFLAGS) \
 	$(AM_LDFLAGS) $(LDFLAGS) -o $@
-SOURCES = $(libheap_a_SOURCES) $(liblru_a_SOURCES)
-DIST_SOURCES = $(libheap_a_SOURCES) $(liblru_a_SOURCES)
+CXXCOMPILE = $(CXX) $(DEFS) $(DEFAULT_INCLUDES) $(INCLUDES) \
+	$(AM_CPPFLAGS) $(CPPFLAGS) $(AM_CXXFLAGS) $(CXXFLAGS)
+LTCXXCOMPILE = $(LIBTOOL) --tag=CXX --mode=compile $(CXX) $(DEFS) \
+	$(DEFAULT_INCLUDES) $(INCLUDES) $(AM_CPPFLAGS) $(CPPFLAGS) \
+	$(AM_CXXFLAGS) $(CXXFLAGS)
+CXXLD = $(CXX)
+CXXLINK = $(LIBTOOL) --tag=CXX --mode=link $(CXXLD) $(AM_CXXFLAGS) \
+	$(CXXFLAGS) $(AM_LDFLAGS) $(LDFLAGS) -o $@
+SOURCES = $(libheap_a_SOURCES) $(liblru_a_SOURCES) testHeaders.c
+DIST_SOURCES = $(libheap_a_SOURCES) $(liblru_a_SOURCES) testHeaders.c
 ETAGS = etags
 CTAGS = ctags
 DISTFILES = $(DIST_COMMON) $(DIST_SOURCES) $(TEXINFOS) $(EXTRA_DIST)
@@ -319,7 +323,7 @@ INCLUDES = -I. -I$(top_builddir)/include -I$(top_srcdir)/include \
 all: all-am
 
 .SUFFIXES:
-.SUFFIXES: .cc .lo .o .obj
+.SUFFIXES: .c .cc .lo .o .obj
 $(srcdir)/Makefile.in: @MAINTAINER_MODE_TRUE@ $(srcdir)/Makefile.am  $(am__configure_deps)
 	@for dep in $?; do \
 	  case '$(am__configure_deps)' in \
@@ -379,6 +383,13 @@ liblru.a: $(liblru_a_OBJECTS) $(liblru_a_DEPENDENCIES)
 	$(liblru_a_AR) liblru.a $(liblru_a_OBJECTS) $(liblru_a_LIBADD)
 	$(RANLIB) liblru.a
 
+clean-checkPROGRAMS:
+	@list='$(check_PROGRAMS)'; for p in $$list; do \
+	  f=`echo $$p|sed 's/$(EXEEXT)$$//'`; \
+	  echo " rm -f $$p $$f"; \
+	  rm -f $$p $$f ; \
+	done
+
 mostlyclean-compile:
 	-rm -f *.$(OBJEXT)
 	-rm -f heap/store_heap_replacement.$(OBJEXT)
@@ -388,10 +399,35 @@ mostlyclean-compile:
 distclean-compile:
 	-rm -f *.tab.c
 
+@AMDEP_TRUE@@am__include@ @am__quote@./$(DEPDIR)/testHeaders.Po@am__quote@
 @AMDEP_TRUE@@am__include@ @am__quote@heap/$(DEPDIR)/store_heap_replacement.Po@am__quote@
 @AMDEP_TRUE@@am__include@ @am__quote@heap/$(DEPDIR)/store_repl_heap.Po@am__quote@
 @AMDEP_TRUE@@am__include@ @am__quote@lru/$(DEPDIR)/store_repl_lru.Po@am__quote@
 
+.c.o:
+@am__fastdepCC_TRUE@	depbase=`echo $@ | sed 's|[^/]*$$|$(DEPDIR)/&|;s|\.o$$||'`; \
+@am__fastdepCC_TRUE@	if $(COMPILE) -MT $@ -MD -MP -MF "$$depbase.Tpo" -c -o $@ $<; \
+@am__fastdepCC_TRUE@	then mv -f "$$depbase.Tpo" "$$depbase.Po"; else rm -f "$$depbase.Tpo"; exit 1; fi
+@AMDEP_TRUE@@am__fastdepCC_FALSE@	source='$<' object='$@' libtool=no @AMDEPBACKSLASH@
+@AMDEP_TRUE@@am__fastdepCC_FALSE@	DEPDIR=$(DEPDIR) $(CCDEPMODE) $(depcomp) @AMDEPBACKSLASH@
+@am__fastdepCC_FALSE@	$(COMPILE) -c -o $@ $<
+
+.c.obj:
+@am__fastdepCC_TRUE@	depbase=`echo $@ | sed 's|[^/]*$$|$(DEPDIR)/&|;s|\.obj$$||'`; \
+@am__fastdepCC_TRUE@	if $(COMPILE) -MT $@ -MD -MP -MF "$$depbase.Tpo" -c -o $@ `$(CYGPATH_W) '$<'`; \
+@am__fastdepCC_TRUE@	then mv -f "$$depbase.Tpo" "$$depbase.Po"; else rm -f "$$depbase.Tpo"; exit 1; fi
+@AMDEP_TRUE@@am__fastdepCC_FALSE@	source='$<' object='$@' libtool=no @AMDEPBACKSLASH@
+@AMDEP_TRUE@@am__fastdepCC_FALSE@	DEPDIR=$(DEPDIR) $(CCDEPMODE) $(depcomp) @AMDEPBACKSLASH@
+@am__fastdepCC_FALSE@	$(COMPILE) -c -o $@ `$(CYGPATH_W) '$<'`
+
+.c.lo:
+@am__fastdepCC_TRUE@	depbase=`echo $@ | sed 's|[^/]*$$|$(DEPDIR)/&|;s|\.lo$$||'`; \
+@am__fastdepCC_TRUE@	if $(LTCOMPILE) -MT $@ -MD -MP -MF "$$depbase.Tpo" -c -o $@ $<; \
+@am__fastdepCC_TRUE@	then mv -f "$$depbase.Tpo" "$$depbase.Plo"; else rm -f "$$depbase.Tpo"; exit 1; fi
+@AMDEP_TRUE@@am__fastdepCC_FALSE@	source='$<' object='$@' libtool=yes @AMDEPBACKSLASH@
+@AMDEP_TRUE@@am__fastdepCC_FALSE@	DEPDIR=$(DEPDIR) $(CCDEPMODE) $(depcomp) @AMDEPBACKSLASH@
+@am__fastdepCC_FALSE@	$(LTCOMPILE) -c -o $@ $<
+
 .cc.o:
 @am__fastdepCXX_TRUE@	depbase=`echo $@ | sed 's|[^/]*$$|$(DEPDIR)/&|;s|\.o$$||'`; \
 @am__fastdepCXX_TRUE@	if $(CXXCOMPILE) -MT $@ -MD -MP -MF "$$depbase.Tpo" -c -o $@ $<; \
@@ -502,6 +538,7 @@ distdir: $(DISTFILES)
 	  fi; \
 	done
 check-am: all-am
+	$(MAKE) $(AM_MAKEFLAGS) $(check_PROGRAMS)
 check: check-am
 all-am: Makefile $(LIBRARIES)
 installdirs:
@@ -535,11 +572,11 @@ maintainer-clean-generic:
 	@echo "it deletes files that may require special tools to rebuild."
 clean: clean-am
 
-clean-am: clean-generic clean-libtool clean-noinstLIBRARIES \
-	mostlyclean-am
+clean-am: clean-checkPROGRAMS clean-generic clean-libtool \
+	clean-noinstLIBRARIES mostlyclean-am
 
 distclean: distclean-am
-	-rm -rf heap/$(DEPDIR) lru/$(DEPDIR)
+	-rm -rf ./$(DEPDIR) heap/$(DEPDIR) lru/$(DEPDIR)
 	-rm -f Makefile
 distclean-am: clean-am distclean-compile distclean-generic \
 	distclean-libtool distclean-tags
@@ -565,7 +602,7 @@ install-man:
 installcheck-am:
 
 maintainer-clean: maintainer-clean-am
-	-rm -rf heap/$(DEPDIR) lru/$(DEPDIR)
+	-rm -rf ./$(DEPDIR) heap/$(DEPDIR) lru/$(DEPDIR)
 	-rm -f Makefile
 maintainer-clean-am: distclean-am maintainer-clean-generic
 
@@ -584,18 +621,21 @@ ps-am:
 
 uninstall-am: uninstall-info-am
 
-.PHONY: CTAGS GTAGS all all-am check check-am clean clean-generic \
-	clean-libtool clean-noinstLIBRARIES ctags distclean \
-	distclean-compile distclean-generic distclean-libtool \
-	distclean-tags distdir dvi dvi-am html html-am info info-am \
-	install install-am install-data install-data-am install-exec \
-	install-exec-am install-info install-info-am install-man \
-	install-strip installcheck installcheck-am installdirs \
-	maintainer-clean maintainer-clean-generic mostlyclean \
-	mostlyclean-compile mostlyclean-generic mostlyclean-libtool \
-	pdf pdf-am ps ps-am tags uninstall uninstall-am \
-	uninstall-info-am
-
+.PHONY: CTAGS GTAGS all all-am check check-am clean \
+	clean-checkPROGRAMS clean-generic clean-libtool \
+	clean-noinstLIBRARIES ctags distclean distclean-compile \
+	distclean-generic distclean-libtool distclean-tags distdir dvi \
+	dvi-am html html-am info info-am install install-am \
+	install-data install-data-am install-exec install-exec-am \
+	install-info install-info-am install-man install-strip \
+	installcheck installcheck-am installdirs maintainer-clean \
+	maintainer-clean-generic mostlyclean mostlyclean-compile \
+	mostlyclean-generic mostlyclean-libtool pdf pdf-am ps ps-am \
+	tags uninstall uninstall-am uninstall-info-am
+
+
+testHeaders: heap/*.h
+	$(top_srcdir)/test-suite/testheaders.sh "$(CXXCOMPILE)" "heap" || exit 1
 # Tell versions [3.59,3.63) of GNU make to not export all variables.
 # Otherwise a system limit (for SysV at least) may be exceeded.
 .NOEXPORT:
@@ -45,12 +45,6 @@ HttpReply::~HttpReply()
     fatal ("Not implemented.");
 }
 
-void
-HttpReply::absorb(HttpReply * new_rep)
-{
-    fatal ("Not implemented");
-}
-
 void
 HttpReply::setHeaders(HttpVersion ver, http_status status, const char *reason,
                       const char *ctype, int64_t clen, time_t lmt, time_t expires)
@@ -278,7 +278,7 @@ testEventLoop::testSetPrimaryEngine()
     /* one engine - gets a timeout */
     theLoop.registerEngine(&first_engine);
     theLoop.runOnce();
-    CPPUNIT_ASSERT_EQUAL(10, first_engine.lasttimeout);
+    CPPUNIT_ASSERT_EQUAL(EVENT_LOOP_TIMEOUT, first_engine.lasttimeout);
     /* two engines - the second gets the timeout */
     theLoop.registerEngine(&second_engine);
     theLoop.runOnce();
@@ -289,5 +289,4 @@ testEventLoop::testSetPrimaryEngine()
     theLoop.runOnce();
     CPPUNIT_ASSERT_EQUAL(10, first_engine.lasttimeout);
     CPPUNIT_ASSERT_EQUAL(0, second_engine.lasttimeout);
-
 }
@@ -44,7 +44,6 @@ PRE_UNINSTALL = :
 POST_UNINSTALL = :
 build_triplet = @build@
 host_triplet = @host@
-check_PROGRAMS =
 bin_PROGRAMS = squidclient$(EXEEXT)
 libexec_PROGRAMS = cachemgr$(CGIEXT)$(EXEEXT)
 subdir = tools
@@ -315,6 +314,11 @@ INCLUDES = -I. -I$(srcdir) -I$(top_builddir)/include \
 	-I$(top_srcdir)/include -I$(top_srcdir)/lib/libTrie/include \
 	@SQUID_CPPUNIT_INC@ $(am__empty)
 TESTS = $(check_PROGRAMS)
+#check_PROGRAMS= testHeaders
+
+### Special Universal .h dependency test script
+#testHeaders: *.h
+# ./ has no .h files
 SUBDIRS = 
 squidclient_SOURCES = squidclient.cc
 cachemgr__CGIEXT__SOURCES = cachemgr.cc
@@ -392,13 +396,6 @@ clean-binPROGRAMS:
 	  echo " rm -f $$p $$f"; \
 	  rm -f $$p $$f ; \
 	done
-
-clean-checkPROGRAMS:
-	@list='$(check_PROGRAMS)'; for p in $$list; do \
-	  f=`echo $$p|sed 's/$(EXEEXT)$$//'`; \
-	  echo " rm -f $$p $$f"; \
-	  rm -f $$p $$f ; \
-	done
 install-libexecPROGRAMS: $(libexec_PROGRAMS)
 	@$(NORMAL_INSTALL)
 	test -z "$(libexecdir)" || $(mkdir_p) "$(DESTDIR)$(libexecdir)"
@@ -725,7 +722,6 @@ distdir: $(DISTFILES)
 	  fi; \
 	done
 check-am: all-am
-	$(MAKE) $(AM_MAKEFLAGS) $(check_PROGRAMS)
 	$(MAKE) $(AM_MAKEFLAGS) check-TESTS
 check: check-recursive
 all-am: Makefile $(PROGRAMS)
@@ -761,8 +757,8 @@ maintainer-clean-generic:
 	@echo "it deletes files that may require special tools to rebuild."
 clean: clean-recursive
 
-clean-am: clean-binPROGRAMS clean-checkPROGRAMS clean-generic \
-	clean-libexecPROGRAMS clean-libtool mostlyclean-am
+clean-am: clean-binPROGRAMS clean-generic clean-libexecPROGRAMS \
+	clean-libtool mostlyclean-am
 
 distclean: distclean-recursive
 	-rm -rf ./$(DEPDIR)
@@ -814,20 +810,19 @@ uninstall-am: uninstall-binPROGRAMS uninstall-info-am \
 uninstall-info: uninstall-info-recursive
 
 .PHONY: $(RECURSIVE_TARGETS) CTAGS GTAGS all all-am check check-TESTS \
-	check-am clean clean-binPROGRAMS clean-checkPROGRAMS \
-	clean-generic clean-libexecPROGRAMS clean-libtool \
-	clean-recursive ctags ctags-recursive distclean \
-	distclean-compile distclean-generic distclean-libtool \
-	distclean-recursive distclean-tags distdir dvi dvi-am html \
-	html-am info info-am install install-am install-binPROGRAMS \
-	install-data install-data-am install-data-local install-exec \
-	install-exec-am install-info install-info-am \
-	install-libexecPROGRAMS install-man install-strip installcheck \
-	installcheck-am installdirs installdirs-am maintainer-clean \
-	maintainer-clean-generic maintainer-clean-recursive \
-	mostlyclean mostlyclean-compile mostlyclean-generic \
-	mostlyclean-libtool mostlyclean-recursive pdf pdf-am ps ps-am \
-	tags tags-recursive uninstall uninstall-am \
+	check-am clean clean-binPROGRAMS clean-generic \
+	clean-libexecPROGRAMS clean-libtool clean-recursive ctags \
+	ctags-recursive distclean distclean-compile distclean-generic \
+	distclean-libtool distclean-recursive distclean-tags distdir \
+	dvi dvi-am html html-am info info-am install install-am \
+	install-binPROGRAMS install-data install-data-am \
+	install-data-local install-exec install-exec-am install-info \
+	install-info-am install-libexecPROGRAMS install-man \
+	install-strip installcheck installcheck-am installdirs \
+	installdirs-am maintainer-clean maintainer-clean-generic \
+	maintainer-clean-recursive mostlyclean mostlyclean-compile \
+	mostlyclean-generic mostlyclean-libtool mostlyclean-recursive \
+	pdf pdf-am ps ps-am tags tags-recursive uninstall uninstall-am \
 	uninstall-binPROGRAMS uninstall-info-am \
 	uninstall-libexecPROGRAMS uninstall-local
 